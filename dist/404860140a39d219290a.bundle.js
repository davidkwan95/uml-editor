!function(t){function e(i){if(n[i])return n[i].exports;var l=n[i]={i:i,l:!1,exports:{}};return t[i].call(l.exports,l,l.exports,e),l.l=!0,l.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=3)}([function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(){i(this,t),this.next={handleRequest:function(){console.log("All strategies exhausted")}}}return l(t,[{key:"setNext",value:function(t){return this.next=t,t}},{key:"handleRequest",value:function(){throw new Error("Method not implemented",this)}}]),t}();e.default=o},function(t,e,n){"use strict";var i=n(4),l=n(2),o=n(6),s=n(19),r=n(20),a=function(t,e,n){mxEventSource.call(this),this.destroyFunctions=[],this.editor=t||new Editor,this.container=e||document.body;var i=this.editor.graph;i.lightbox=n,mxClient.IS_SVG?mxPopupMenu.prototype.submenuImage="data:image/gif;base64,R0lGODlhCQAJAIAAAP///zMzMyH5BAEAAAAALAAAAAAJAAkAAAIPhI8WebHsHopSOVgb26AAADs=":(new Image).src=mxPopupMenu.prototype.submenuImage,mxClient.IS_SVG||null==mxConnectionHandler.prototype.connectImage||((new Image).src=mxConnectionHandler.prototype.connectImage.src),this.editor.chromeless&&(this.footerHeight=0,i.isEnabled=function(){return!1},i.panningHandler.isForcePanningEvent=function(t){return!mxEvent.isPopupTrigger(t.getEvent())}),this.actions=new o(this),this.menus=this.createMenus(),this.createDivs(),this.createUi(),this.refresh();var s=mxUtils.bind(this,function(t){return null==t&&(t=window.event),this.isSelectionAllowed(t)||i.isEditing()});this.container==document.body&&(this.menubarContainer.onselectstart=s,this.menubarContainer.onmousedown=s,this.toolbarContainer.onselectstart=s,this.toolbarContainer.onmousedown=s,this.diagramContainer.onselectstart=s,this.diagramContainer.onmousedown=s,this.sidebarContainer.onselectstart=s,this.sidebarContainer.onmousedown=s,this.formatContainer.onselectstart=s,this.formatContainer.onmousedown=s,this.footerContainer.onselectstart=s,this.footerContainer.onmousedown=s,null!=this.tabContainer&&(this.tabContainer.onselectstart=s)),this.editor.chromeless?i.panningHandler.usePopupTrigger=!1:mxClient.IS_IE&&(void 0===document.documentMode||document.documentMode<9)?mxEvent.addListener(this.diagramContainer,"contextmenu",s):this.diagramContainer.oncontextmenu=s,i.init(this.diagramContainer),this.hoverIcons=this.createHoverIcons(),mxEvent.addListener(this.diagramContainer,"mousemove",mxUtils.bind(this,function(t){var e=mxUtils.getOffset(this.diagramContainer);mxEvent.getClientX(t)-e.x-this.diagramContainer.clientWidth>0||mxEvent.getClientY(t)-e.y-this.diagramContainer.clientHeight>0?this.diagramContainer.setAttribute("title",mxResources.get("panTooltip")):this.diagramContainer.removeAttribute("title")}));var r=!1,a=this.hoverIcons.isResetEvent;this.hoverIcons.isResetEvent=function(t,e){return r||a.apply(this,arguments)},this.keydownHandler=mxUtils.bind(this,function(t){32==t.which?(r=!0,this.hoverIcons.reset(),i.container.style.cursor="move",i.isEditing()||mxEvent.getSource(t)!=i.container||mxEvent.consume(t)):mxEvent.isConsumed(t)||27!=t.keyCode||this.hideDialog()}),mxEvent.addListener(document,"keydown",this.keydownHandler),this.keyupHandler=mxUtils.bind(this,function(t){i.container.style.cursor="",r=!1}),mxEvent.addListener(document,"keyup",this.keyupHandler);var d=i.panningHandler.isForcePanningEvent;i.panningHandler.isForcePanningEvent=function(t){return d.apply(this,arguments)||r||mxEvent.isMouseEvent(t.getEvent())&&(this.usePopupTrigger||!mxEvent.isPopupTrigger(t.getEvent()))&&(!mxEvent.isControlDown(t.getEvent())&&mxEvent.isRightMouseButton(t.getEvent())||mxEvent.isMiddleMouseButton(t.getEvent()))};var u=i.cellEditor.isStopEditingEvent;i.cellEditor.isStopEditingEvent=function(t){return u.apply(this,arguments)||13==t.keyCode&&(!mxClient.IS_SF&&mxEvent.isControlDown(t)||mxClient.IS_MAC&&mxEvent.isMetaDown(t)||mxClient.IS_SF&&mxEvent.isShiftDown(t))};var c=!1,h=null,p=null,m=null,g=mxUtils.bind(this,function(){if(c!=i.cellEditor.isContentEditing()){for(var t=this.toolbar.container.firstChild,e=[];null!=t;){var n=t.nextSibling;mxUtils.indexOf(this.toolbar.staticElements,t)<0&&(t.parentNode.removeChild(t),e.push(t)),t=n}var l=this.toolbar.fontMenu,o=this.toolbar.sizeMenu;if(null==m)this.toolbar.createTextToolbar();else{for(var s=0;s<m.length;s++)this.toolbar.container.appendChild(m[s]);this.toolbar.fontMenu=h,this.toolbar.sizeMenu=p}c=i.cellEditor.isContentEditing(),h=l,p=o,m=e}}),x=this,y=i.cellEditor.startEditing;i.cellEditor.startEditing=function(){if(y.apply(this,arguments),g(),i.cellEditor.isContentEditing()){var t=!1,e=function(){t||(t=!0,window.setTimeout(function(){for(var e=i.getSelectedElement(),n=e;null!=n&&n.nodeType!=mxConstants.NODETYPE_ELEMENT;)n=n.parentNode;if(null!=n){var l=mxUtils.getCurrentStyle(n);if(null!=l&&null!=x.toolbar){var o=l.fontFamily;"'"==o.charAt(0)&&(o=o.substring(1)),"'"==o.charAt(o.length-1)&&(o=o.substring(0,o.length-1)),x.toolbar.setFontName(o),x.toolbar.setFontSize(parseInt(l.fontSize))}}t=!1},0))};mxEvent.addListener(i.cellEditor.textarea,"input",e),mxEvent.addListener(i.cellEditor.textarea,"touchend",e),mxEvent.addListener(i.cellEditor.textarea,"mouseup",e),mxEvent.addListener(i.cellEditor.textarea,"keyup",e),e()}};var f=i.cellEditor.stopEditing;i.cellEditor.stopEditing=function(t,e){f.apply(this,arguments),g()},i.container.setAttribute("tabindex","0"),i.container.style.cursor="default",window.self===window.top&&null!=i.container.parentNode&&i.container.focus();var C=i.fireMouseEvent;i.fireMouseEvent=function(t,e,n){t==mxEvent.MOUSE_DOWN&&this.container.focus(),C.apply(this,arguments)},i.popupMenuHandler.autoExpand=!0,null!=this.menus&&(i.popupMenuHandler.factoryMethod=mxUtils.bind(this,function(t,e,n){this.menus.createPopupMenu(t,e,n)})),mxEvent.addGestureListeners(document,mxUtils.bind(this,function(t){i.popupMenuHandler.hideMenu()})),this.keyHandler=this.createKeyHandler(t),this.getKeyHandler=function(){return keyHandler};var S=["rounded","shadow","glass","dashed","dashPattern","comic","labelBackgroundColor"],E=["shape","edgeStyle","curved","rounded","elbow","comic"];this.setDefaultStyle=function(t){var e=i.view.getState(t);if(null!=e){var n=t.clone();n.style="";var l=i.getCellStyle(n),o=[],s=[];for(var r in e.style)l[r]!=e.style[r]&&(o.push(e.style[r]),s.push(r));for(var a=i.getModel().getStyle(e.cell),d=null!=a?a.split(";"):[],u=0;u<d.length;u++){var c=d[u],h=c.indexOf("=");if(h>=0){var r=c.substring(0,h),p=c.substring(h+1);null!=l[r]&&"none"==p&&(o.push(p),s.push(r))}}i.getModel().isEdge(e.cell)?i.currentEdgeStyle={}:i.currentVertexStyle={},this.fireEvent(new mxEventObject("styleChanged","keys",s,"values",o,"cells",[e.cell]))}},this.clearDefaultStyle=function(){i.currentEdgeStyle=i.defaultEdgeStyle,i.currentVertexStyle={},this.fireEvent(new mxEventObject("styleChanged","keys",[],"values",[],"cells",[]))};for(var v=["fontFamily","fontSize","fontColor"],b=["edgeStyle","startArrow","startFill","startSize","endArrow","endFill","endSize","jettySize","orthogonalLoop"],w=[["startArrow","startFill","startSize","endArrow","endFill","endSize","jettySize","orthogonalLoop"],["strokeColor","strokeWidth"],["fillColor","gradientColor"],v,["align"],["html"]],T=0;T<w.length;T++)for(var A=0;A<w[T].length;A++)S.push(w[T][A]);for(var T=0;T<E.length;T++)S.push(E[T]);var R=function(t,e){i.getModel().beginUpdate();try{if(e)for(var n=i.getModel().isEdge(d),l=n?i.currentEdgeStyle:i.currentVertexStyle,o=["fontSize","fontFamily","fontColor"],s=0;s<o.length;s++){var r=l[o[s]];null!=r&&i.setCellStyles(o[s],r,t)}else for(var a=0;a<t.length;a++){for(var d=t[a],u=i.getModel().getStyle(d),c=null!=u?u.split(";"):[],h=S.slice(),s=0;s<c.length;s++){var p=c[s],m=p.indexOf("=");if(m>=0){var g=p.substring(0,m),x=mxUtils.indexOf(h,g);x>=0&&h.splice(x,1);for(var y=0;y<w.length;y++){var f=w[y];if(mxUtils.indexOf(f,g)>=0)for(var C=0;C<f.length;C++){var v=mxUtils.indexOf(h,f[C]);v>=0&&h.splice(v,1)}}}}for(var n=i.getModel().isEdge(d),l=n?i.currentEdgeStyle:i.currentVertexStyle,s=0;s<h.length;s++){var g=h[s],b=l[g];null==b||"shape"==g&&!n||(!n||mxUtils.indexOf(E,g)<0)&&i.setCellStyles(g,b,[d])}}}finally{i.getModel().endUpdate()}};if(i.addListener("cellsInserted",function(t,e){R(e.getProperty("cells"))}),i.addListener("textInserted",function(t,e){R(e.getProperty("cells"),!0)}),i.connectionHandler.addListener(mxEvent.CONNECT,function(t,e){var n=[e.getProperty("cell")];e.getProperty("terminalInserted")&&n.push(e.getProperty("terminal")),R(n)}),this.addListener("styleChanged",mxUtils.bind(this,function(t,e){var n=e.getProperty("cells"),o=!1,s=!1;if(n.length>0)for(var r=0;r<n.length&&(o=i.getModel().isVertex(n[r])||o,!(s=i.getModel().isEdge(n[r])||s)||!o);r++);else o=!0,s=!0;for(var a=e.getProperty("keys"),d=e.getProperty("values"),r=0;r<a.length;r++){var u=mxUtils.indexOf(v,a[r])>=0;("strokeColor"!=a[r]||null!=d[r]&&"none"!=d[r])&&(mxUtils.indexOf(E,a[r])>=0?s||mxUtils.indexOf(b,a[r])>=0?null==d[r]?delete i.currentEdgeStyle[a[r]]:i.currentEdgeStyle[a[r]]=d[r]:o&&mxUtils.indexOf(S,a[r])>=0&&(null==d[r]?delete i.currentVertexStyle[a[r]]:i.currentVertexStyle[a[r]]=d[r]):mxUtils.indexOf(S,a[r])>=0&&((o||u)&&(null==d[r]?delete i.currentVertexStyle[a[r]]:i.currentVertexStyle[a[r]]=d[r]),(s||u||mxUtils.indexOf(b,a[r])>=0)&&(null==d[r]?delete i.currentEdgeStyle[a[r]]:i.currentEdgeStyle[a[r]]=d[r])))}if(null!=this.toolbar){if(this.toolbar.setFontName(i.currentVertexStyle.fontFamily||l.prototype.defaultFont),this.toolbar.setFontSize(i.currentVertexStyle.fontSize||l.prototype.defaultFontSize),null!=this.toolbar.edgeStyleMenu){var c=this.toolbar.edgeStyleMenu.getElementsByTagName("div")[0];"orthogonalEdgeStyle"==i.currentEdgeStyle.edgeStyle&&"1"==i.currentEdgeStyle.curved?c.className="geSprite geSprite-curved":"straight"==i.currentEdgeStyle.edgeStyle||"none"==i.currentEdgeStyle.edgeStyle||null==i.currentEdgeStyle.edgeStyle?c.className="geSprite geSprite-straight":"entityRelationEdgeStyle"==i.currentEdgeStyle.edgeStyle?c.className="geSprite geSprite-entity":"elbowEdgeStyle"==i.currentEdgeStyle.edgeStyle?c.className="geSprite geSprite-"+("vertical"==i.currentEdgeStyle.elbow?"verticalelbow":"horizontalelbow"):"isometricEdgeStyle"==i.currentEdgeStyle.edgeStyle?c.className="geSprite geSprite-"+("vertical"==i.currentEdgeStyle.elbow?"verticalisometric":"horizontalisometric"):c.className="geSprite geSprite-orthogonal"}if(null!=this.toolbar.edgeShapeMenu){var h=this.toolbar.edgeShapeMenu.getElementsByTagName("div")[0];"link"==i.currentEdgeStyle.shape?h.className="geSprite geSprite-linkedge":"flexArrow"==i.currentEdgeStyle.shape?h.className="geSprite geSprite-arrow":"arrow"==i.currentEdgeStyle.shape?h.className="geSprite geSprite-simplearrow":h.className="geSprite geSprite-connection"}if(null!=this.toolbar.lineStartMenu){this.toolbar.lineStartMenu.getElementsByTagName("div")[0].className=this.getCssClassForMarker("start",i.currentEdgeStyle.shape,i.currentEdgeStyle[mxConstants.STYLE_STARTARROW],mxUtils.getValue(i.currentEdgeStyle,"startFill","1"))}if(null!=this.toolbar.lineEndMenu){this.toolbar.lineEndMenu.getElementsByTagName("div")[0].className=this.getCssClassForMarker("end",i.currentEdgeStyle.shape,i.currentEdgeStyle[mxConstants.STYLE_ENDARROW],mxUtils.getValue(i.currentEdgeStyle,"endFill","1"))}}})),null!=this.toolbar){var I=mxUtils.bind(this,function(){var t=i.currentVertexStyle.fontFamily||"Helvetica",e=String(i.currentVertexStyle.fontSize||"12"),n=i.getView().getState(i.getSelectionCell());null!=n&&(t=n.style[mxConstants.STYLE_FONTFAMILY]||t,e=n.style[mxConstants.STYLE_FONTSIZE]||e,t.length>10&&(t=t.substring(0,8)+"...")),this.toolbar.setFontName(t),this.toolbar.setFontSize(e)});i.getSelectionModel().addListener(mxEvent.CHANGE,I),i.getModel().addListener(mxEvent.CHANGE,I)}i.addListener(mxEvent.CELLS_ADDED,function(t,e){var n=e.getProperty("cells"),l=e.getProperty("parent");i.getModel().isLayer(l)&&!i.isCellVisible(l)&&null!=n&&n.length>0&&i.getModel().setVisible(l,!0)}),this.gestureHandler=mxUtils.bind(this,function(t){null!=this.currentMenu&&mxEvent.getSource(t)!=this.currentMenu.div&&this.hideCurrentMenu()}),mxEvent.addGestureListeners(document,this.gestureHandler),this.resizeHandler=mxUtils.bind(this,function(){window.setTimeout(mxUtils.bind(this,function(){this.refresh()}),0)}),mxEvent.addListener(window,"resize",this.resizeHandler),this.orientationChangeHandler=mxUtils.bind(this,function(){this.refresh()}),mxEvent.addListener(window,"orientationchange",this.orientationChangeHandler),mxClient.IS_IOS&&!window.navigator.standalone&&(this.scrollHandler=mxUtils.bind(this,function(){window.scrollTo(0,0)}),mxEvent.addListener(window,"scroll",this.scrollHandler)),this.editor.addListener("resetGraphView",mxUtils.bind(this,function(){this.resetScrollbars()})),this.addListener("gridEnabledChanged",mxUtils.bind(this,function(){i.view.validateBackground()})),this.addListener("backgroundColorChanged",mxUtils.bind(this,function(){i.view.validateBackground()})),i.addListener("gridSizeChanged",mxUtils.bind(this,function(){i.isGridEnabled()&&i.view.validateBackground()})),this.editor.resetGraph(),this.init(),this.open()};mxUtils.extend(a,mxEventSource),a.compactUi=!0,a.prototype.splitSize=mxClient.IS_TOUCH||mxClient.IS_POINTER?12:8,a.prototype.menubarHeight=30,a.prototype.formatEnabled=!0,a.prototype.formatWidth=240,a.prototype.toolbarHeight=34,a.prototype.footerHeight=28,a.prototype.sidebarFooterHeight=34,a.prototype.editButtonLink=null,a.prototype.hsplitPosition=screen.width<=500?116:208,a.prototype.allowAnimation=!0,a.prototype.init=function(){var t=this.editor.graph;mxEvent.addListener(t.container,"keydown",mxUtils.bind(this,function(e){9==e.which&&t.isEnabled()&&!mxEvent.isAltDown(e)&&(t.isEditing()?t.stopEditing(!1):t.selectCell(!mxEvent.isShiftDown(e)),mxEvent.consume(e))})),mxEvent.addListener(t.container,"keypress",mxUtils.bind(this,function(e){if(this.isImmediateEditingEvent(e)&&!t.isEditing()&&!t.isSelectionEmpty()&&0!==e.which&&!mxEvent.isAltDown(e)&&!mxEvent.isControlDown(e)&&!mxEvent.isMetaDown(e)&&(t.escape(),t.startEditing(),mxClient.IS_FF)){var n=t.cellEditor;n.textarea.innerHTML=String.fromCharCode(e.which);var i=document.createRange();i.selectNodeContents(n.textarea),i.collapse(!1);var l=window.getSelection();l.removeAllRanges(),l.addRange(i)}})),this.addUndoListener(),this.addBeforeUnloadListener(),t.getSelectionModel().addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){this.updateActionStates()})),t.getModel().addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){this.updateActionStates()}));var e=t.setDefaultParent,n=this;this.editor.graph.setDefaultParent=function(){e.apply(this,arguments),n.updateActionStates()},t.editLink=n.actions.get("editLink").funct,this.updateActionStates(),this.initClipboard(),this.initCanvas(),null!=this.format&&this.format.init()},a.prototype.isImmediateEditingEvent=function(t){return!0},a.prototype.getCssClassForMarker=function(t,e,n,i){return"flexArrow"==e?null!=n&&n!=mxConstants.NONE?"geSprite geSprite-"+t+"blocktrans":"geSprite geSprite-noarrow":n==mxConstants.ARROW_CLASSIC?"1"==i?"geSprite geSprite-"+t+"classic":"geSprite geSprite-"+t+"classictrans":n==mxConstants.ARROW_CLASSIC_THIN?"1"==i?"geSprite geSprite-"+t+"classicthin":"geSprite geSprite-"+t+"classicthintrans":n==mxConstants.ARROW_OPEN?"geSprite geSprite-"+t+"open":n==mxConstants.ARROW_OPEN_THIN?"geSprite geSprite-"+t+"openthin":n==mxConstants.ARROW_BLOCK?"1"==i?"geSprite geSprite-"+t+"block":"geSprite geSprite-"+t+"blocktrans":n==mxConstants.ARROW_BLOCK_THIN?"1"==i?"geSprite geSprite-"+t+"blockthin":"geSprite geSprite-"+t+"blockthintrans":n==mxConstants.ARROW_OVAL?"1"==i?"geSprite geSprite-"+t+"oval":"geSprite geSprite-"+t+"ovaltrans":n==mxConstants.ARROW_DIAMOND?"1"==i?"geSprite geSprite-"+t+"diamond":"geSprite geSprite-"+t+"diamondtrans":n==mxConstants.ARROW_DIAMOND_THIN?"1"==i?"geSprite geSprite-"+t+"thindiamond":"geSprite geSprite-"+t+"thindiamondtrans":"openAsync"==n?"geSprite geSprite-"+t+"openasync":"dash"==n?"geSprite geSprite-"+t+"dash":"cross"==n?"geSprite geSprite-"+t+"cross":"async"==n?"1"==i?"geSprite geSprite-"+t+"async":"geSprite geSprite-"+t+"asynctrans":"circle"==n||"circlePlus"==n?"1"==i||"circle"==n?"geSprite geSprite-"+t+"circle":"geSprite geSprite-"+t+"circleplus":"ERone"==n?"geSprite geSprite-"+t+"erone":"ERmandOne"==n?"geSprite geSprite-"+t+"eronetoone":"ERmany"==n?"geSprite geSprite-"+t+"ermany":"ERoneToMany"==n?"geSprite geSprite-"+t+"eronetomany":"ERzeroToOne"==n?"geSprite geSprite-"+t+"eroneopt":"ERzeroToMany"==n?"geSprite geSprite-"+t+"ermanyopt":"geSprite geSprite-noarrow"},a.prototype.createMenus=function(){return new l(this)},a.prototype.updatePasteActionStates=function(){var t=this.editor.graph,e=this.actions.get("paste"),n=this.actions.get("pasteHere");e.setEnabled(this.editor.graph.cellEditor.isContentEditing()||!mxClipboard.isEmpty()&&t.isEnabled()&&!t.isCellLocked(t.getDefaultParent())),n.setEnabled(e.isEnabled())},a.prototype.initClipboard=function(){var t=this,e=mxClipboard.cut;mxClipboard.cut=function(n){n.cellEditor.isContentEditing()?document.execCommand("cut",!1,null):e.apply(this,arguments),t.updatePasteActionStates()};var n=mxClipboard.copy;mxClipboard.copy=function(e){e.cellEditor.isContentEditing()?document.execCommand("copy",!1,null):n.apply(this,arguments),t.updatePasteActionStates()};var i=mxClipboard.paste;mxClipboard.paste=function(e){var n=null;return e.cellEditor.isContentEditing()?document.execCommand("paste",!1,null):n=i.apply(this,arguments),t.updatePasteActionStates(),n};var l=this.editor.graph.cellEditor.startEditing;this.editor.graph.cellEditor.startEditing=function(){l.apply(this,arguments),t.updatePasteActionStates()};var o=this.editor.graph.cellEditor.stopEditing;this.editor.graph.cellEditor.stopEditing=function(e,n){o.apply(this,arguments),t.updatePasteActionStates()},this.updatePasteActionStates()},a.prototype.initCanvas=function(){var t=this.editor.graph,t=this.editor.graph;t.timerAutoScroll=!0,t.getPagePadding=function(){return new mxPoint(Math.max(0,Math.round((t.container.offsetWidth-34)/t.view.scale)),Math.max(0,Math.round((t.container.offsetHeight-34)/t.view.scale)))},t.view.getBackgroundPageBounds=function(){var t=this.graph.getPageLayout(),e=this.graph.getPageSize();return new mxRectangle(this.scale*(this.translate.x+t.x*e.width),this.scale*(this.translate.y+t.y*e.height),this.scale*t.width*e.width,this.scale*t.height*e.height)},t.getPreferredPageSize=function(t,e,n){var i=this.getPageLayout(),l=this.getPageSize();return new mxRectangle(0,0,i.width*l.width,i.height*l.height)};var e=null;if(this.editor.chromeless){e=mxUtils.bind(this,function(e){if(null!=t.container){var n=t.pageVisible?t.view.getBackgroundPageBounds():t.getGraphBounds(),i=t.view.translate,l=t.view.scale;n=mxRectangle.fromRectangle(n),n.x=n.x/l-i.x,n.y=n.y/l-i.y,n.width/=l,n.height/=l;var o=t.container.scrollTop,s=t.container.scrollLeft,r=mxClient.IS_QUIRKS||document.documentMode>=8?20:14;8!=document.documentMode&&9!=document.documentMode||(r+=3);var a=t.container.offsetWidth-r,d=t.container.offsetHeight-r,u=e?Math.max(.3,Math.min(1,a/n.width)):l,c=Math.max((a-u*n.width)/2,0)/u,h=Math.max((d-u*n.height)/4,0)/u;t.view.scaleAndTranslate(u,c-n.x,h-n.y),t.container.scrollTop=o*u/l,t.container.scrollLeft=s*u/l}}),this.chromelessResize=e;var n=mxUtils.bind(this,function(){e(!1)});mxEvent.addListener(window,"resize",n),this.destroyFunctions.push(function(){mxEvent.removeListener(window,"resize",n)}),this.editor.addListener("resetGraphView",mxUtils.bind(this,function(){e(!0)})),this.actions.get("zoomIn").funct=function(n){t.zoomIn(),e(!1)},this.actions.get("zoomOut").funct=function(n){t.zoomOut(),e(!1)},this.chromelessToolbar=document.createElement("div"),this.chromelessToolbar.style.position="fixed",this.chromelessToolbar.style.overflow="hidden",this.chromelessToolbar.style.boxSizing="border-box",this.chromelessToolbar.style.whiteSpace="nowrap",this.chromelessToolbar.style.backgroundColor="#000000",this.chromelessToolbar.style.padding="10px 10px 8px 10px",this.chromelessToolbar.style.left="50%",mxUtils.setPrefixedStyle(this.chromelessToolbar.style,"borderRadius","20px"),mxUtils.setPrefixedStyle(this.chromelessToolbar.style,"transition","opacity 600ms ease-in-out");var i=mxUtils.bind(this,function(){var e=mxUtils.getCurrentStyle(t.container);this.chromelessToolbar.style.bottom=(null!=e?parseInt(e["margin-bottom"]||0):0)+(null!=this.tabContainer?20+parseInt(this.tabContainer.style.height):20)+"px"});this.editor.addListener("resetGraphView",i),i();var l=0,o=mxUtils.bind(this,function(t,e,n){l++;var i=document.createElement("span");i.style.paddingLeft="8px",i.style.paddingRight="8px",i.style.cursor="pointer",mxEvent.addListener(i,"click",t),null!=n&&i.setAttribute("title",n);var o=document.createElement("img");return o.setAttribute("border","0"),o.setAttribute("src",e),i.appendChild(o),this.chromelessToolbar.appendChild(i),i}),s=o(mxUtils.bind(this,function(t){this.actions.get("previousPage").funct(),mxEvent.consume(t)}),Editor.previousLargeImage,mxResources.get("previousPage")||"Previous Page"),r=document.createElement("div");r.style.display="inline-block",r.style.verticalAlign="top",r.style.fontFamily="Helvetica,Arial",r.style.marginTop="8px",r.style.color="#ffffff",this.chromelessToolbar.appendChild(r);var a=o(mxUtils.bind(this,function(t){this.actions.get("nextPage").funct(),mxEvent.consume(t)}),Editor.nextLargeImage,mxResources.get("nextPage")||"Next Page"),d=mxUtils.bind(this,function(){null!=this.pages&&this.pages.length>1&&null!=this.currentPage&&(r.innerHTML="",mxUtils.write(r,mxUtils.indexOf(this.pages,this.currentPage)+1+" / "+this.pages.length))});s.style.paddingLeft="0px",s.style.paddingRight="4px",a.style.paddingLeft="4px",a.style.paddingRight="0px";var u=mxUtils.bind(this,function(){null!=this.pages&&this.pages.length>1&&null!=this.currentPage?(a.style.display="",s.style.display="",r.style.display="inline-block"):(a.style.display="none",s.style.display="none",r.style.display="none"),d()});this.editor.addListener("resetGraphView",u),this.editor.addListener("pageSelected",d),o(mxUtils.bind(this,function(t){this.actions.get("zoomOut").funct(),mxEvent.consume(t)}),Editor.zoomOutLargeImage,(mxResources.get("zoomOut")||"Zoom Out")+" (Alt+Mousewheel)"),o(mxUtils.bind(this,function(t){this.actions.get("zoomIn").funct(),mxEvent.consume(t)}),Editor.zoomInLargeImage,(mxResources.get("zoomIn")||"Zoom In")+" (Alt+Mousewheel)"),o(mxUtils.bind(this,function(n){t.lightbox?(1==t.view.scale?this.lightboxFit():t.zoomTo(1),e(!1)):e(!0),mxEvent.consume(n)}),Editor.actualSizeLargeImage,mxResources.get("fit")||"Fit");var c=null,h=null,p=mxUtils.bind(this,function(t){null!=c&&(window.clearTimeout(c),fadeThead=null),null!=h&&(window.clearTimeout(h),fadeThead2=null),c=window.setTimeout(mxUtils.bind(this,function(){mxUtils.setOpacity(this.chromelessToolbar,0),c=null,h=window.setTimeout(mxUtils.bind(this,function(){this.chromelessToolbar.style.display="none",h=null}),600)}),t||200)}),m=mxUtils.bind(this,function(t){null!=c&&(window.clearTimeout(c),fadeThead=null),null!=h&&(window.clearTimeout(h),fadeThead2=null),this.chromelessToolbar.style.display="",mxUtils.setOpacity(this.chromelessToolbar,t||30)});if("1"==urlParams.layers){this.layersDialog=null;var g=o(mxUtils.bind(this,function(e){if(null!=this.layersDialog)this.layersDialog.parentNode.removeChild(this.layersDialog),this.layersDialog=null;else{this.layersDialog=t.createLayersDialog(),mxEvent.addListener(this.layersDialog,"mouseleave",mxUtils.bind(this,function(){this.layersDialog.parentNode.removeChild(this.layersDialog),this.layersDialog=null}));var n=g.getBoundingClientRect();mxUtils.setPrefixedStyle(this.layersDialog.style,"borderRadius","5px"),this.layersDialog.style.position="fixed",this.layersDialog.style.fontFamily="Helvetica,Arial",this.layersDialog.style.backgroundColor="#000000",this.layersDialog.style.width="160px",this.layersDialog.style.padding="4px 2px 4px 2px",this.layersDialog.style.color="#ffffff",mxUtils.setOpacity(this.layersDialog,70),this.layersDialog.style.left=n.left+"px",this.layersDialog.style.bottom=parseInt(this.chromelessToolbar.style.bottom)+this.chromelessToolbar.offsetHeight+4+"px";var i=mxUtils.getCurrentStyle(this.editor.graph.container);this.layersDialog.style.zIndex=i.zIndex,document.body.appendChild(this.layersDialog)}mxEvent.consume(e)}),Editor.layersLargeImage,mxResources.get("layers")||"Layers"),x=t.getModel();x.addListener(mxEvent.CHANGE,function(){g.style.display=x.getChildCount(x.root)>1?"":"none"})}null!=this.editor.editButtonLink&&o(mxUtils.bind(this,function(t){"_blank"==this.editor.editButtonLink?this.editor.editAsNew(this.getEditBlankXml(),null,!0):window.open(this.editor.editButtonLink,"editWindow"),mxEvent.consume(t)}),Editor.editLargeImage,mxResources.get("openInNewWindow")||"Open in New Window"),t.lightbox&&this.container!=document.body&&o(mxUtils.bind(this,function(t){"1"==urlParams.close?window.close():(this.destroy(),mxEvent.consume(t))}),Editor.closeLargeImage,(mxResources.get("close")||"Close")+" (Escape)"),this.chromelessToolbar.style.display="none",t.container.appendChild(this.chromelessToolbar),this.chromelessToolbar.style.marginLeft=-(24*l+10)+"px",this.addChromelessClickHandler(),mxEvent.addListener(t.container,mxClient.IS_POINTER?"pointermove":"mousemove",mxUtils.bind(this,function(t){mxEvent.isTouchEvent(t)||(mxEvent.isShiftDown(t)||m(30),p())})),mxEvent.addListener(this.chromelessToolbar,mxClient.IS_POINTER?"pointermove":"mousemove",function(t){mxEvent.consume(t)}),mxEvent.addListener(this.chromelessToolbar,"mouseenter",mxUtils.bind(this,function(t){mxEvent.isShiftDown(t)?p():m(100)})),mxEvent.addListener(this.chromelessToolbar,"mousemove",mxUtils.bind(this,function(t){mxEvent.isShiftDown(t)?p():m(100),mxEvent.consume(t)})),mxEvent.addListener(this.chromelessToolbar,"mouseleave",mxUtils.bind(this,function(t){mxEvent.isTouchEvent(t)||m(30)}));var y=t.getTolerance(),f=this;t.addMouseListener({startX:0,startY:0,scrollLeft:0,scrollTop:0,mouseDown:function(e,n){this.startX=n.getGraphX(),this.startY=n.getGraphY(),this.scrollLeft=t.container.scrollLeft,this.scrollTop=t.container.scrollTop},mouseMove:function(t,e){},mouseUp:function(e,n){mxEvent.isTouchEvent(n.getEvent())&&Math.abs(this.scrollLeft-t.container.scrollLeft)<y&&Math.abs(this.scrollTop-t.container.scrollTop)<y&&Math.abs(this.startX-n.getGraphX())<y&&Math.abs(this.startY-n.getGraphY())<y&&(parseFloat(f.chromelessToolbar.style.opacity||0)>0?p():m(30))}})}else if(this.editor.extendCanvas){var C=t.view.validate;t.view.validate=function(){if(null!=this.graph.container&&mxUtils.hasScrollbars(this.graph.container)){var t=this.graph.getPagePadding(),e=this.graph.getPageSize();this.translate.x,this.translate.y;this.translate.x=t.x-(this.x0||0)*e.width,this.translate.y=t.y-(this.y0||0)*e.height}C.apply(this,arguments)};var S=t.sizeDidChange;t.sizeDidChange=function(){if(null!=this.container&&mxUtils.hasScrollbars(this.container)){var e=this.getPageLayout(),n=this.getPagePadding(),i=this.getPageSize(),l=Math.ceil(2*n.x+e.width*i.width),o=Math.ceil(2*n.y+e.height*i.height),s=t.minimumGraphSize;null!=s&&s.width==l&&s.height==o||(t.minimumGraphSize=new mxRectangle(0,0,l,o));var r=n.x-e.x*i.width,a=n.y-e.y*i.height;if(!this.autoTranslate&&(this.view.translate.x!=r||this.view.translate.y!=a)){this.autoTranslate=!0,this.view.x0=e.x,this.view.y0=e.y;var d=t.view.translate.x,u=t.view.translate.y;return t.view.setTranslate(r,a),t.container.scrollLeft+=Math.round((r-d)*t.view.scale),t.container.scrollTop+=Math.round((a-u)*t.view.scale),void(this.autoTranslate=!1)}S.apply(this,arguments)}}}t.updateZoomTimeout=null,t.cumulativeZoomFactor=1;var E=null;t.lazyZoom=function(n){null!=this.updateZoomTimeout&&window.clearTimeout(this.updateZoomTimeout),n?this.view.scale*this.cumulativeZoomFactor<.15?this.cumulativeZoomFactor=(this.view.scale+.01)/this.view.scale:(this.cumulativeZoomFactor*=this.zoomFactor,this.cumulativeZoomFactor=Math.round(this.view.scale*this.cumulativeZoomFactor*20)/20/this.view.scale):this.view.scale*this.cumulativeZoomFactor<=.15?this.cumulativeZoomFactor=(this.view.scale-.01)/this.view.scale:(this.cumulativeZoomFactor/=this.zoomFactor,this.cumulativeZoomFactor=Math.round(this.view.scale*this.cumulativeZoomFactor*20)/20/this.view.scale),this.cumulativeZoomFactor=Math.max(.01,Math.min(this.view.scale*this.cumulativeZoomFactor,160)/this.view.scale),this.updateZoomTimeout=window.setTimeout(mxUtils.bind(this,function(){if(this.zoom(this.cumulativeZoomFactor),null!=e&&e(!1),null!=E&&mxUtils.hasScrollbars(t.container)){var n=mxUtils.getOffset(t.container),i=t.container.offsetWidth/2-E.x+n.x,l=t.container.offsetHeight/2-E.y+n.y;t.container.scrollLeft-=i*(this.cumulativeZoomFactor-1),t.container.scrollTop-=l*(this.cumulativeZoomFactor-1)}this.cumulativeZoomFactor=1,this.updateZoomTimeout=null}),20)},mxEvent.addMouseWheelListener(mxUtils.bind(this,function(e,n){if((mxEvent.isAltDown(e)||mxEvent.isControlDown(e)&&!mxClient.IS_MAC||t.panningHandler.isActive())&&(null==this.dialogs||0==this.dialogs.length))for(var i=mxEvent.getSource(e);null!=i;){if(i==t.container)return E=new mxPoint(mxEvent.getClientX(e),mxEvent.getClientY(e)),t.lazyZoom(n),void mxEvent.consume(e);i=i.parentNode}}))},a.prototype.createTemporaryGraph=function(t){var e=new Graph(document.createElement("div"),null,null,t);return e.resetViewOnRootChange=!1,e.setConnectable(!1),e.gridEnabled=!1,e.autoScroll=!1,e.setTooltips(!1),e.setEnabled(!1),e.container.style.visibility="hidden",e.container.style.position="absolute",e.container.style.overflow="hidden",e.container.style.height="1px",e.container.style.width="1px",e},a.prototype.addChromelessClickHandler=function(){var t=urlParams.highlight;null!=t&&t.length>0&&(t="#"+t),this.editor.graph.addClickHandler(t)},a.prototype.toggleFormatPanel=function(t){this.formatWidth=t||this.formatWidth>0?0:240,this.formatContainer.style.display=t||this.formatWidth>0?"":"none",this.refresh(),this.format.refresh(),this.fireEvent(new mxEventObject("formatWidthChanged"))},a.prototype.lightboxFit=function(){this.editor.graph.maxFitScale=2,this.editor.graph.fit(60),this.editor.graph.maxFitScale=null},a.prototype.isSelectionAllowed=function(t){return"SELECT"==mxEvent.getSource(t).nodeName||"INPUT"==mxEvent.getSource(t).nodeName&&mxUtils.isAncestorNode(this.formatContainer,mxEvent.getSource(t))},a.prototype.addBeforeUnloadListener=function(){window.onbeforeunload=mxUtils.bind(this,function(){if(!this.editor.chromeless)return this.onBeforeUnload()})},a.prototype.onBeforeUnload=function(){if(this.editor.modified)return mxResources.get("allChangesLost")},a.prototype.open=function(){try{null!=window.opener&&null!=window.opener.openFile&&window.opener.openFile.setConsumer(mxUtils.bind(this,function(t,e){try{var n=mxUtils.parseXml(t);return this.editor.setGraphXml(n.documentElement),this.editor.setModified(!1),this.editor.undoManager.clear(),void(null!=e&&(this.editor.setFilename(e),this.updateDocumentTitle()))}catch(t){mxUtils.alert(mxResources.get("invalidOrMissingFile")+": "+t.message)}}))}catch(t){}this.editor.graph.view.validate(),this.editor.graph.sizeDidChange(),this.editor.fireEvent(new mxEventObject("resetGraphView"))},a.prototype.setCurrentMenu=function(t,e){this.currentMenuElt=e,this.currentMenu=t},a.prototype.resetCurrentMenu=function(){this.currentMenuElt=null,this.currentMenu=null},a.prototype.hideCurrentMenu=function(t,e){null!=this.currentMenu&&(this.currentMenu.hideMenu(),this.resetCurrentMenu())},a.prototype.updateDocumentTitle=function(){var t=this.editor.getOrCreateFilename();null!=this.editor.appName&&(t+=" - "+this.editor.appName),document.title=t},a.prototype.createHoverIcons=function(){return new HoverIcons(this.editor.graph)},a.prototype.redo=function(){try{this.editor.graph.isEditing()?document.execCommand("redo",!1,null):this.editor.undoManager.redo()}catch(t){}},a.prototype.undo=function(){try{var t=this.editor.graph;if(t.isEditing()){var e=t.cellEditor.textarea.innerHTML;document.execCommand("undo",!1,null),e==t.cellEditor.textarea.innerHTML&&(t.stopEditing(!0),this.editor.undoManager.undo())}else this.editor.undoManager.undo()}catch(t){}},a.prototype.canRedo=function(){return this.editor.graph.isEditing()||this.editor.undoManager.canRedo()},a.prototype.canUndo=function(){return this.editor.graph.isEditing()||this.editor.undoManager.canUndo()},a.prototype.getEditBlankXml=function(){return mxUtils.getXml(this.getGraphXml())},a.prototype.getUrl=function(t){var e=null!=t?t:window.location.pathname,n=e.indexOf("?")>0?1:0;for(var i in urlParams)e+=0==n?"?":"&",e+=i+"="+urlParams[i],n++;return e},a.prototype.setScrollbars=function(t){var e=this.editor.graph,n=e.container.style.overflow;if(e.scrollbars=t,this.editor.updateGraphComponents(),n!=e.container.style.overflow)if("hidden"==e.container.style.overflow){var i=e.view.translate;e.view.setTranslate(i.x-e.container.scrollLeft/e.view.scale,i.y-e.container.scrollTop/e.view.scale),e.container.scrollLeft=0,e.container.scrollTop=0,e.minimumGraphSize=null,e.sizeDidChange()}else{var l=e.view.translate.x,o=e.view.translate.y;e.view.translate.x=0,e.view.translate.y=0,e.sizeDidChange(),e.container.scrollLeft-=Math.round(l*e.view.scale),e.container.scrollTop-=Math.round(o*e.view.scale)}this.fireEvent(new mxEventObject("scrollbarsChanged"))},a.prototype.hasScrollbars=function(){return this.editor.graph.scrollbars},a.prototype.resetScrollbars=function(){var t=this.editor.graph;if(this.editor.extendCanvas){if(!this.editor.chromeless)if(mxUtils.hasScrollbars(t.container))if(t.pageVisible){var e=t.getPagePadding();t.container.scrollTop=Math.floor(e.y-this.editor.initialTopSpacing),t.container.scrollLeft=Math.floor(Math.min(e.x,(t.container.scrollWidth-t.container.clientWidth)/2));var n=t.getGraphBounds();n.width>0&&n.height>0&&(n.x>t.container.scrollLeft+.9*t.container.clientWidth&&(t.container.scrollLeft=Math.min(n.x+n.width-t.container.clientWidth,n.x-10)),n.y>t.container.scrollTop+.9*t.container.clientHeight&&(t.container.scrollTop=Math.min(n.y+n.height-t.container.clientHeight,n.y-10)))}else{var n=t.getGraphBounds(),i=Math.max(n.width,t.scrollTileSize.width*t.view.scale),l=Math.max(n.height,t.scrollTileSize.height*t.view.scale);t.container.scrollTop=Math.floor(Math.max(0,n.y-Math.max(20,(t.container.clientHeight-l)/4))),t.container.scrollLeft=Math.floor(Math.max(0,n.x-Math.max(0,(t.container.clientWidth-i)/2)))}else if(t.pageVisible){var o=t.view.getBackgroundPageBounds();t.view.setTranslate(Math.floor(Math.max(0,(t.container.clientWidth-o.width)/2)-o.x),Math.floor(Math.max(0,(t.container.clientHeight-o.height)/2)-o.y))}else{var n=t.getGraphBounds();t.view.setTranslate(Math.floor(Math.max(0,Math.max(0,(t.container.clientWidth-n.width)/2)-n.x)),Math.floor(Math.max(0,Math.max(20,(t.container.clientHeight-n.height)/4))-n.y))}}else t.container.scrollTop=0,t.container.scrollLeft=0,mxUtils.hasScrollbars(t.container)||t.view.setTranslate(0,0)},a.prototype.setPageVisible=function(t){var e=this.editor.graph,n=mxUtils.hasScrollbars(e.container),i=0,l=0;if(n&&(i=e.view.translate.x*e.view.scale-e.container.scrollLeft,l=e.view.translate.y*e.view.scale-e.container.scrollTop),e.pageVisible=t,e.pageBreaksVisible=t,e.preferPageSize=t,e.view.validateBackground(),n){var o=e.getSelectionCells();e.clearSelection(),e.setSelectionCells(o)}e.sizeDidChange(),n&&(e.container.scrollLeft=e.view.translate.x*e.view.scale-i,e.container.scrollTop=e.view.translate.y*e.view.scale-l),this.fireEvent(new mxEventObject("pageViewChanged"))},a.prototype.setBackgroundColor=function(t){this.editor.graph.background=t,this.editor.graph.view.validateBackground(),this.fireEvent(new mxEventObject("backgroundColorChanged"))},a.prototype.setFoldingEnabled=function(t){this.editor.graph.foldingEnabled=t,this.editor.graph.view.revalidate(),this.fireEvent(new mxEventObject("foldingEnabledChanged"))},a.prototype.setPageFormat=function(t){this.editor.graph.pageFormat=t,this.editor.graph.pageVisible?(this.editor.graph.view.validateBackground(),this.editor.graph.sizeDidChange()):this.actions.get("pageView").funct(),this.fireEvent(new mxEventObject("pageFormatChanged"))},a.prototype.setPageScale=function(t){this.editor.graph.pageScale=t,this.editor.graph.pageVisible?(this.editor.graph.view.validateBackground(),this.editor.graph.sizeDidChange()):this.actions.get("pageView").funct(),this.fireEvent(new mxEventObject("pageScaleChanged"))},a.prototype.setGridColor=function(t){this.editor.graph.view.gridColor=t,this.editor.graph.view.validateBackground(),this.fireEvent(new mxEventObject("gridColorChanged"))},a.prototype.addUndoListener=function(){var t=this.actions.get("undo"),e=this.actions.get("redo"),n=this.editor.undoManager,i=mxUtils.bind(this,function(){t.setEnabled(this.canUndo()),e.setEnabled(this.canRedo())});n.addListener(mxEvent.ADD,i),n.addListener(mxEvent.UNDO,i),n.addListener(mxEvent.REDO,i),n.addListener(mxEvent.CLEAR,i);var l=this.editor.graph.cellEditor.startEditing;this.editor.graph.cellEditor.startEditing=function(){l.apply(this,arguments),i()};var o=this.editor.graph.cellEditor.stopEditing;this.editor.graph.cellEditor.stopEditing=function(t,e){o.apply(this,arguments),i()},i()},a.prototype.updateActionStates=function(){var t=this.editor.graph,e=!t.isSelectionEmpty(),n=!1,i=!1,l=t.getSelectionCells();if(null!=l)for(var o=0;o<l.length;o++){var s=l[o];if(t.getModel().isEdge(s)&&(i=!0),t.getModel().isVertex(s)&&(n=!0),i&&n)break}for(var r=["cut","copy","bold","italic","underline","delete","duplicate","editStyle","editTooltip","editLink","backgroundColor","borderColor","edit","toFront","toBack","lockUnlock","solid","dashed","dotted","fillColor","gradientColor","shadow","fontColor","formattedText","rounded","toggleRounded","sharp","strokeColor"],o=0;o<r.length;o++)this.actions.get(r[o]).setEnabled(e);this.actions.get("setAsDefaultStyle").setEnabled(1==t.getSelectionCount()),this.actions.get("turn").setEnabled(!t.isSelectionEmpty()),this.actions.get("curved").setEnabled(i),this.actions.get("clearWaypoints").setEnabled(i),this.actions.get("rotation").setEnabled(n),this.actions.get("wordWrap").setEnabled(n),this.actions.get("autosize").setEnabled(n),this.actions.get("collapsible").setEnabled(n);var a=n&&1==t.getSelectionCount();this.actions.get("group").setEnabled(t.getSelectionCount()>1||a&&!t.isContainer(t.getSelectionCell())),this.actions.get("ungroup").setEnabled(1==t.getSelectionCount()&&(t.getModel().getChildCount(t.getSelectionCell())>0||a&&t.isContainer(t.getSelectionCell()))),this.actions.get("removeFromGroup").setEnabled(a&&t.getModel().isVertex(t.getModel().getParent(t.getSelectionCell())));t.view.getState(t.getSelectionCell());this.menus.get("navigation").setEnabled(e||null!=t.view.currentRoot),this.actions.get("collapsible").setEnabled(n&&1==t.getSelectionCount()&&(t.isContainer(t.getSelectionCell())||t.model.getChildCount(t.getSelectionCell())>0)),this.actions.get("home").setEnabled(null!=t.view.currentRoot),this.actions.get("exitGroup").setEnabled(null!=t.view.currentRoot),this.actions.get("enterGroup").setEnabled(1==t.getSelectionCount()&&t.isValidRoot(t.getSelectionCell()));var d=1==t.getSelectionCount()&&t.isCellFoldable(t.getSelectionCell());this.actions.get("expand").setEnabled(d),this.actions.get("collapse").setEnabled(d),this.actions.get("editLink").setEnabled(1==t.getSelectionCount()),this.actions.get("openLink").setEnabled(1==t.getSelectionCount()&&null!=t.getLinkForCell(t.getSelectionCell())),this.actions.get("guides").setEnabled(t.isEnabled()),this.actions.get("grid").setEnabled(!this.editor.chromeless);var u=t.isEnabled()&&!t.isCellLocked(t.getDefaultParent());this.menus.get("layout").setEnabled(u),this.menus.get("insert").setEnabled(u),this.menus.get("direction").setEnabled(u&&n),this.menus.get("align").setEnabled(u&&n&&t.getSelectionCount()>1),this.menus.get("distribute").setEnabled(u&&n&&t.getSelectionCount()>1),this.actions.get("selectVertices").setEnabled(u),this.actions.get("selectEdges").setEnabled(u),this.actions.get("selectAll").setEnabled(u),this.actions.get("selectNone").setEnabled(u),this.updatePasteActionStates()},a.prototype.refresh=function(t){t=null==t||t;var e=mxClient.IS_IE&&(null==document.documentMode||5==document.documentMode),n=this.container.clientWidth,i=this.container.clientHeight;this.container==document.body&&(n=document.body.clientWidth||document.documentElement.clientWidth,i=e?document.body.clientHeight||document.documentElement.clientHeight:document.documentElement.clientHeight);var l=0;mxClient.IS_IOS&&!window.navigator.standalone&&window.innerHeight!=document.documentElement.clientHeight&&(l=document.documentElement.clientHeight-window.innerHeight,window.scrollTo(0,0));var o=Math.max(0,Math.min(this.hsplitPosition,n-this.splitSize-20)),s=0;null!=this.menubar&&(this.menubarContainer.style.height=this.menubarHeight+"px",s+=this.menubarHeight),null!=this.toolbar&&(this.toolbarContainer.style.top=this.menubarHeight+"px",this.toolbarContainer.style.height=this.toolbarHeight+"px",s+=this.toolbarHeight),s>0&&!mxClient.IS_QUIRKS&&(s+=1);var r=0;if(null!=this.sidebarFooterContainer){var a=this.footerHeight+l;r=Math.max(0,Math.min(i-s-a,this.sidebarFooterHeight)),this.sidebarFooterContainer.style.width=o+"px",this.sidebarFooterContainer.style.height=r+"px",this.sidebarFooterContainer.style.bottom=a+"px"}var d=null!=this.format?this.formatWidth:0;if(this.sidebarContainer.style.top=s+"px",this.sidebarContainer.style.width=o+"px",this.formatContainer.style.top=s+"px",this.formatContainer.style.width=d+"px",this.formatContainer.style.display=null!=this.format?"":"none",this.diagramContainer.style.left=null!=this.hsplit.parentNode?o+this.splitSize+"px":"0px",this.diagramContainer.style.top=this.sidebarContainer.style.top,this.footerContainer.style.height=this.footerHeight+"px",this.hsplit.style.top=this.sidebarContainer.style.top,this.hsplit.style.bottom=this.footerHeight+l+"px",this.hsplit.style.left=o+"px",null!=this.tabContainer&&(this.tabContainer.style.left=this.diagramContainer.style.left),e){this.menubarContainer.style.width=n+"px",this.toolbarContainer.style.width=this.menubarContainer.style.width;var u=Math.max(0,i-this.footerHeight-this.menubarHeight-this.toolbarHeight);this.sidebarContainer.style.height=u-r+"px",this.formatContainer.style.height=u+"px",this.diagramContainer.style.width=null!=this.hsplit.parentNode?Math.max(0,n-o-this.splitSize-d)+"px":n+"px",this.footerContainer.style.width=this.menubarContainer.style.width;var c=Math.max(0,i-this.footerHeight-this.menubarHeight-this.toolbarHeight);null!=this.tabContainer&&(this.tabContainer.style.width=this.diagramContainer.style.width,this.tabContainer.style.bottom=this.footerHeight+l+"px",c-=this.tabContainer.clientHeight),this.diagramContainer.style.height=c+"px",this.hsplit.style.height=c+"px"}else{this.footerHeight>0&&(this.footerContainer.style.bottom=l+"px"),this.diagramContainer.style.right=d+"px";var h=0;null!=this.tabContainer&&(this.tabContainer.style.bottom=this.footerHeight+l+"px",this.tabContainer.style.right=this.diagramContainer.style.right,h=this.tabContainer.clientHeight),this.sidebarContainer.style.bottom=this.footerHeight+r+l+"px",this.formatContainer.style.bottom=this.footerHeight+l+"px",this.diagramContainer.style.bottom=this.footerHeight+l+h+"px"}t&&this.editor.graph.sizeDidChange()},a.prototype.createTabContainer=function(){return null},a.prototype.createDivs=function(){this.menubarContainer=this.createDiv("geMenubarContainer"),this.toolbarContainer=this.createDiv("geToolbarContainer"),this.sidebarContainer=this.createDiv("geSidebarContainer"),this.formatContainer=this.createDiv("geSidebarContainer"),this.diagramContainer=this.createDiv("geDiagramContainer"),this.footerContainer=this.createDiv("geFooterContainer"),this.hsplit=this.createDiv("geHsplit"),this.hsplit.setAttribute("title",mxResources.get("collapseExpand")),this.menubarContainer.style.top="0px",this.menubarContainer.style.left="0px",this.menubarContainer.style.right="0px",this.toolbarContainer.style.left="0px",this.toolbarContainer.style.right="0px",this.sidebarContainer.style.left="0px",this.formatContainer.style.right="0px",this.formatContainer.style.zIndex="1",this.diagramContainer.style.right=(null!=this.format?this.formatWidth:0)+"px",this.footerContainer.style.left="0px",this.footerContainer.style.right="0px",this.footerContainer.style.bottom="0px",this.footerContainer.style.zIndex=mxPopupMenu.prototype.zIndex-2,this.hsplit.style.width=this.splitSize+"px",this.formatContainer.style.backgroundColor="whiteSmoke",this.formatContainer.style.overflowX="hidden",this.formatContainer.style.overflowY="auto",this.formatContainer.style.fontSize="12px",this.sidebarFooterContainer=this.createSidebarFooterContainer(),this.sidebarFooterContainer&&(this.sidebarFooterContainer.style.left="0px"),this.editor.chromeless||(this.tabContainer=this.createTabContainer())},a.prototype.createSidebarFooterContainer=function(){return null},a.prototype.createUi=function(){this.menubar=this.editor.chromeless?null:this.menus.createMenubar(this.createDiv("geMenubar")),null!=this.menubar&&this.menubarContainer.appendChild(this.menubar.container),null!=this.menubar&&(this.statusContainer=this.createStatusContainer(),this.editor.addListener("statusChanged",mxUtils.bind(this,function(){this.setStatusText(this.editor.getStatus())})),this.setStatusText(this.editor.getStatus()),this.menubar.container.appendChild(this.statusContainer),this.container.appendChild(this.menubarContainer)),this.sidebar=this.editor.chromeless?null:this.createSidebar(this.sidebarContainer),null!=this.sidebar&&this.container.appendChild(this.sidebarContainer),this.format=this.editor.chromeless||!this.formatEnabled?null:this.createFormat(this.formatContainer),null!=this.format&&this.container.appendChild(this.formatContainer);var t=this.editor.chromeless?null:this.createFooter();null!=t&&(this.footerContainer.appendChild(t),this.container.appendChild(this.footerContainer)),null!=this.sidebar&&this.sidebarFooterContainer&&this.container.appendChild(this.sidebarFooterContainer),this.container.appendChild(this.diagramContainer),null!=this.container&&null!=this.tabContainer&&this.container.appendChild(this.tabContainer),this.toolbar=this.editor.chromeless?null:this.createToolbar(this.createDiv("geToolbar")),null!=this.toolbar&&(this.toolbarContainer.appendChild(this.toolbar.container),this.container.appendChild(this.toolbarContainer)),null!=this.sidebar&&(this.container.appendChild(this.hsplit),this.addSplitHandler(this.hsplit,!0,0,mxUtils.bind(this,function(t){this.hsplitPosition=t,this.refresh()})))},a.prototype.createStatusContainer=function(){var t=document.createElement("a");return t.className="geItem geStatus",t},a.prototype.setStatusText=function(t){this.statusContainer.innerHTML=t},a.prototype.createToolbar=function(t){return new s(this,t)},a.prototype.createSidebar=function(t){return new i(this,t)},a.prototype.createFormat=function(t){return new r(this,t)},a.prototype.createFooter=function(){return this.createDiv("geFooter")},a.prototype.createDiv=function(t){var e=document.createElement("div");return e.className=t,e},a.prototype.addSplitHandler=function(t,e,n,i){function l(t){if(null!=s){var l=new mxPoint(mxEvent.getClientX(t),mxEvent.getClientY(t));i(Math.max(0,r+(e?l.x-s.x:s.y-l.y)-n)),mxEvent.consume(t),r!=u()&&(a=!0,d=null)}}function o(t){l(t),r=null,s=null}var s=null,r=null,a=!0,d=null;mxClient.IS_POINTER&&(t.style.touchAction="none");var u=mxUtils.bind(this,function(){var i=parseInt(e?t.style.left:t.style.bottom);return e||(i=i+n-this.footerHeight),i});mxEvent.addGestureListeners(t,function(t){s=new mxPoint(mxEvent.getClientX(t),mxEvent.getClientY(t)),r=u(),a=!1,mxEvent.consume(t)}),mxEvent.addListener(t,"click",function(t){if(!a){var e=null!=d?d-n:0;d=u(),i(e),mxEvent.consume(t)}}),mxEvent.addGestureListeners(document,null,l,o),this.destroyFunctions.push(function(){mxEvent.removeGestureListeners(document,null,l,o)})},a.prototype.showDialog=function(t,e,n,i,l,o){this.editor.graph.tooltipHandler.hideTooltip(),null==this.dialogs&&(this.dialogs=[]),this.dialog=new Dialog(this,t,e,n,i,l,o),this.dialogs.push(this.dialog)},a.prototype.hideDialog=function(t){if(null!=this.dialogs&&this.dialogs.length>0){this.dialogs.pop().close(t),this.dialog=this.dialogs.length>0?this.dialogs[this.dialogs.length-1]:null,null==this.dialog&&"hidden"!=this.editor.graph.container.style.visibility&&this.editor.graph.container.focus(),this.editor.fireEvent(new mxEventObject("hideDialog"))}},a.prototype.pickColor=function(t,e){var n=this.editor.graph,i=n.cellEditor.saveSelection(),l=new ColorDialog(this,t||"none",function(t){n.cellEditor.restoreSelection(i),e(t)},function(){n.cellEditor.restoreSelection(i)});this.showDialog(l.container,220,430,!0,!1),l.init()},a.prototype.openFile=function(){window.openFile=new OpenFile(mxUtils.bind(this,function(t){this.hideDialog(t)})),this.showDialog(new OpenDialog(this).container,Editor.useLocalStorage?640:320,Editor.useLocalStorage?480:220,!0,!0,function(){window.openFile=null})},a.prototype.extractGraphModelFromHtml=function(t){var e=null;try{var n=t.indexOf("&lt;mxGraphModel ");if(n>=0){var i=t.lastIndexOf("&lt;/mxGraphModel&gt;");i>n&&(e=t.substring(n,i+21).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/\\&quot;/g,'"').replace(/\n/g,""))}}catch(t){}return e},a.prototype.extractGraphModelFromEvent=function(t){var e=null,n=null;if(null!=t){var i=null!=t.dataTransfer?t.dataTransfer:t.clipboardData;if(null!=i&&(10==document.documentMode||11==document.documentMode?n=i.getData("Text"):(n=mxUtils.indexOf(i.types,"text/html")>=0?i.getData("text/html"):null,mxUtils.indexOf(i.types,null==n||0==n.length)&&(n=i.getData("text/plain"))),null!=n)){n=this.editor.graph.zapGremlins(mxUtils.trim(n));var l=this.extractGraphModelFromHtml(n);null!=l&&(n=l)}}return null!=n&&this.isCompatibleString(n)&&(e=n),e},a.prototype.isCompatibleString=function(t){return!1},a.prototype.executeLayout=function(t,e,n){var i=this.editor.graph;if(i.isEnabled()){i.getModel().beginUpdate();try{t()}catch(t){throw t}finally{if(this.allowAnimation&&e&&navigator.userAgent.indexOf("Camino")<0){var l=new mxMorphing(i);l.addListener(mxEvent.DONE,mxUtils.bind(this,function(){i.getModel().endUpdate(),null!=n&&n()})),l.startAnimation()}else i.getModel().endUpdate(),null!=n&&n()}}},a.prototype.showImageDialog=function(t,e,n,i){var l=this.editor.graph.cellEditor,o=l.saveSelection(),s=mxUtils.prompt(t,e);if(l.restoreSelection(o),null!=s&&s.length>0){var r=new Image;r.onload=function(){n(s,r.width,r.height)},r.onerror=function(){n(null),mxUtils.alert(mxResources.get("fileNotFound"))},r.src=s}else n(null)},a.prototype.showLinkDialog=function(t,e,n){var i=new LinkDialog(this,t,e,n);this.showDialog(i.container,420,90,!0,!0),i.init()},a.prototype.showBackgroundImageDialog=function(t){t=null!=t?t:mxUtils.bind(this,function(t){this.setBackgroundImage(t)});var e=mxUtils.prompt(mxResources.get("backgroundImage"),"");if(null!=e&&e.length>0){var n=new Image;n.onload=function(){t(new mxImage(e,n.width,n.height))},n.onerror=function(){t(null),mxUtils.alert(mxResources.get("fileNotFound"))},n.src=e}else t(null)},a.prototype.setBackgroundImage=function(t){this.editor.graph.setBackgroundImage(t),this.editor.graph.view.validateBackgroundImage(),this.fireEvent(new mxEventObject("backgroundImageChanged"))},a.prototype.confirm=function(t,e,n){mxUtils.confirm(t)?null!=e&&e():null!=n&&n()},a.prototype.createOutline=function(t){var e=new mxOutline(this.editor.graph);return e.border=20,mxEvent.addListener(window,"resize",function(){e.update()}),this.addListener("pageFormatChanged",function(){e.update()}),e},a.prototype.createKeyHandler=function(t){function e(t,e,n){s.push(function(){if(!i.isSelectionEmpty()&&i.isEnabled())if(e=null!=e?e:1,n){i.getModel().beginUpdate();try{for(var l=i.getSelectionCells(),o=0;o<l.length;o++)if(i.getModel().isVertex(l[o])&&i.isCellResizable(l[o])){var s=i.getCellGeometry(l[o]);null!=s&&(s=s.clone(),37==t?s.width=Math.max(0,s.width-e):38==t?s.height=Math.max(0,s.height-e):39==t?s.width+=e:40==t&&(s.height+=e),i.getModel().setGeometry(l[o],s))}}finally{i.getModel().endUpdate()}}else{var r=i.getSelectionCell(),a=i.model.getParent(r),d=null;if(1==i.getSelectionCount()&&i.model.isVertex(r)&&null!=i.layoutManager&&!i.isCellLocked(r)&&(d=i.layoutManager.getLayout(a)),null!=d&&d.constructor==mxStackLayout){var u=a.getIndex(r);37==t||38==t?i.model.add(a,r,Math.max(0,u-1)):39!=t&&40!=t||i.model.add(a,r,Math.min(i.model.getChildCount(a),u+1))}else{var c=0,h=0;37==t?c=-e:38==t?h=-e:39==t?c=e:40==t&&(h=e),i.moveCells(i.getMovableCells(i.getSelectionCells()),c,h)}}}),null!=r&&window.clearTimeout(r),r=window.setTimeout(function(){if(s.length>0){i.getModel().beginUpdate();try{for(var t=0;t<s.length;t++)s[t]();s=[]}finally{i.getModel().endUpdate()}i.scrollCellToVisible(i.getSelectionCell())}},200)}var n=this,i=this.editor.graph,l=new mxKeyHandler(i),o=l.isEventIgnored;l.isEventIgnored=function(t){return(!this.isControlDown(t)||mxEvent.isShiftDown(t)||90!=t.keyCode&&89!=t.keyCode&&188!=t.keyCode&&190!=t.keyCode&&85!=t.keyCode)&&(66!=t.keyCode&&73!=t.keyCode||!this.isControlDown(t)||this.graph.cellEditor.isContentEditing()&&!mxClient.IS_FF&&!mxClient.IS_SF)&&o.apply(this,arguments)},l.isEnabledForEvent=function(t){return!mxEvent.isConsumed(t)&&this.isGraphEvent(t)&&this.isEnabled()},l.isControlDown=function(t){return mxEvent.isControlDown(t)||mxClient.IS_MAC&&t.metaKey};var s=[],r=null,a={37:mxConstants.DIRECTION_WEST,38:mxConstants.DIRECTION_NORTH,39:mxConstants.DIRECTION_EAST,40:mxConstants.DIRECTION_SOUTH},d=l.getFunction;mxKeyHandler.prototype.getFunction=function(t){if(i.isEnabled()){if(9==t.keyCode&&mxEvent.isAltDown(t))return mxEvent.isShiftDown(t)?function(){i.selectParentCell()}:function(){i.selectChildCell()};if(null!=a[t.keyCode]&&!i.isSelectionEmpty()){if(!mxEvent.isShiftDown(t)||!mxEvent.isAltDown(t))return this.isControlDown(t)?function(){e(t.keyCode,mxEvent.isShiftDown(t)?i.gridSize:null,!0)}:function(){e(t.keyCode,mxEvent.isShiftDown(t)?i.gridSize:null)};if(i.model.isVertex(i.getSelectionCell()))return function(){var e=i.connectVertex(i.getSelectionCell(),a[t.keyCode],i.defaultEdgeLength,t,!0);null!=e&&e.length>0&&(1==e.length&&i.model.isEdge(e[0])?i.setSelectionCell(i.model.getTerminal(e[0],!1)):i.setSelectionCell(e[e.length-1]),null!=n.hoverIcons&&n.hoverIcons.update(i.view.getState(i.getSelectionCell())))}}}return d.apply(this,arguments)},l.bindAction=mxUtils.bind(this,function(t,e,n,i){var o=this.actions.get(n);if(null!=o){var s=function(){o.isEnabled()&&o.funct()};e?i?l.bindControlShiftKey(t,s):l.bindControlKey(t,s):i?l.bindShiftKey(t,s):l.bindKey(t,s)}});var u=l.escape;return l.escape=function(t){u.apply(this,arguments)},l.enter=function(){},l.bindControlShiftKey(36,function(){i.exitGroup()}),l.bindControlShiftKey(35,function(){i.enterGroup()}),l.bindKey(36,function(){i.home()}),l.bindKey(35,function(){i.refresh()}),l.bindAction(107,!0,"zoomIn"),l.bindAction(109,!0,"zoomOut"),l.bindAction(80,!0,"print"),l.bindAction(79,!0,"outline",!0),l.bindAction(112,!1,"about"),this.editor.chromeless||(l.bindControlKey(36,function(){i.isEnabled()&&i.foldCells(!0)}),l.bindControlKey(35,function(){i.isEnabled()&&i.foldCells(!1)}),l.bindControlKey(13,function(){i.isEnabled()&&i.setSelectionCells(i.duplicateCells(i.getSelectionCells(),!1))}),l.bindAction(8,!1,"delete"),l.bindAction(8,!0,"deleteAll"),l.bindAction(46,!1,"delete"),l.bindAction(46,!0,"deleteAll"),l.bindAction(72,!0,"resetView"),l.bindAction(72,!0,"fitWindow",!0),l.bindAction(74,!0,"fitPage"),l.bindAction(74,!0,"fitTwoPages",!0),l.bindAction(48,!0,"customZoom"),l.bindAction(82,!0,"turn"),l.bindAction(82,!0,"clearDefaultStyle",!0),l.bindAction(83,!0,"save"),l.bindAction(83,!0,"saveAs",!0),l.bindAction(65,!0,"selectAll"),l.bindAction(65,!0,"selectNone",!0),l.bindAction(73,!0,"selectVertices",!0),l.bindAction(69,!0,"selectEdges",!0),l.bindAction(69,!0,"editStyle"),l.bindAction(66,!0,"bold"),l.bindAction(66,!0,"toBack",!0),l.bindAction(70,!0,"toFront",!0),l.bindAction(68,!0,"duplicate"),l.bindAction(68,!0,"setAsDefaultStyle",!0),l.bindAction(90,!0,"undo"),l.bindAction(89,!0,"autosize",!0),l.bindAction(88,!0,"cut"),l.bindAction(67,!0,"copy"),l.bindAction(81,!0,"connectionArrows"),l.bindAction(81,!0,"connectionPoints",!0),l.bindAction(86,!0,"paste"),l.bindAction(71,!0,"group"),l.bindAction(77,!0,"editData"),l.bindAction(71,!0,"grid",!0),l.bindAction(73,!0,"italic"),l.bindAction(76,!0,"lockUnlock"),l.bindAction(76,!0,"layers",!0),l.bindAction(80,!0,"formatPanel",!0),l.bindAction(85,!0,"underline"),l.bindAction(85,!0,"ungroup",!0),l.bindAction(190,!0,"superscript"),l.bindAction(188,!0,"subscript"),l.bindKey(13,function(){i.isEnabled()&&i.startEditingAtCell()}),l.bindKey(113,function(){i.isEnabled()&&i.startEditingAtCell()})),mxClient.IS_WIN?l.bindAction(89,!0,"redo"):l.bindAction(90,!0,"redo",!0),l},a.prototype.destroy=function(){if(null!=this.editor&&(this.editor.destroy(),this.editor=null),null!=this.menubar&&(this.menubar.destroy(),this.menubar=null),null!=this.toolbar&&(this.toolbar.destroy(),this.toolbar=null),null!=this.sidebar&&(this.sidebar.destroy(),this.sidebar=null),null!=this.keyHandler&&(this.keyHandler.destroy(),this.keyHandler=null),null!=this.keydownHandler&&(mxEvent.removeListener(document,"keydown",this.keydownHandler),this.keydownHandler=null),null!=this.keyupHandler&&(mxEvent.removeListener(document,"keyup",this.keyupHandler),this.keyupHandler=null),null!=this.resizeHandler&&(mxEvent.removeListener(window,"resize",this.resizeHandler),this.resizeHandler=null),null!=this.gestureHandler&&(mxEvent.removeGestureListeners(document,this.gestureHandler),this.gestureHandler=null),null!=this.orientationChangeHandler&&(mxEvent.removeListener(window,"orientationchange",this.orientationChangeHandler),this.orientationChangeHandler=null),null!=this.scrollHandler&&(mxEvent.removeListener(window,"scroll",this.scrollHandler),this.scrollHandler=null),null!=this.destroyFunctions){for(var t=0;t<this.destroyFunctions.length;t++)this.destroyFunctions[t]();this.destroyFunctions=null}for(var e=[this.menubarContainer,this.toolbarContainer,this.sidebarContainer,this.formatContainer,this.diagramContainer,this.footerContainer,this.chromelessToolbar,this.hsplit,this.sidebarFooterContainer,this.layersDialog],t=0;t<e.length;t++)null!=e[t]&&null!=e[t].parentNode&&e[t].parentNode.removeChild(e[t])},t.exports=a},function(t,e,n){"use strict";function i(t,e){this.editorUi=t,this.container=e}function l(t,e){mxEventSource.call(this),this.funct=t,this.enabled=null==e||e}var o=function(t){this.editorUi=t,this.menus={},this.init(),mxClient.IS_SVG||((new Image).src=this.checkmarkImage)};o.prototype.defaultFont="Helvetica",o.prototype.defaultFontSize="12",o.prototype.defaultMenuItems=["file","edit","view","arrange","extras","help"],o.prototype.defaultFonts=["Helvetica","Verdana","Times New Roman","Garamond","Comic Sans MS","Courier New","Georgia","Lucida Console","Tahoma"],o.prototype.init=function(){var t=this.editorUi.editor.graph,e=mxUtils.bind(t,t.isEnabled);this.customFonts=[],this.customFontSizes=[],this.put("fontFamily",new l(mxUtils.bind(this,function(t,e){for(var n=mxUtils.bind(this,function(n){this.styleChange(t,n,[mxConstants.STYLE_FONTFAMILY],[n],null,e,function(){document.execCommand("fontname",!1,n)}).firstChild.nextSibling.style.fontFamily=n}),i=0;i<this.defaultFonts.length;i++)n(this.defaultFonts[i]);if(t.addSeparator(e),this.customFonts.length>0){for(var i=0;i<this.customFonts.length;i++)n(this.customFonts[i]);t.addSeparator(e),t.addItem(mxResources.get("reset"),null,mxUtils.bind(this,function(){this.customFonts=[]}),e),t.addSeparator(e)}this.promptChange(t,mxResources.get("custom")+"...","",mxConstants.DEFAULT_FONTFAMILY,mxConstants.STYLE_FONTFAMILY,e,!0,mxUtils.bind(this,function(t){this.customFonts.push(t)}))}))),this.put("formatBlock",new l(mxUtils.bind(this,function(e,n){function i(i,l){return e.addItem(i,null,mxUtils.bind(this,function(){t.cellEditor.textarea.focus(),document.execCommand("formatBlock",!1,"<"+l+">")}),n)}i(mxResources.get("normal"),"p"),i("","h1").firstChild.nextSibling.innerHTML='<h1 style="margin:0px;">'+mxResources.get("heading")+" 1</h1>",i("","h2").firstChild.nextSibling.innerHTML='<h2 style="margin:0px;">'+mxResources.get("heading")+" 2</h2>",i("","h3").firstChild.nextSibling.innerHTML='<h3 style="margin:0px;">'+mxResources.get("heading")+" 3</h3>",i("","h4").firstChild.nextSibling.innerHTML='<h4 style="margin:0px;">'+mxResources.get("heading")+" 4</h4>",i("","h5").firstChild.nextSibling.innerHTML='<h5 style="margin:0px;">'+mxResources.get("heading")+" 5</h5>",i("","h6").firstChild.nextSibling.innerHTML='<h6 style="margin:0px;">'+mxResources.get("heading")+" 6</h6>",i("","pre").firstChild.nextSibling.innerHTML='<pre style="margin:0px;">'+mxResources.get("formatted")+"</pre>",i("","blockquote").firstChild.nextSibling.innerHTML='<blockquote style="margin-top:0px;margin-bottom:0px;">'+mxResources.get("blockquote")+"</blockquote>"}))),this.put("fontSize",new l(mxUtils.bind(this,function(e,n){for(var i=[6,8,9,10,11,12,14,18,24,36,48,72],l=mxUtils.bind(this,function(i){this.styleChange(e,i,[mxConstants.STYLE_FONTSIZE],[i],null,n,function(){document.execCommand("fontSize",!1,"3");for(var e=t.cellEditor.textarea.getElementsByTagName("font"),n=0;n<e.length;n++)if("3"==e[n].getAttribute("size")){e[n].removeAttribute("size"),e[n].style.fontSize=i+"px";break}})}),o=0;o<i.length;o++)l(i[o]);if(e.addSeparator(n),this.customFontSizes.length>0){for(var o=0;o<this.customFontSizes.length;o++)l(this.customFontSizes[o]);e.addSeparator(n),e.addItem(mxResources.get("reset"),null,mxUtils.bind(this,function(){this.customFontSizes=[]}),n),e.addSeparator(n)}this.promptChange(e,mxResources.get("custom")+"...","(pt)","12",mxConstants.STYLE_FONTSIZE,n,!0,mxUtils.bind(this,function(t){this.customFontSizes.push(t)}))}))),this.put("direction",new l(mxUtils.bind(this,function(e,n){e.addItem(mxResources.get("flipH"),null,function(){t.toggleCellStyles(mxConstants.STYLE_FLIPH,!1)},n),e.addItem(mxResources.get("flipV"),null,function(){t.toggleCellStyles(mxConstants.STYLE_FLIPV,!1)},n),this.addMenuItems(e,["-","rotation"],n)}))),this.put("align",new l(mxUtils.bind(this,function(e,n){e.addItem(mxResources.get("leftAlign"),null,function(){t.alignCells(mxConstants.ALIGN_LEFT)},n),e.addItem(mxResources.get("center"),null,function(){t.alignCells(mxConstants.ALIGN_CENTER)},n),e.addItem(mxResources.get("rightAlign"),null,function(){t.alignCells(mxConstants.ALIGN_RIGHT)},n),e.addSeparator(n),e.addItem(mxResources.get("topAlign"),null,function(){t.alignCells(mxConstants.ALIGN_TOP)},n),e.addItem(mxResources.get("middle"),null,function(){t.alignCells(mxConstants.ALIGN_MIDDLE)},n),e.addItem(mxResources.get("bottomAlign"),null,function(){t.alignCells(mxConstants.ALIGN_BOTTOM)},n)}))),this.put("distribute",new l(mxUtils.bind(this,function(e,n){e.addItem(mxResources.get("horizontal"),null,function(){t.distributeCells(!0)},n),e.addItem(mxResources.get("vertical"),null,function(){t.distributeCells(!1)},n)}))),this.put("layout",new l(mxUtils.bind(this,function(e,n){var i=mxUtils.bind(this,function(t,e){var n=new FilenameDialog(this.editorUi,t,mxResources.get("apply"),function(t){e(parseFloat(t))},mxResources.get("spacing"));this.editorUi.showDialog(n.container,300,80,!0,!0),n.init()});e.addItem(mxResources.get("horizontalFlow"),null,mxUtils.bind(this,function(){var e=new mxHierarchicalLayout(t,mxConstants.DIRECTION_WEST);this.editorUi.executeLayout(function(){var n=t.getSelectionCells();e.execute(t.getDefaultParent(),0==n.length?null:n)},!0)}),n),e.addItem(mxResources.get("verticalFlow"),null,mxUtils.bind(this,function(){var e=new mxHierarchicalLayout(t,mxConstants.DIRECTION_NORTH);this.editorUi.executeLayout(function(){var n=t.getSelectionCells();e.execute(t.getDefaultParent(),0==n.length?null:n)},!0)}),n),e.addSeparator(n),e.addItem(mxResources.get("horizontalTree"),null,mxUtils.bind(this,function(){var e=t.getSelectionCell(),n=null;if(null==e||0==t.getModel().getChildCount(e)?0==t.getModel().getEdgeCount(e)&&(n=t.findTreeRoots(t.getDefaultParent())):n=t.findTreeRoots(e),null!=n&&n.length>0&&(e=n[0]),null!=e){var l=new mxCompactTreeLayout(t,!0);l.edgeRouting=!1,l.levelDistance=30,i(l.levelDistance,mxUtils.bind(this,function(n){l.levelDistance=n,this.editorUi.executeLayout(function(){l.execute(t.getDefaultParent(),e)},!0)}))}}),n),e.addItem(mxResources.get("verticalTree"),null,mxUtils.bind(this,function(){var e=t.getSelectionCell(),n=null;if(null==e||0==t.getModel().getChildCount(e)?0==t.getModel().getEdgeCount(e)&&(n=t.findTreeRoots(t.getDefaultParent())):n=t.findTreeRoots(e),null!=n&&n.length>0&&(e=n[0]),null!=e){var l=new mxCompactTreeLayout(t,!1);l.edgeRouting=!1,l.levelDistance=30,i(l.levelDistance,mxUtils.bind(this,function(n){l.levelDistance=n,this.editorUi.executeLayout(function(){l.execute(t.getDefaultParent(),e)},!0)}))}}),n),e.addItem(mxResources.get("radialTree"),null,mxUtils.bind(this,function(){var e=t.getSelectionCell(),n=null;if(null==e||0==t.getModel().getChildCount(e)?0==t.getModel().getEdgeCount(e)&&(n=t.findTreeRoots(t.getDefaultParent())):n=t.findTreeRoots(e),null!=n&&n.length>0&&(e=n[0]),null!=e){var l=new mxRadialTreeLayout(t,!1);l.levelDistance=80,l.autoRadius=!0,i(l.levelDistance,mxUtils.bind(this,function(n){l.levelDistance=n,this.editorUi.executeLayout(function(){l.execute(t.getDefaultParent(),e),t.isSelectionEmpty()||(e=t.getModel().getParent(e),t.getModel().isVertex(e)&&t.updateGroupBounds([e],2*t.gridSize,!0))},!0)}))}}),n),e.addSeparator(n),e.addItem(mxResources.get("organic"),null,mxUtils.bind(this,function(){var e=new mxFastOrganicLayout(t);i(e.forceConstant,mxUtils.bind(this,function(n){e.forceConstant=n,this.editorUi.executeLayout(function(){var n=t.getSelectionCell();null!=n&&0!=t.getModel().getChildCount(n)||(n=t.getDefaultParent()),e.execute(n),t.getModel().isVertex(n)&&t.updateGroupBounds([n],2*t.gridSize,!0)},!0)}))}),n),e.addItem(mxResources.get("circle"),null,mxUtils.bind(this,function(){var e=new mxCircleLayout(t);this.editorUi.executeLayout(function(){var n=t.getSelectionCell();null!=n&&0!=t.getModel().getChildCount(n)||(n=t.getDefaultParent()),e.execute(n),t.getModel().isVertex(n)&&t.updateGroupBounds([n],2*t.gridSize,!0)},!0)}),n)}))),this.put("navigation",new l(mxUtils.bind(this,function(t,e){this.addMenuItems(t,["home","-","exitGroup","enterGroup","-","expand","collapse","-","collapsible"],e)}))),this.put("arrange",new l(mxUtils.bind(this,function(t,e){this.addMenuItems(t,["toFront","toBack","-"],e),this.addSubmenu("direction",t,e),this.addMenuItems(t,["turn","-"],e),this.addSubmenu("align",t,e),this.addSubmenu("distribute",t,e),t.addSeparator(e),this.addSubmenu("navigation",t,e),this.addSubmenu("insert",t,e),this.addSubmenu("layout",t,e),this.addMenuItems(t,["-","group","ungroup","removeFromGroup","-","clearWaypoints","autosize"],e)}))).isEnabled=e,this.put("insert",new l(mxUtils.bind(this,function(t,e){this.addMenuItems(t,["insertLink","insertImage"],e)}))),this.put("view",new l(mxUtils.bind(this,function(t,e){this.addMenuItems(t,(null!=this.editorUi.format?["formatPanel"]:[]).concat(["outline","layers","-","pageView","pageScale","-","scrollbars","tooltips","-","grid","guides","-","connectionArrows","connectionPoints","-","resetView","zoomIn","zoomOut"],e))}))),this.put("viewPanels",new l(mxUtils.bind(this,function(t,e){null!=this.editorUi.format&&this.addMenuItems(t,["formatPanel"],e),this.addMenuItems(t,["outline","layers"],e)}))),this.put("viewZoom",new l(mxUtils.bind(this,function(e,n){this.addMenuItems(e,["resetView","-"],n);for(var i=[.25,.5,.75,1,1.25,1.5,2,3,4],l=0;l<i.length;l++)!function(i){e.addItem(100*i+"%",null,function(){t.zoomTo(i)},n)}(i[l]);this.addMenuItems(e,["-","fitWindow","fitPageWidth","fitPage","fitTwoPages","-","customZoom"],n)}))),this.put("file",new l(mxUtils.bind(this,function(t,e){this.addMenuItems(t,["new","open","-","save","saveAs","-","import","export","-","generateCode","-","pageSetup","print"],e)}))),this.put("edit",new l(mxUtils.bind(this,function(t,e){this.addMenuItems(t,["undo","redo","-","cut","copy","paste","delete","-","duplicate","-","editData","editTooltip","editStyle","-","edit","-","editLink","openLink","-","selectVertices","selectEdges","selectAll","selectNone","-","lockUnlock"])}))),this.put("extras",new l(mxUtils.bind(this,function(t,e){this.addMenuItems(t,["copyConnect","collapseExpand","-","editDiagram"])}))),this.put("help",new l(mxUtils.bind(this,function(t,e){this.addMenuItems(t,["help","-","about"])})))},o.prototype.put=function(t,e){return this.menus[t]=e,e},o.prototype.get=function(t){return this.menus[t]},o.prototype.addSubmenu=function(t,e,n){var i=this.get(t).isEnabled();if(e.showDisabled||i){var l=e.addItem(mxResources.get(t),null,null,n,null,i);this.addMenu(t,e,l)}},o.prototype.addMenu=function(t,e,n){var i=this.get(t);null!=i&&(e.showDisabled||i.isEnabled())&&this.get(t).execute(e,n)},o.prototype.addInsertTableItem=function(t){function e(t,e){for(var n=["<table>"],i=0;i<t;i++){n.push("<tr>");for(var l=0;l<e;l++)n.push("<td><br></td>");n.push("</tr>")}return n.push("</table>"),n.join("")}function n(t,e,n){for(var i=t.rows.length;i<e;i++)for(var l=t.insertRow(i),o=0;o<t.rows[0].cells.length;o++){var r=l.insertCell(-1);mxClient.IS_QUIRKS&&(r.innerHTML=s)}for(var i=0;i<t.rows.length;i++)for(var l=t.rows[i],o=l.cells.length;o<n;o++){var r=l.insertCell(-1);mxClient.IS_QUIRKS&&(r.innerHTML=s)}}var i=this.editorUi.editor.graph,l=t.addItem("",null,mxUtils.bind(this,function(t){var n=i.getParentByName(mxEvent.getSource(t),"TD");if(null!=n){for(var l=i.getParentByName(n,"TR"),o=i.cellEditor.textarea.getElementsByTagName("table"),s=[],r=0;r<o.length;r++)s.push(o[r]);i.container.focus(),i.pasteHtmlAtCaret(e(l.sectionRowIndex+1,n.cellIndex+1));var a=i.cellEditor.textarea.getElementsByTagName("table");if(a.length==s.length+1)for(var r=a.length-1;r>=0;r--)if(0==r||a[r]!=s[r-1]){i.selectNode(a[r].rows[0].cells[0]);break}}})),s='<img src="'+mxClient.imageBasePath+'/transparent.gif" width="16" height="16"/>';l.firstChild.innerHTML="";var r=function(t,e){var n=document.createElement("table");n.setAttribute("border","1"),n.style.borderCollapse="collapse",mxClient.IS_QUIRKS||n.setAttribute("cellPadding","8");for(var i=0;i<t;i++)for(var l=n.insertRow(i),o=0;o<e;o++){var r=l.insertCell(-1);mxClient.IS_QUIRKS&&(r.innerHTML=s)}return n}(5,5);l.firstChild.appendChild(r);var a=document.createElement("div");a.style.padding="4px",a.style.fontSize=o.prototype.defaultFontSize+"px",a.innerHTML="1x1",l.firstChild.appendChild(a),mxEvent.addListener(r,"mouseover",function(t){var e=i.getParentByName(mxEvent.getSource(t),"TD");if(null!=e){var l=i.getParentByName(e,"TR");n(r,Math.min(20,l.sectionRowIndex+2),Math.min(20,e.cellIndex+2)),a.innerHTML=e.cellIndex+1+"x"+(l.sectionRowIndex+1);for(var o=0;o<r.rows.length;o++)for(var s=r.rows[o],d=0;d<s.cells.length;d++){var u=s.cells[d];o<=l.sectionRowIndex&&d<=e.cellIndex?u.style.backgroundColor="blue":u.style.backgroundColor="white"}mxEvent.consume(t)}})},o.prototype.edgeStyleChange=function(t,e,n,i,l,o,s){return t.addItem(e,null,mxUtils.bind(this,function(){var t=this.editorUi.editor.graph;t.stopEditing(!1),t.getModel().beginUpdate();try{for(var e=t.getSelectionCells(),l=[],o=0;o<e.length;o++){var r=e[o];if(t.getModel().isEdge(r)){if(s){var a=t.getCellGeometry(r);null!=a&&(a=a.clone(),a.points=null,t.getModel().setGeometry(r,a))}for(var d=0;d<n.length;d++)t.setCellStyles(n[d],i[d],[r]);l.push(r)}}this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",n,"values",i,"cells",l))}finally{t.getModel().endUpdate()}}),o,l)},o.prototype.styleChange=function(t,e,n,i,l,o,s){var r=this.createStyleChangeFunction(n,i);return t.addItem(e,null,mxUtils.bind(this,function(){var t=this.editorUi.editor.graph;null!=s&&t.cellEditor.isContentEditing()?s():r()}),o,l)},o.prototype.createStyleChangeFunction=function(t,e){return mxUtils.bind(this,function(){var n=this.editorUi.editor.graph;n.stopEditing(!1),n.getModel().beginUpdate();try{for(var i=0;i<t.length;i++)n.setCellStyles(t[i],e[i]);this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",t,"values",e,"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}})},o.prototype.promptChange=function(t,e,n,i,l,o,s,r,a){return t.addItem(e,null,mxUtils.bind(this,function(){var t=this.editorUi.editor.graph,e=i,o=t.getView().getState(t.getSelectionCell());null!=o&&(e=o.style[l]||e);var s=new FilenameDialog(this.editorUi,e,mxResources.get("apply"),mxUtils.bind(this,function(e){if(null!=e&&e.length>0){t.getModel().beginUpdate();try{t.stopEditing(!1),t.setCellStyles(l,e)}finally{t.getModel().endUpdate()}null!=r&&r(e)}}),mxResources.get("enterValue")+(n.length>0?" "+n:""));this.editorUi.showDialog(s.container,300,80,!0,!0),s.init()}),o,a,s)},o.prototype.pickColor=function(t,e,n){var i=this.editorUi.editor.graph;if(null!=e&&i.cellEditor.isContentEditing()){var l=i.cellEditor.saveSelection(),o=new ColorDialog(this.editorUi,n||"000000",mxUtils.bind(this,function(t){i.cellEditor.restoreSelection(l),document.execCommand(e,!1,t!=mxConstants.NONE?t:"transparent")}),function(){i.cellEditor.restoreSelection(l)});this.editorUi.showDialog(o.container,220,430,!0,!0),o.init()}else{null==this.colorDialog&&(this.colorDialog=new ColorDialog(this.editorUi)),this.colorDialog.currentColorKey=t;var s=i.getView().getState(i.getSelectionCell()),r="none";null!=s&&(r=s.style[t]||r),"none"==r?(r="ffffff",this.colorDialog.picker.fromString("ffffff"),this.colorDialog.colorInput.value="none"):this.colorDialog.picker.fromString(r),this.editorUi.showDialog(this.colorDialog.container,220,430,!0,!0),this.colorDialog.init()}},o.prototype.toggleStyle=function(t,e){var n=this.editorUi.editor.graph,i=n.toggleCellStyles(t,e);this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",[t],"values",[i],"cells",n.getSelectionCells()))},o.prototype.addMenuItem=function(t,e,n,i,l){var o=this.editorUi.actions.get(e);if(null!=o&&(t.showDisabled||o.isEnabled())&&o.visible){var s=t.addItem(o.label,null,function(){o.funct(i)},n,l,o.isEnabled());return o.toggleAction&&o.isSelected()&&t.addCheckmark(s,Editor.checkmarkImage),this.addShortcut(s,o),s}return null},o.prototype.addShortcut=function(t,e){if(null!=e.shortcut){var n=t.firstChild.nextSibling.nextSibling,i=document.createElement("span");i.style.color="gray",mxUtils.write(i,e.shortcut),n.appendChild(i)}},o.prototype.addMenuItems=function(t,e,n,i,l){for(var o=0;o<e.length;o++)"-"==e[o]?t.addSeparator(n):this.addMenuItem(t,e[o],n,i,null!=l?l[o]:null)},o.prototype.createPopupMenu=function(t,e,n){var i=this.editorUi.editor.graph;if(t.smartSeparators=!0,i.isSelectionEmpty()?this.addMenuItems(t,["undo","redo","-","pasteHere"],null,n):this.addMenuItems(t,["delete","-","cut","copy","-","duplicate"],null,n),i.getSelectionCount()>0){1==i.getSelectionCount()&&this.addMenuItems(t,["setAsDefaultStyle"],null,n),t.addSeparator(),e=i.getSelectionCell();var l=i.view.getState(e);if(null!=l){if(1==i.getSelectionCount()&&this.addMenuItems(t,["toFront","toBack","-"],null,n),i.getModel().isEdge(e)&&"entityRelationEdgeStyle"!=mxUtils.getValue(l.style,mxConstants.STYLE_EDGE,null)&&"arrow"!=mxUtils.getValue(l.style,mxConstants.STYLE_SHAPE,null)){var o=i.selectionCellsHandler.getHandler(e),s=!1;if(o instanceof mxEdgeHandler&&null!=o.bends&&o.bends.length>2){var r=o.getHandleForEvent(i.updateMouseEvent(new mxMouseEvent(n))),a=this.editorUi.actions.get("removeWaypoint");a.handler=o,a.index=r,s=r>0&&r<o.bends.length-1}this.addMenuItems(t,["-",s?"removeWaypoint":"addWaypoint"],null,n);var d=i.getModel().getGeometry(e);null!=d&&null!=d.points&&d.points.length>0&&this.addMenuItems(t,["clearWaypoints"],null,n)}i.getSelectionCount()>1?(t.addSeparator(),this.addMenuItems(t,["group"],null,n)):1==i.getSelectionCount()&&!i.getModel().isEdge(e)&&!i.isSwimlane(e)&&i.getModel().getChildCount(e)>0&&(t.addSeparator(),this.addMenuItems(t,["ungroup"],null,n)),1==i.getSelectionCount()&&(t.addSeparator(),this.addMenuItems(t,["edit","-","editData","editLink"],null,n),i.getModel().isVertex(e)&&null!=mxUtils.getValue(l.style,mxConstants.STYLE_IMAGE,null)&&(t.addSeparator(),this.addMenuItem(t,"image",null,n).firstChild.nextSibling.innerHTML=mxResources.get("editImage")+"..."))}}else this.addMenuItems(t,["-","selectVertices","selectEdges","-","selectAll"],null,n)},o.prototype.createMenubar=function(t){for(var e=new i(this.editorUi,t),n=this.defaultMenuItems,l=0;l<n.length;l++)mxUtils.bind(this,function(t){var i=e.addMenu(mxResources.get(n[l]),mxUtils.bind(this,function(){t.funct.apply(this,arguments)}));null!=i&&t.addListener("stateChanged",function(){i.enabled=t.enabled,t.enabled?(i.className="geItem",8==document.documentMode&&(i.style.color="")):(i.className="geItem mxDisabled",8==document.documentMode&&(i.style.color="#c3c3c3"))})})(this.get(n[l]));return e},i.prototype.hideMenu=function(){this.editorUi.hideCurrentMenu()},i.prototype.addMenu=function(t,e){var n=document.createElement("a");return n.setAttribute("href","javascript:void(0);"),n.className="geItem",mxUtils.write(n,t),this.addMenuHandler(n,e),this.container.appendChild(n),n},i.prototype.addMenuHandler=function(t,e){if(null!=e){var n=!0,i=mxUtils.bind(this,function(i){if(n&&null==t.enabled||t.enabled){this.editorUi.editor.graph.popupMenuHandler.hideMenu();var l=new mxPopupMenu(e);l.div.className+=" geMenubarMenu",l.smartSeparators=!0,l.showDisabled=!0,l.autoExpand=!0,l.hideMenu=mxUtils.bind(this,function(){mxPopupMenu.prototype.hideMenu.apply(l,arguments),this.editorUi.resetCurrentMenu(),l.destroy()});var o=mxUtils.getOffset(t);l.popup(o.x,o.y+t.offsetHeight,null,i),this.editorUi.setCurrentMenu(l,t)}mxEvent.consume(i)});mxEvent.addListener(t,"mousemove",mxUtils.bind(this,function(e){null!=this.editorUi.currentMenu&&this.editorUi.currentMenuElt!=t&&(this.editorUi.hideCurrentMenu(),i(e))})),mxEvent.addListener(t,"mousedown",mxUtils.bind(this,function(){n=this.currentElt!=t})),mxEvent.addListener(t,"click",mxUtils.bind(this,function(t){i(t),n=!0}))}},i.prototype.destroy=function(){},mxUtils.extend(l,mxEventSource),l.prototype.isEnabled=function(){return this.enabled},l.prototype.setEnabled=function(t){this.enabled!=t&&(this.enabled=t,this.fireEvent(new mxEventObject("stateChanged")))},l.prototype.execute=function(t,e){this.funct(t,e)},t.exports=o},function(t,e,n){"use strict";var i=n(1),l=i.prototype.init;i.prototype.init=function(){l.apply(this,arguments),this.actions.get("export").setEnabled(!0),Editor.useLocalStorage=!0,Editor.useFileSystemSave=!0,Editor.useLocalStorage||mxUtils.post(OPEN_URL,"",mxUtils.bind(this,function(t){var e=404!=t.getStatus();this.actions.get("open").setEnabled(e||Graph.fileSupport),this.actions.get("import").setEnabled(e||Graph.fileSupport),this.actions.get("save").setEnabled(e),this.actions.get("saveAs").setEnabled(e),this.actions.get("export").setEnabled(e)}))},mxResources.loadDefaultBundle=!1;var o=mxResources.getDefaultBundle(RESOURCE_BASE,mxLanguage)||mxResources.getSpecialBundle(RESOURCE_BASE,mxLanguage);mxUtils.getAll([o,STYLE_PATH+"/default.xml"],function(t){mxResources.parse(t[0].getText());var e=new Object;e[Graph.prototype.defaultThemeName]=t[1].getDocumentElement(),new i(new Editor("0"==urlParams.chrome,e))},function(){document.body.innerHTML='<center style="margin-top:10%;">Error loading resource files. Please check browser console.</center>'})},function(t,e,n){"use strict";function i(t,e){this.editorUi=t,this.container=e,this.palettes=new Object,this.taglist=new Object,this.showTooltips=!0,this.graph=t.createTemporaryGraph(this.editorUi.editor.graph.getStylesheet()),this.graph.cellRenderer.antiAlias=!1,this.graph.foldingEnabled=!1,mxClient.IS_IE||mxClient.IS_IE11||(this.graph.container.style.display="none"),document.body.appendChild(this.graph.container),this.pointerUpHandler=mxUtils.bind(this,function(){this.showTooltips=!0}),mxEvent.addListener(document,mxClient.IS_POINTER?"pointerup":"mouseup",this.pointerUpHandler),this.pointerDownHandler=mxUtils.bind(this,function(){this.showTooltips=!1,this.hideTooltip()}),mxEvent.addListener(document,mxClient.IS_POINTER?"pointerdown":"mousedown",this.pointerDownHandler),this.pointerMoveHandler=mxUtils.bind(this,function(t){for(var e=mxEvent.getSource(t);null!=e;){if(e==this.currentElt)return;e=e.parentNode}this.hideTooltip()}),mxEvent.addListener(document,mxClient.IS_POINTER?"pointermove":"mousemove",this.pointerMoveHandler),this.pointerOutHandler=mxUtils.bind(this,function(t){null==t.toElement&&null==t.relatedTarget&&this.hideTooltip()}),mxEvent.addListener(document,mxClient.IS_POINTER?"pointerout":"mouseout",this.pointerOutHandler),mxEvent.addListener(e,"scroll",mxUtils.bind(this,function(){this.showTooltips=!0})),this.init(),mxClient.IS_SVG||((new Image).src=IMAGE_PATH+"/tooltip.png")}var l=n(5);i.prototype.init=function(){STENCIL_PATH;l(this,!0)},i.prototype.collapsedImage=mxClient.IS_SVG?"data:image/gif;base64,R0lGODlhDQANAIABAJmZmf///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNUQyRTJFNjZGNUYxMUU1QjZEOThCNDYxMDQ2MzNCQiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozNUQyRTJFNzZGNUYxMUU1QjZEOThCNDYxMDQ2MzNCQiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjFERjc3MEUxNkY1RjExRTVCNkQ5OEI0NjEwNDYzM0JCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFERjc3MEUyNkY1RjExRTVCNkQ5OEI0NjEwNDYzM0JCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAQAsAAAAAA0ADQAAAhSMj6lrwAjcC1GyahV+dcZJgeIIFgA7":IMAGE_PATH+"/collapsed.gif",i.prototype.expandedImage=mxClient.IS_SVG?"data:image/gif;base64,R0lGODlhDQANAIABAJmZmf///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxREY3NzBERjZGNUYxMUU1QjZEOThCNDYxMDQ2MzNCQiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxREY3NzBFMDZGNUYxMUU1QjZEOThCNDYxMDQ2MzNCQiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjFERjc3MERENkY1RjExRTVCNkQ5OEI0NjEwNDYzM0JCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFERjc3MERFNkY1RjExRTVCNkQ5OEI0NjEwNDYzM0JCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAQAsAAAAAA0ADQAAAhGMj6nL3QAjVHIu6azbvPtWAAA7":IMAGE_PATH+"/expanded.gif",i.prototype.tooltipImage=mxClient.IS_SVG?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAbCAMAAAB7jU7LAAAACVBMVEX///+ZmZn///9Y2COLAAAAA3RSTlP//wDXyg1BAAAAOElEQVR42mXQMQ4AMAgDsWv//+iutcJmIQSk+9dJpVKpVCqVSqVSqZTdncWzF8/NeP7FkxWenPEDOnUBiL3jWx0AAAAASUVORK5CYII=":IMAGE_PATH+"/tooltip.png",i.prototype.searchImage=mxClient.IS_SVG?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAEaSURBVHjabNGxS5VxFIfxz71XaWuQUJCG/gCHhgTD9VpEETg4aMOlQRp0EoezObgcd220KQiXmpretTAHQRBdojlQEJyukPdt+b1ywfvAGc7wnHP4nlZd1yKijQW8xzNc4Su+ZOYfQ3T6/f4YNvEJYzjELXp4VVXVz263+7cR2niBxAFeZ2YPi3iHR/gYERPDwhpOsd6sz8x/mfkNG3iOlWFhFj8y89J9KvzGXER0GuEaD42mgwHqUtoljbcRsTBCeINpfM/MgZLKPpaxFxGbOCqDXmILN7hoJrTKH+axhxmcYRxP0MIDnOBDZv5q1XUNIuJxifJp+UNV7t7BFM6xeic0RMQ4Bpl5W/ol7GISx/eEUUTECrbx+f8A8xhiZht9zsgAAAAASUVORK5CYII=":IMAGE_PATH+"/search.png",i.prototype.enableTooltips=!0,i.prototype.tooltipBorder=16,i.prototype.tooltipDelay=300,i.prototype.dropTargetDelay=200,i.prototype.gearImage=STENCIL_PATH+"/clipart/Gear_128x128.png",i.prototype.thumbWidth=36,i.prototype.thumbHeight=36,i.prototype.thumbPadding=document.documentMode>=5?0:1,i.prototype.thumbBorder=2,i.prototype.sidebarTitleSize=9,i.prototype.sidebarTitles=!1,i.prototype.tooltipTitles=!0,i.prototype.maxTooltipWidth=400,i.prototype.maxTooltipHeight=400,i.prototype.addStencilsToIndex=!0,i.prototype.defaultImageWidth=80,i.prototype.defaultImageHeight=80,i.prototype.showTooltip=function(t,e,n,i,l,o){if(this.enableTooltips&&this.showTooltips&&this.currentElt!=t){null!=this.thread&&(window.clearTimeout(this.thread),this.thread=null);var s=mxUtils.bind(this,function(){null==this.tooltip&&(this.tooltip=document.createElement("div"),this.tooltip.className="geSidebarTooltip",this.tooltip.style.zIndex=mxPopupMenu.prototype.zIndex-1,document.body.appendChild(this.tooltip),this.graph2=new Graph(this.tooltip,null,null,this.editorUi.editor.graph.getStylesheet()),this.graph2.resetViewOnRootChange=!1,this.graph2.foldingEnabled=!1,this.graph2.gridEnabled=!1,this.graph2.autoScroll=!1,this.graph2.setTooltips(!1),this.graph2.setConnectable(!1),this.graph2.setEnabled(!1),mxClient.IS_SVG||(this.graph2.view.canvas.style.position="relative"),this.tooltipImage=mxUtils.createImage(this.tooltipImage),this.tooltipImage.className="geSidebarTooltipImage",this.tooltipImage.style.zIndex=mxPopupMenu.prototype.zIndex-1,this.tooltipImage.style.position="absolute",this.tooltipImage.style.width="14px",this.tooltipImage.style.height="27px",document.body.appendChild(this.tooltipImage)),this.graph2.model.clear(),this.graph2.view.setTranslate(this.tooltipBorder,this.tooltipBorder),n>this.maxTooltipWidth||i>this.maxTooltipHeight?this.graph2.view.scale=Math.round(100*Math.min(this.maxTooltipWidth/n,this.maxTooltipHeight/i))/100:this.graph2.view.scale=1,this.tooltip.style.display="block",this.graph2.labelsVisible=null==o||o,this.graph2.addCells(e);var s=this.graph2.getGraphBounds(),r=s.width+2*this.tooltipBorder+4,a=s.height+2*this.tooltipBorder;if(mxClient.IS_QUIRKS?(a+=4,this.tooltip.style.overflow="hidden"):this.tooltip.style.overflow="visible",this.tooltipImage.style.visibility="visible",this.tooltip.style.width=r+"px",this.tooltipTitles&&null!=l&&l.length>0){null==this.tooltipTitle?(this.tooltipTitle=document.createElement("div"),this.tooltipTitle.style.borderTop="1px solid gray",this.tooltipTitle.style.textAlign="center",this.tooltipTitle.style.width="100%",this.tooltipTitle.style.overflow="hidden",mxClient.IS_SVG?this.tooltipTitle.style.paddingTop="6px":(this.tooltipTitle.style.position="absolute",this.tooltipTitle.style.paddingTop="6px"),this.tooltip.appendChild(this.tooltipTitle)):this.tooltipTitle.innerHTML="",this.tooltipTitle.style.display="",mxUtils.write(this.tooltipTitle,l);var d=this.tooltipTitle.offsetHeight+10;a+=d,mxClient.IS_SVG?this.tooltipTitle.style.marginTop=2-d+"px":(a-=6,this.tooltipTitle.style.top=a-d+"px")}else null!=this.tooltipTitle&&null!=this.tooltipTitle.parentNode&&(this.tooltipTitle.style.display="none");this.tooltip.style.height=a+"px";var u=-Math.round(s.x-this.tooltipBorder),c=-Math.round(s.y-this.tooltipBorder),h=document.body,p=document.documentElement,m=Math.max(h.clientHeight||0,p.clientHeight),g=this.container.clientWidth+this.editorUi.splitSize+3+this.editorUi.container.offsetLeft,x=Math.min(m-a-20,Math.max(0,this.editorUi.container.offsetTop+this.container.offsetTop+t.offsetTop-this.container.scrollTop-a/2+16));mxClient.IS_SVG?0!=u||0!=c?this.graph2.view.canvas.setAttribute("transform","translate("+u+","+c+")"):this.graph2.view.canvas.removeAttribute("transform"):(this.graph2.view.drawPane.style.left=u+"px",this.graph2.view.drawPane.style.top=c+"px"),this.tooltip.style.position="absolute",this.tooltip.style.left=g+"px",this.tooltip.style.top=x+"px",this.tooltipImage.style.left=g-13+"px",this.tooltipImage.style.top=x+a/2-13+"px"});null!=this.tooltip&&"none"!=this.tooltip.style.display?s():this.thread=window.setTimeout(s,this.tooltipDelay),this.currentElt=t}},i.prototype.hideTooltip=function(){null!=this.thread&&(window.clearTimeout(this.thread),this.thread=null),null!=this.tooltip&&(this.tooltip.style.display="none",this.tooltipImage.style.visibility="hidden",this.currentElt=null)},i.prototype.addEntry=function(t,e){if(null!=this.taglist&&null!=t&&t.length>0)for(var n=t.toLowerCase().replace(/[\/\,\(\)]/g," ").split(" "),i=mxUtils.bind(this,function(t){if(t.length>1){var n=this.taglist[t];null==n&&(n={entries:[],dict:new mxDictionary},this.taglist[t]=n),null==n.dict.get(e)&&(n.dict.put(e,e),n.entries.push(e))}}),l=0;l<n.length;l++){i(n[l]);var o=n[l].replace(/\.*\d*$/,"");o!=n[l]&&i(o)}return e},i.prototype.searchEntries=function(t,e,n,i,l){if(null!=this.taglist&&null!=t){for(var o=t.toLowerCase().split(" "),s=new mxDictionary,r=(n+1)*e,a=[],d=0,u=0;u<o.length;u++)if(o[u].length>0){var c=this.taglist[o[u]],h=new mxDictionary;if(null!=c){var p=c.entries;a=[];for(var m=0;m<p.length;m++){var c=p[m];if(0==d==(null==s.get(c))&&(h.put(c,c),a.push(c),u==o.length-1&&a.length==r))return void i(a.slice(n*e,r),r,!0,o)}}else a=[];s=h,d++}var g=a.length;i(a.slice(n*e,(n+1)*e),g,!1,o)}else i([],null,null,o)},i.prototype.filterTags=function(t){if(null!=t){for(var e=t.split(" "),n=[],i={},l=0;l<e.length;l++)null==i[e[l]]&&(i[e[l]]="1",n.push(e[l]));return n.join(" ")}return null},i.prototype.cloneCell=function(t,e){var n=t.clone();return null!=e&&(n.value=e),n},i.prototype.addSearchPalette=function(t){var e=document.createElement("div");e.style.visibility="hidden",this.container.appendChild(e);var n=document.createElement("div");n.className="geSidebar",n.style.boxSizing="border-box",n.style.overflow="hidden",n.style.width="100%",n.style.padding="8px",n.style.paddingTop="14px",n.style.paddingBottom="0px",t||(n.style.display="none");var l=document.createElement("div");l.style.whiteSpace="nowrap",l.style.textOverflow="clip",l.style.paddingBottom="8px",l.style.cursor="default";var o=document.createElement("input");o.setAttribute("placeholder",mxResources.get("searchShapes")),o.setAttribute("type","text"),o.style.fontSize="12px",o.style.overflow="hidden",o.style.boxSizing="border-box",o.style.border="solid 1px #d5d5d5",o.style.borderRadius="4px",o.style.width="100%",o.style.outline="none",o.style.padding="6px",l.appendChild(o);var s=document.createElement("img");s.setAttribute("src",i.prototype.searchImage),s.setAttribute("title",mxResources.get("search")),s.style.position="relative",s.style.left="-18px",mxClient.IS_QUIRKS?(o.style.height="28px",s.style.top="-4px"):s.style.top="1px",s.style.background="url('"+this.editorUi.editor.transparentImage+"')";var r;l.appendChild(s),n.appendChild(l);var a=document.createElement("center"),d=mxUtils.button(mxResources.get("moreResults"),function(){r()});d.style.display="none",d.style.lineHeight="normal",d.style.marginTop="4px",d.style.marginBottom="8px",a.style.paddingTop="4px",a.style.paddingBottom="8px",a.appendChild(d),n.appendChild(a);var u="",c=!1,h=!1,p=0,m=new Object,g=12,x=mxUtils.bind(this,function(){c=!1,this.currentSearch=null;for(var t=n.firstChild;null!=t;){var e=t.nextSibling;t!=l&&t!=a&&t.parentNode.removeChild(t),t=e}});mxEvent.addListener(s,"click",function(){s.getAttribute("src")==Dialog.prototype.closeImage&&(s.setAttribute("src",i.prototype.searchImage),s.setAttribute("title",mxResources.get("search")),d.style.display="none",o.value="",u="",x()),o.focus()}),r=mxUtils.bind(this,function(){if(g=4*Math.max(1,Math.floor(this.container.clientWidth/(this.thumbWidth+10))),this.hideTooltip(),""!=o.value){if(null!=a.parentNode&&(u!=o.value&&(x(),u=o.value,m=new Object,h=!1,p=0),!c&&!h)){d.setAttribute("disabled","true"),d.style.display="",d.style.cursor="wait",d.innerHTML=mxResources.get("loading")+"...",c=!0;var t=new Object;this.currentSearch=t,this.searchEntries(u,g,p,mxUtils.bind(this,function(e,i,l,o){if(this.currentSearch==t){e=null!=e?e:[],c=!1,p++,a.parentNode.removeChild(a),this.insertSearchHint(n,u,g,p,e,i,l,o);for(var s=0;s<e.length;s++){var r=e[s]();null==m[r.innerHTML]&&(m[r.innerHTML]="1",n.appendChild(e[s]()))}l?(d.removeAttribute("disabled"),d.innerHTML=mxResources.get("moreResults")):(d.innerHTML=mxResources.get("reset"),d.style.display="none",h=!0),d.style.cursor="",n.appendChild(a)}}),mxUtils.bind(this,function(){d.style.cursor=""}))}}else x(),o.value="",u="",m=new Object,d.style.display="none",h=!1,o.focus()}),mxEvent.addListener(o,"keydown",mxUtils.bind(this,function(t){13==t.keyCode&&r()})),mxEvent.addListener(o,"focus",function(){o.style.paddingRight=""}),mxEvent.addListener(o,"blur",function(){o.style.paddingRight="20px"}),o.style.paddingRight="20px",mxEvent.addListener(o,"keyup",mxUtils.bind(this,function(t){""==o.value?(s.setAttribute("src",i.prototype.searchImage),s.setAttribute("title",mxResources.get("search"))):(s.setAttribute("src",Dialog.prototype.closeImage),s.setAttribute("title",mxResources.get("reset"))),""==o.value?(h=!0,d.style.display="none"):o.value!=u?(d.style.display="none",h=!1):c||(d.style.display=h?"none":"")})),mxEvent.addListener(o,"mousedown",function(t){t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0}),mxEvent.addListener(o,"selectstart",function(t){t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0});var y=document.createElement("div");y.appendChild(n),this.container.appendChild(y),this.palettes.search=[e,y]},i.prototype.insertSearchHint=function(t,e,n,i,l,o,s,r){if(0==l.length&&1==i){var a=document.createElement("div");a.className="geTitle",a.style.cssText="background-color:transparent;border-color:transparent;color:gray;padding:6px 0px 0px 0px !important;margin:4px 8px 4px 8px;text-align:center;cursor:default !important",mxUtils.write(a,mxResources.get("noResultsFor",[e])),t.appendChild(a)}},i.prototype.createTitle=function(t){var e=document.createElement("a");return e.setAttribute("href","javascript:void(0);"),e.setAttribute("title",mxResources.get("sidebarTooltip")),e.className="geTitle",mxUtils.write(e,t),e},i.prototype.createThumb=function(t,e,n,i,l,o,s,r,a){this.graph.labelsVisible=null==o||o;var d=mxClient.NO_FO;mxClient.NO_FO=Editor.prototype.originalNoForeignObject,this.graph.view.scaleAndTranslate(1,0,0),this.graph.addCells(t);var u=this.graph.getGraphBounds(),c=Math.floor(100*Math.min((e-2*this.thumbBorder)/u.width,(n-2*this.thumbBorder)/u.height))/100;this.graph.view.scaleAndTranslate(c,Math.floor((e-u.width*c)/2/c-u.x),Math.floor((n-u.height*c)/2/c-u.y));var h=null;if(this.graph.dialect!=mxConstants.DIALECT_SVG||mxClient.NO_FO?(h=this.graph.container.cloneNode(!1),h.innerHTML=this.graph.container.innerHTML):h=this.graph.view.getCanvas().ownerSVGElement.cloneNode(!0),this.graph.getModel().clear(),mxClient.NO_FO=d,mxClient.IS_IE6&&(i.style.backgroundImage="url("+this.editorUi.editor.transparentImage+")"),h.style.position="relative",h.style.overflow="hidden",h.style.cursor="move",h.style.left=this.thumbBorder+"px",h.style.top=this.thumbBorder+"px",h.style.width=e+"px",h.style.height=n+"px",h.style.visibility="",h.style.minWidth="",h.style.minHeight="",i.appendChild(h),this.sidebarTitles&&null!=l&&0!=s){var p=mxClient.IS_QUIRKS?2*this.thumbPadding+2:0;i.style.height=this.thumbHeight+p+this.sidebarTitleSize+8+"px";var m=document.createElement("div");m.style.fontSize=this.sidebarTitleSize+"px",m.style.color="#303030",m.style.textAlign="center",m.style.whiteSpace="nowrap",mxClient.IS_IE&&(m.style.height=this.sidebarTitleSize+12+"px"),m.style.paddingTop="4px",mxUtils.write(m,l),i.appendChild(m)}return u},i.prototype.createItem=function(t,e,n,i,l,o,s){var r=document.createElement("a");r.setAttribute("href","javascript:void(0);"),r.className="geItem",r.style.overflow="hidden";var a=mxClient.IS_QUIRKS?8+2*this.thumbPadding:2*this.thumbBorder;r.style.width=this.thumbWidth+a+"px",r.style.height=this.thumbHeight+a+"px",r.style.padding=this.thumbPadding+"px",mxClient.IS_IE6&&(r.style.border="none"),mxEvent.addListener(r,"click",function(t){mxEvent.consume(t)}),this.createThumb(t,this.thumbWidth,this.thumbHeight,r,e,n,i,l,o);var d=new mxRectangle(0,0,l,o);if(t.length>1||t[0].vertex){var u=this.createDragSource(r,this.createDropHandler(t,!0,s,d),this.createDragPreview(l,o),t,d);this.addClickHandler(r,u,t),u.isGuidesEnabled=mxUtils.bind(this,function(){return this.editorUi.editor.graph.graphHandler.guidesEnabled})}else if(null!=t[0]&&t[0].edge){var u=this.createDragSource(r,this.createDropHandler(t,!1,s,d),this.createDragPreview(l,o),t,d);this.addClickHandler(r,u,t)}return mxClient.IS_IOS||mxEvent.addGestureListeners(r,null,mxUtils.bind(this,function(i){mxEvent.isMouseEvent(i)&&this.showTooltip(r,t,d.width,d.height,e,n)})),r},i.prototype.updateShapes=function(t,e){var n=this.editorUi.editor.graph,i=n.getCellStyle(t),l=[];n.model.beginUpdate();try{for(var o=n.getModel().getStyle(t),s=["shadow","dashed","dashPattern","fontFamily","fontSize","fontColor","align","startFill","startSize","endFill","endSize","strokeColor","strokeWidth","fillColor","gradientColor","html","part","noEdgeStyle","edgeStyle","elbow","childLayout"],r=0;r<e.length;r++){var a=e[r];if(n.getModel().isVertex(a)==n.getModel().isVertex(t)||n.getModel().isEdge(a)==n.getModel().isEdge(t)){var d=n.view.getState(a),u=null!=d?d.style:n.getCellStyle(e[r]);if(n.getModel().setStyle(a,o),null!=d&&"1"==mxUtils.getValue(d.style,"composite","0"))for(var c=n.model.getChildCount(a),h=c;h>=0;h--)n.model.remove(n.model.getChildAt(a,h));if(null!=u){"umlLifeline"==u[mxConstants.STYLE_SHAPE]&&"umlLifeline"!=i[mxConstants.STYLE_SHAPE]&&(n.setCellStyles(mxConstants.STYLE_SHAPE,"umlLifeline",[a]),n.setCellStyles("participant",i[mxConstants.STYLE_SHAPE],[a]));for(var h=0;h<s.length;h++){var p=u[s[h]];null!=p&&n.setCellStyles(s[h],p,[a])}}l.push(a)}}}finally{n.model.endUpdate()}return l},i.prototype.createDropHandler=function(t,e,n,i){return n=null==n||n,mxUtils.bind(this,function(l,o,s,r,a){if(l.isEnabled()){if(t=l.getImportableCells(t),t.length>0){l.stopEditing();var d=null!=s&&!mxEvent.isAltDown(o)&&l.isValidDropTarget(s,t,o),u=null;if(null==s||d||(s=null),!l.isCellLocked(s||l.getDefaultParent())){l.model.beginUpdate();try{if(r=Math.round(r),a=Math.round(a),e&&l.isSplitTarget(s,t,o)){var c=l.cloneCells(t);l.splitEdge(s,c,null,r-i.width/2,a-i.height/2),u=c}else t.length>0&&(u=l.importCells(t,r,a,s));if(null!=l.layoutManager){var h=l.layoutManager.getLayout(s);if(null!=h)for(var p=l.view.scale,m=l.view.translate,g=(r+m.x)*p,x=(a+m.y)*p,y=0;y<u.length;y++)h.moveCell(u[y],g,x)}n&&l.fireEvent(new mxEventObject("cellsInserted","cells",u))}finally{l.model.endUpdate()}null!=u&&u.length>0&&(l.scrollCellToVisible(u[0]),l.setSelectionCells(u))}}mxEvent.consume(o)}})},i.prototype.createDragPreview=function(t,e){var n=document.createElement("div");return n.style.border="1px dashed black",n.style.width=t+"px",n.style.height=e+"px",n},i.prototype.dropAndConnect=function(t,e,n,i){var l=this.getDropAndConnectGeometry(t,e[i],n,e);if(null!=l){var o=this.editorUi.editor.graph,s=[];o.model.beginUpdate();try{var r=o.getCellGeometry(t),a=o.getCellGeometry(e[i]),d=o.model.getParent(t),u=!0;if(null!=o.layoutManager){var c=o.layoutManager.getLayout(d);if(null!=c&&c.constructor==mxStackLayout){u=!1;var s=o.view.getState(d);if(null!=s){var h=new mxPoint(s.x/o.view.scale-o.view.translate.x,s.y/o.view.scale-o.view.translate.y);l.x+=h.x,l.y+=h.y;var p=l.getTerminalPoint(!1);null!=p&&(p.x+=h.x,p.y+=h.y)}}}var m=a.x,g=a.y;o.model.isEdge(e[i])&&(m=0,g=0);var x=o.model.isEdge(t)||null!=r&&!r.relative&&u;if(e=o.importCells(e,l.x-(x?m:0),l.y-(x?g:0),x?d:null),s=e,o.model.isEdge(t))o.model.setTerminal(t,e[i],n==mxConstants.DIRECTION_NORTH);else if(o.model.isEdge(e[i])){o.model.setTerminal(e[i],t,!0);var y=o.getCellGeometry(e[i]);if(y.points=null,null!=y.getTerminalPoint(!1))y.setTerminalPoint(l.getTerminalPoint(!1),!1);else if(x&&o.model.isVertex(d)){var f=o.view.getState(d),h=new mxPoint(f.x/o.view.scale-o.view.translate.x,f.y/o.view.scale-o.view.translate.y);o.cellsMoved(e,h.x,h.y,null,null,!0)}}else a=o.getCellGeometry(e[i]),m=l.x-Math.round(a.x),g=l.y-Math.round(a.y),l.x=Math.round(a.x),l.y=Math.round(a.y),o.model.setGeometry(e[i],l),o.cellsMoved(e,m,g,null,null,!0),s=e.slice(),e.push(o.insertEdge(null,null,"",t,e[i],o.createCurrentEdgeStyle()));o.fireEvent(new mxEventObject("cellsInserted","cells",e))}finally{o.model.endUpdate()}o.setSelectionCells(s)}},i.prototype.getDropAndConnectGeometry=function(t,e,n,i){var l=this.editorUi.editor.graph,o=l.view,s=i.length>1,r=l.getCellGeometry(t),a=l.getCellGeometry(e);if(null!=r&&null!=a)if(a=a.clone(),l.model.isEdge(t)){var d=l.view.getState(t),u=d.absolutePoints,c=u[0],h=u[u.length-1];n==mxConstants.DIRECTION_NORTH?(a.x=c.x/o.scale-o.translate.x-a.width/2,a.y=c.y/o.scale-o.translate.y-a.height/2):(a.x=h.x/o.scale-o.translate.x-a.width/2,a.y=h.y/o.scale-o.translate.y-a.height/2)}else{if(r.relative){var d=l.view.getState(t);r=r.clone(),r.x=(d.x-o.translate.x)/o.scale,r.y=(d.y-o.translate.y)/o.scale}var p=l.defaultEdgeLength;if(l.model.isEdge(e)&&null!=a.getTerminalPoint(!0)&&null!=a.getTerminalPoint(!1)){var c=a.getTerminalPoint(!0),h=a.getTerminalPoint(!1),m=h.x-c.x,g=h.y-c.y;p=Math.sqrt(m*m+g*g),a.x=r.getCenterX(),a.y=r.getCenterY(),a.width=1,a.height=1,n==mxConstants.DIRECTION_NORTH?(a.height=p,a.y=r.y-p,a.setTerminalPoint(new mxPoint(a.x,a.y),!1)):n==mxConstants.DIRECTION_EAST?(a.width=p,a.x=r.x+r.width,a.setTerminalPoint(new mxPoint(a.x+a.width,a.y),!1)):n==mxConstants.DIRECTION_SOUTH?(a.height=p,a.y=r.y+r.height,a.setTerminalPoint(new mxPoint(a.x,a.y+a.height),!1)):n==mxConstants.DIRECTION_WEST&&(a.width=p,a.x=r.x-p,a.setTerminalPoint(new mxPoint(a.x,a.y),!1))}else if(!s&&a.width>45&&a.height>45&&r.width>45&&r.height>45&&(a.width*=r.height/a.height,a.height=r.height),a.x=r.x+r.width/2-a.width/2,a.y=r.y+r.height/2-a.height/2,n==mxConstants.DIRECTION_NORTH?a.y=a.y-r.height/2-a.height/2-p:n==mxConstants.DIRECTION_EAST?a.x=a.x+r.width/2+a.width/2+p:n==mxConstants.DIRECTION_SOUTH?a.y=a.y+r.height/2+a.height/2+p:n==mxConstants.DIRECTION_WEST&&(a.x=a.x-r.width/2-a.width/2-p),l.model.isEdge(e)&&null!=a.getTerminalPoint(!0)&&null!=e.getTerminal(!1)){var x=l.getCellGeometry(e.getTerminal(!1));null!=x&&(n==mxConstants.DIRECTION_NORTH?(a.x-=x.getCenterX(),a.y-=x.getCenterY()+x.height/2):n==mxConstants.DIRECTION_EAST?(a.x-=x.getCenterX()-x.width/2,a.y-=x.getCenterY()):n==mxConstants.DIRECTION_SOUTH?(a.x-=x.getCenterX(),a.y-=x.getCenterY()-x.height/2):n==mxConstants.DIRECTION_WEST&&(a.x-=x.getCenterX()+x.width/2,a.y-=x.getCenterY()))}}return a},i.prototype.createDragSource=function(t,e,n,i,l){function o(t,e,n,i){return null!=i.parentNode&&(mxUtils.contains(n,t,e)?(mxUtils.setOpacity(i,100),L=i):mxUtils.setOpacity(i,i==w?30:20)),n}for(var s=this,r=this.editorUi,a=r.editor.graph,d=null,u=null,c=this,h=0;h<i.length&&(null==u&&this.editorUi.editor.graph.model.isVertex(i[h])?u=h:null==d&&this.editorUi.editor.graph.model.isEdge(i[h])&&null==this.editorUi.editor.graph.model.getTerminal(i[h],!0)&&(d=h),null==u||null==d);h++);var p=mxUtils.makeDraggable(t,this.editorUi.editor.graph,mxUtils.bind(this,function(t,n,l,o,s){if(null!=this.updateThread&&window.clearTimeout(this.updateThread),null!=i&&null!=f&&L==w){var r=t.isCellSelected(f.cell)?t.getSelectionCells():[f.cell],a=this.updateShapes(t.model.isEdge(f.cell)?i[0]:i[u],r);t.setSelectionCells(a)}else if(null!=i&&null!=L&&null!=x&&L!=w){var c=t.model.isEdge(x.cell)||null==d?u:d;this.dropAndConnect(x.cell,i,I,c)}else e.apply(this,arguments);null!=this.editorUi.hoverIcons&&this.editorUi.hoverIcons.update(t.view.getState(t.getSelectionCell()))}),n,0,0,this.editorUi.editor.graph.autoscroll,!0,!0);this.editorUi.editor.graph.addListener(mxEvent.ESCAPE,function(t,e){p.isActive()&&p.reset()});var m=p.mouseDown;p.mouseDown=function(t){mxEvent.isPopupTrigger(t)||mxEvent.isMultiTouchEvent(t)||(a.stopEditing(),m.apply(this,arguments))};var g=function(t,e){var n=null;return mxClient.IS_IE&&!mxClient.IS_SVG?(mxClient.IS_IE6&&"CSS1Compat"!=document.compatMode?(n=document.createElement(mxClient.VML_PREFIX+":image"),n.setAttribute("src",t.src),n.style.borderStyle="none"):(n=document.createElement("div"),n.style.backgroundImage="url("+t.src+")",n.style.backgroundPosition="center",n.style.backgroundRepeat="no-repeat"),n.style.width=t.width+4+"px",n.style.height=t.height+4+"px",n.style.display=mxClient.IS_QUIRKS?"inline":"inline-block"):(n=mxUtils.createImage(t.src),n.style.width=t.width+"px",n.style.height=t.height+"px"),null!=e&&n.setAttribute("title",e),mxUtils.setOpacity(n,t==s.refreshTarget?30:20),n.style.position="absolute",n.style.cursor="crosshair",n},x=null,y=null,f=null,C=!1,S=g(this.triangleUp,mxResources.get("connect")),E=g(this.triangleRight,mxResources.get("connect")),v=g(this.triangleDown,mxResources.get("connect")),b=g(this.triangleLeft,mxResources.get("connect")),w=g(this.refreshTarget,mxResources.get("replace")),T=null,A=g(this.roundDrop),R=g(this.roundDrop),I=mxConstants.DIRECTION_NORTH,L=null,U=p.createPreviewElement;p.createPreviewElement=function(t){var e=U.apply(this,arguments);return mxClient.IS_SVG&&(e.style.pointerEvents="none"),this.previewElementWidth=e.style.width,this.previewElementHeight=e.style.height,e};var N=p.dragEnter;p.dragEnter=function(t,e){null!=r.hoverIcons&&r.hoverIcons.setDisplay("none"),N.apply(this,arguments)};var M=p.dragExit;p.dragExit=function(t,e){null!=r.hoverIcons&&r.hoverIcons.setDisplay(""),M.apply(this,arguments)},p.dragOver=function(t,e){if(mxDragSource.prototype.dragOver.apply(this,arguments),null!=this.currentGuide&&null!=L&&this.currentGuide.hide(),null!=this.previewElement){var n=t.view;if(null!=f&&L==w)this.previewElement.style.display=t.model.isEdge(f.cell)?"none":"",this.previewElement.style.left=f.x+"px",this.previewElement.style.top=f.y+"px",this.previewElement.style.width=f.width+"px",this.previewElement.style.height=f.height+"px";else if(null!=x&&null!=L){var o=t.model.isEdge(x.cell)||null==d?u:d,s=c.getDropAndConnectGeometry(x.cell,i[o],I,i),r=t.model.isEdge(x.cell)?null:t.getCellGeometry(x.cell),a=t.getCellGeometry(i[o]),h=t.model.getParent(x.cell),m=n.translate.x*n.scale,g=n.translate.y*n.scale;if(null!=r&&!r.relative&&t.model.isVertex(h)){var y=n.getState(h);m=y.x,g=y.y}var C=a.x,S=a.y;t.model.isEdge(i[o])&&(C=0,S=0),this.previewElement.style.left=(s.x-C)*n.scale+m+"px",this.previewElement.style.top=(s.y-S)*n.scale+g+"px",1==i.length&&(this.previewElement.style.width=s.width*n.scale+"px",this.previewElement.style.height=s.height*n.scale+"px"),this.previewElement.style.display=""}else null!=p.currentHighlight.state&&t.model.isEdge(p.currentHighlight.state.cell)?(this.previewElement.style.left=Math.round(parseInt(this.previewElement.style.left)-l.width*n.scale/2)+"px",this.previewElement.style.top=Math.round(parseInt(this.previewElement.style.top)-l.height*n.scale/2)+"px"):(this.previewElement.style.width=this.previewElementWidth,this.previewElement.style.height=this.previewElementHeight,this.previewElement.style.display="")}};var O=(new Date).getTime(),_=0,D=null,H=this.editorUi.editor.graph.getCellStyle(i[0]);return p.getDropTarget=mxUtils.bind(this,function(t,e,n,l){var s=mxEvent.isAltDown(l)||null==i?null:t.getCellAt(e,n);if(null!=s&&!this.graph.isCellConnectable(s)){var r=this.graph.getModel().getParent(s);this.graph.getModel().isVertex(r)&&this.graph.isCellConnectable(r)&&(s=r)}t.isCellLocked(s)&&(s=null);var a=t.view.getState(s);L=null;var d=null;if(D!=a?(D=a,O=(new Date).getTime(),_=0,null!=this.updateThread&&window.clearTimeout(this.updateThread),null!=a&&(this.updateThread=window.setTimeout(function(){null==L&&(D=a,p.getDropTarget(t,e,n,l))},this.dropTargetDelay+10))):_=(new Date).getTime()-O,_<2500&&null!=a&&!mxEvent.isShiftDown(l)&&(mxUtils.getValue(a.style,mxConstants.STYLE_SHAPE)!=mxUtils.getValue(H,mxConstants.STYLE_SHAPE)&&mxUtils.getValue(a.style,mxConstants.STYLE_STROKECOLOR,mxConstants.NONE)!=mxConstants.NONE||"image"==mxUtils.getValue(H,mxConstants.STYLE_SHAPE)||_>1500||t.model.isEdge(a.cell))&&_>this.dropTargetDelay&&(t.model.isVertex(a.cell)&&null!=u||t.model.isEdge(a.cell)&&t.model.isEdge(i[0]))){f=a;var c=t.model.isEdge(a.cell)?t.view.getPoint(a):new mxPoint(a.getCenterX(),a.getCenterY());c=new mxRectangle(c.x-this.refreshTarget.width/2,c.y-this.refreshTarget.height/2,this.refreshTarget.width,this.refreshTarget.height),w.style.left=Math.floor(c.x)+"px",w.style.top=Math.floor(c.y)+"px",null==T&&(t.container.appendChild(w),T=w.parentNode),o(e,n,c,w)}else if(null==f||!mxUtils.contains(f,e,n)||_>1500&&!mxEvent.isShiftDown(l))f=null,null!=T&&(w.parentNode.removeChild(w),T=null);else if(null!=f&&null!=T){var c=t.model.isEdge(f.cell)?t.view.getPoint(f):new mxPoint(f.getCenterX(),f.getCenterY());c=new mxRectangle(c.x-this.refreshTarget.width/2,c.y-this.refreshTarget.height/2,this.refreshTarget.width,this.refreshTarget.height),o(e,n,c,w)}if(C&&null!=x&&!mxEvent.isAltDown(l)&&null==L){if(d=mxRectangle.fromRectangle(x),t.model.isEdge(x.cell)){var h=x.absolutePoints;if(null!=A.parentNode){var m=h[0];d.add(o(e,n,new mxRectangle(m.x-this.roundDrop.width/2,m.y-this.roundDrop.height/2,this.roundDrop.width,this.roundDrop.height),A))}if(null!=R.parentNode){var g=h[h.length-1];d.add(o(e,n,new mxRectangle(g.x-this.roundDrop.width/2,g.y-this.roundDrop.height/2,this.roundDrop.width,this.roundDrop.height),R))}}else{var U=mxRectangle.fromRectangle(x);null!=x.shape&&null!=x.shape.boundingBox&&(U=mxRectangle.fromRectangle(x.shape.boundingBox)),U.grow(this.graph.tolerance),U.grow(HoverIcons.prototype.arrowSpacing);var N=this.graph.selectionCellsHandler.getHandler(x.cell);null!=N&&(U.x-=N.horizontalOffset/2,U.y-=N.verticalOffset/2,U.width+=N.horizontalOffset,U.height+=N.verticalOffset,null!=N.rotationShape&&null!=N.rotationShape.node&&"hidden"!=N.rotationShape.node.style.visibility&&"none"!=N.rotationShape.node.style.display&&null!=N.rotationShape.boundingBox&&U.add(N.rotationShape.boundingBox)),d.add(o(e,n,new mxRectangle(x.getCenterX()-this.triangleUp.width/2,U.y-this.triangleUp.height,this.triangleUp.width,this.triangleUp.height),S)),d.add(o(e,n,new mxRectangle(U.x+U.width,x.getCenterY()-this.triangleRight.height/2,this.triangleRight.width,this.triangleRight.height),E)),d.add(o(e,n,new mxRectangle(x.getCenterX()-this.triangleDown.width/2,U.y+U.height,this.triangleDown.width,this.triangleDown.height),v)),d.add(o(e,n,new mxRectangle(U.x-this.triangleLeft.width,x.getCenterY()-this.triangleLeft.height/2,this.triangleLeft.width,this.triangleLeft.height),b))}null!=d&&d.grow(10)}I=mxConstants.DIRECTION_NORTH,L==E?I=mxConstants.DIRECTION_EAST:L==v||L==R?I=mxConstants.DIRECTION_SOUTH:L==b&&(I=mxConstants.DIRECTION_WEST),null!=f&&L==w&&(a=f);var M=(null==u||t.isCellConnectable(i[u]))&&(t.model.isEdge(s)&&null!=u||t.model.isVertex(s)&&t.isCellConnectable(s));if(null!=x&&_>=5e3||x!=a&&(null==d||!mxUtils.contains(d,e,n)||_>500&&null==L&&M))if(C=!1,null!=(x=_<5e3&&_>this.dropTargetDelay||t.model.isEdge(s)?a:null)&&M){for(var P=[A,R,S,E,v,b],k=0;k<P.length;k++)null!=P[k].parentNode&&P[k].parentNode.removeChild(P[k]);if(t.model.isEdge(s)){var h=a.absolutePoints;if(null!=h){var m=h[0],g=h[h.length-1],F=t.tolerance;new mxRectangle(e-F,n-F,2*F,2*F);A.style.left=Math.floor(m.x-this.roundDrop.width/2)+"px",A.style.top=Math.floor(m.y-this.roundDrop.height/2)+"px",R.style.left=Math.floor(g.x-this.roundDrop.width/2)+"px",R.style.top=Math.floor(g.y-this.roundDrop.height/2)+"px",null==t.model.getTerminal(s,!0)&&t.container.appendChild(A),null==t.model.getTerminal(s,!1)&&t.container.appendChild(R)}}else{var U=mxRectangle.fromRectangle(a);null!=a.shape&&null!=a.shape.boundingBox&&(U=mxRectangle.fromRectangle(a.shape.boundingBox)),U.grow(this.graph.tolerance),U.grow(HoverIcons.prototype.arrowSpacing);var N=this.graph.selectionCellsHandler.getHandler(a.cell);null!=N&&(U.x-=N.horizontalOffset/2,U.y-=N.verticalOffset/2,U.width+=N.horizontalOffset,U.height+=N.verticalOffset,null!=N.rotationShape&&null!=N.rotationShape.node&&"hidden"!=N.rotationShape.node.style.visibility&&"none"!=N.rotationShape.node.style.display&&null!=N.rotationShape.boundingBox&&U.add(N.rotationShape.boundingBox)),S.style.left=Math.floor(a.getCenterX()-this.triangleUp.width/2)+"px",S.style.top=Math.floor(U.y-this.triangleUp.height)+"px",E.style.left=Math.floor(U.x+U.width)+"px",E.style.top=Math.floor(a.getCenterY()-this.triangleRight.height/2)+"px",v.style.left=S.style.left,v.style.top=Math.floor(U.y+U.height)+"px",b.style.left=Math.floor(U.x-this.triangleLeft.width)+"px",b.style.top=E.style.top,"eastwest"!=a.style.portConstraint&&(t.container.appendChild(S),t.container.appendChild(v)),t.container.appendChild(E),t.container.appendChild(b)}null!=a&&null!=(y=t.selectionCellsHandler.getHandler(a.cell))&&null!=y.setHandlesVisible&&y.setHandlesVisible(!1),C=!0}else for(var P=[A,R,S,E,v,b],k=0;k<P.length;k++)null!=P[k].parentNode&&P[k].parentNode.removeChild(P[k]);C||null==y||y.setHandlesVisible(!0);var G=mxEvent.isAltDown(l)&&!mxEvent.isShiftDown(l)||null!=f&&L==w?null:mxDragSource.prototype.getDropTarget.apply(this,arguments),Y=t.getModel();if(null!=G&&(null!=L||!t.isSplitTarget(G,i,l))){for(;null!=G&&!t.isValidDropTarget(G,i,l)&&Y.isVertex(Y.getParent(G));)G=Y.getParent(G);(t.view.currentRoot==G||!t.isValidRoot(G)&&0==t.getModel().getChildCount(G)||t.isCellLocked(G)||Y.isEdge(G))&&(G=null)}return G}),p.stopDrag=function(){mxDragSource.prototype.stopDrag.apply(this,arguments);for(var t=[A,R,w,S,E,v,b],e=0;e<t.length;e++)null!=t[e].parentNode&&t[e].parentNode.removeChild(t[e]);null!=x&&null!=y&&y.reset(),y=null,x=null,f=null,T=null,L=null},p},i.prototype.itemClicked=function(t,e,n,i){var l=this.editorUi.editor.graph;if(mxEvent.isAltDown(n)){if(1==l.getSelectionCount()&&l.model.isVertex(l.getSelectionCell())){for(var o=null,s=0;s<t.length&&null==o;s++)l.model.isVertex(t[s])&&(o=s);null!=o&&(this.dropAndConnect(l.getSelectionCell(),t,mxEvent.isMetaDown(n)||mxEvent.isControlDown(n)?mxEvent.isShiftDown(n)?mxConstants.DIRECTION_WEST:mxConstants.DIRECTION_NORTH:mxEvent.isShiftDown(n)?mxConstants.DIRECTION_EAST:mxConstants.DIRECTION_SOUTH,o),l.scrollCellToVisible(l.getSelectionCell()))}}else if(mxEvent.isShiftDown(n))l.isSelectionEmpty()||(this.updateShapes(t[0],l.getSelectionCells()),l.scrollCellToVisible(l.getSelectionCell()));else{var r=l.getFreeInsertPoint();e.drop(l,n,null,r.x,r.y),null!=this.editorUi.hoverIcons&&mxEvent.isTouchEvent(n)&&this.editorUi.hoverIcons.update(l.view.getState(l.getSelectionCell()))}},i.prototype.addClickHandler=function(t,e,n){var i=this.editorUi.editor.graph,l=e.mouseUp,o=null;mxEvent.addGestureListeners(t,function(t){o=new mxPoint(mxEvent.getClientX(t),mxEvent.getClientY(t))}),e.mouseUp=mxUtils.bind(this,function(s){if(!mxEvent.isPopupTrigger(s)&&null==this.currentGraph&&null!=o){var r=i.tolerance;Math.abs(o.x-mxEvent.getClientX(s))<=r&&Math.abs(o.y-mxEvent.getClientY(s))<=r&&this.itemClicked(n,e,s,t)}l.apply(e,arguments),o=null,this.currentElt=t})},i.prototype.createVertexTemplateEntry=function(t,e,n,i,l,o,s,r){return r=null!=r&&r.length>0?r:l.toLowerCase(),this.addEntry(r,mxUtils.bind(this,function(){return this.createVertexTemplate(t,e,n,i,l,o,s)}))},i.prototype.createVertexTemplate=function(t,e,n,i,l,o,s,r){var a=[new mxCell(null!=i?i:"",new mxGeometry(0,0,e,n),t)];return a[0].vertex=!0,this.createVertexTemplateFromCells(a,e,n,l,o,s,r)},i.prototype.createVertexTemplateFromCells=function(t,e,n,i,l,o,s){return this.createItem(t,i,l,o,e,n,s)},i.prototype.createEdgeTemplateEntry=function(t,e,n,i,l,o,s,r){return s=null!=s&&s.length>0?s:l.toLowerCase(),this.addEntry(s,mxUtils.bind(this,function(){return this.createEdgeTemplate(t,e,n,i,l,o,r)}))},i.prototype.createEdgeTemplate=function(t,e,n,i,l,o,s){var r=new mxCell(null!=i?i:"",new mxGeometry(0,0,e,n),t);return r.geometry.setTerminalPoint(new mxPoint(0,n),!0),r.geometry.setTerminalPoint(new mxPoint(e,0),!1),r.geometry.relative=!0,r.edge=!0,this.createEdgeTemplateFromCells([r],e,n,l,o,s)},i.prototype.createEdgeTemplateFromCells=function(t,e,n,i,l,o){return this.createItem(t,i,l,!0,e,n,o)},i.prototype.addPaletteFunctions=function(t,e,n,i){this.addPalette(t,e,n,mxUtils.bind(this,function(t){for(var e=0;e<i.length;e++)t.appendChild(i[e](t))}))},i.prototype.addPalette=function(t,e,n,i){var l=this.createTitle(e);this.container.appendChild(l);var o=document.createElement("div");o.className="geSidebar",mxClient.IS_POINTER&&(o.style.touchAction="none"),mxEvent.addListener(o,"mousemove",mxUtils.bind(this,function(t){mxEvent.getSource(t)==o?o.setAttribute("title",mxResources.get("sidebarTooltip")):o.removeAttribute("title")})),n?(i(o),i=null):o.style.display="none",this.addFoldingHandler(l,o,i);var s=document.createElement("div");return s.appendChild(o),this.container.appendChild(s),null!=t&&(this.palettes[t]=[l,s]),o},i.prototype.addFoldingHandler=function(t,e,n){var i=!1;(!mxClient.IS_IE||document.documentMode>=8)&&(t.style.backgroundImage="none"==e.style.display?"url('"+this.collapsedImage+"')":"url('"+this.expandedImage+"')"),t.style.backgroundRepeat="no-repeat",t.style.backgroundPosition="0% 50%",mxEvent.addListener(t,"click",mxUtils.bind(this,function(l){if("none"==e.style.display){if(i)e.style.display="block";else if(i=!0,null!=n){t.style.cursor="wait";var o=t.innerHTML;t.innerHTML=mxResources.get("loading")+"...",window.setTimeout(function(){var i=mxClient.NO_FO;mxClient.NO_FO=Editor.prototype.originalNoForeignObject,n(e),mxClient.NO_FO=i,e.style.display="block",t.style.cursor="",t.innerHTML=o},0)}else e.style.display="block";t.style.backgroundImage="url('"+this.expandedImage+"')"}else t.style.backgroundImage="url('"+this.collapsedImage+"')",e.style.display="none";mxEvent.consume(l)}))},i.prototype.removePalette=function(t){var e=this.palettes[t];if(null!=e){this.palettes[t]=null;for(var n=0;n<e.length;n++)this.container.removeChild(e[n]);return!0}return!1},i.prototype.addImagePalette=function(t,e,n,i,l,o,s){for(var r=[],a=0;a<l.length;a++)mxUtils.bind(this,function(t,e,l){if(null==l){var o=t.lastIndexOf("/"),s=t.lastIndexOf(".");l=t.substring(o>=0?o+1:0,s>=0?s:t.length).replace(/[-_]/g," ")}r.push(this.createVertexTemplateEntry("image;html=1;labelBackgroundColor=#ffffff;image="+n+t+i,this.defaultImageWidth,this.defaultImageHeight,"",e,null!=e,null,this.filterTags(l)))})(l[a],null!=o?o[a]:null,null!=s?s[l[a]]:null);this.addPaletteFunctions(t,e,!1,r)},i.prototype.getTagsForStencil=function(t,e,n){for(var i=t.split("."),l=1;l<i.length;l++)i[l]=i[l].replace(/_/g," ");return i.push(e.replace(/_/g," ")),null!=n&&i.push(n),i.slice(1,i.length)},i.prototype.addStencilPalette=function(t,e,n,i,l,o,s,r,a){if(s=null!=s?s:1,this.addStencilsToIndex){var d=[];if(null!=a)for(var u=0;u<a.length;u++)d.push(a[u]);mxStencilRegistry.loadStencilSet(n,mxUtils.bind(this,function(t,e,n,o,a){if(null==l||mxUtils.indexOf(l,e)<0){var u=this.getTagsForStencil(t,e),c=null!=r?r[e]:null;null!=c&&u.push(c),d.push(this.createVertexTemplateEntry("shape="+t+e.toLowerCase()+i,Math.round(o*s),Math.round(a*s),"",e.replace(/_/g," "),null,null,this.filterTags(u.join(" "))))}}),!0,!0),this.addPaletteFunctions(t,e,!1,d)}else this.addPalette(t,e,!1,mxUtils.bind(this,function(t){if(null==i&&(i=""),null!=o&&o.call(this,t),null!=a)for(var e=0;e<a.length;e++)a[e](t);mxStencilRegistry.loadStencilSet(n,mxUtils.bind(this,function(e,n,o,r,a){(null==l||mxUtils.indexOf(l,n)<0)&&t.appendChild(this.createVertexTemplate("shape="+e+n.toLowerCase()+i,Math.round(r*s),Math.round(a*s),"",n.replace(/_/g," "),!0))}),!0)}))},i.prototype.destroy=function(){null!=this.graph&&(null!=this.graph.container&&null!=this.graph.container.parentNode&&this.graph.container.parentNode.removeChild(this.graph.container),this.graph.destroy(),this.graph=null),null!=this.pointerUpHandler&&(mxEvent.removeListener(document,mxClient.IS_POINTER?"pointerup":"mouseup",this.pointerUpHandler),this.pointerUpHandler=null),null!=this.pointerDownHandler&&(mxEvent.removeListener(document,mxClient.IS_POINTER?"pointerdown":"mousedown",this.pointerDownHandler),this.pointerDownHandler=null),null!=this.pointerMoveHandler&&(mxEvent.removeListener(document,mxClient.IS_POINTER?"pointermove":"mousemove",this.pointerMoveHandler),this.pointerMoveHandler=null),null!=this.pointerOutHandler&&(mxEvent.removeListener(document,mxClient.IS_POINTER?"pointerout":"mouseout",this.pointerOutHandler),this.pointerOutHandler=null)},i.prototype.triangleUp=HoverIcons.prototype.triangleUp,i.prototype.triangleRight=HoverIcons.prototype.triangleRight,i.prototype.triangleDown=HoverIcons.prototype.triangleDown,i.prototype.triangleLeft=HoverIcons.prototype.triangleLeft,i.prototype.refreshTarget=HoverIcons.prototype.refreshTarget,i.prototype.roundDrop=HoverIcons.prototype.roundDrop,t.exports=i},function(t,e,n){"use strict";var i=function(t,e){var n=new mxCell("+ field: type",new mxGeometry(0,0,100,26),"text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;"),i=new mxCell("+ field: type",new mxGeometry(0,0,100,26),"text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;componentName=attribute"),l=new mxCell("+ method(type): type",new mxGeometry(0,0,100,26),"text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;componentName=method");n.vertex=!0,i.vertex=!0,l.vertex=!0;var o=new mxCell("",new mxGeometry(0,0,40,8),"line;html=1;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;");o.vertex=!0;var s="uml static class ",r=[t.addEntry(s+"object instance",function(){var e=new mxCell("Classname",new mxGeometry(0,0,160,90),"swimlane;html=1;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeLast=0;collapsible=1;marginBottom=0;swimlaneFillColor=#ffffff;fillColor=#DAE8FC;componentName=class;");return e.vertex=!0,e.insert(i.clone()),e.insert(o.clone()),e.insert(l.clone()),t.createVertexTemplateFromCells([e],e.geometry.width,e.geometry.height,"Class")}),t.addEntry(s+"item member method function variable field attribute label",function(){return t.createVertexTemplateFromCells([t.cloneCell(n,"+ item: attribute")],n.geometry.width,n.geometry.height,"Item 1")}),t.addEntry(s+"divider hline line separator",function(){return t.createVertexTemplateFromCells([o.clone()],o.geometry.width,o.geometry.height,"Divider")}),t.createVertexTemplateEntry("text;html=1;align=center;fontStyle=1;verticalAlign=middle;spacingLeft=3;spacingRight=3;strokeColor=none;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;",80,26,"Title","Title",null,null,s+"title label"),t.addEntry(s+"object instance",function(){var e=new mxCell("<i>&lt;&lt;Interface&gt;&gt;</i><br/> Interface",new mxGeometry(0,0,190,90),"swimlane;html=1;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeLast=0;collapsible=1;marginBottom=0;swimlaneFillColor=#ffffff;fillColor=#DAE8FC;componentName=interface;");return e.vertex=!0,e.insert(i.clone()),e.insert(o.clone()),e.insert(l.clone()),t.createVertexTemplateFromCells([e],e.geometry.width,e.geometry.height,"Interface")}),t.addEntry("uml aggregation",function(){var e=new mxCell("1",new mxGeometry(0,0,0,0),"endArrow=open;html=1;endSize=12;startArrow=diamondThin;startSize=14;startFill=0;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=bottom;");return e.geometry.setTerminalPoint(new mxPoint(0,0),!0),e.geometry.setTerminalPoint(new mxPoint(160,0),!1),e.geometry.relative=!0,e.geometry.x=-1,e.geometry.y=3,e.edge=!0,t.createEdgeTemplateFromCells([e],160,0,"Aggregation")}),t.addEntry("uml composition",function(){var e=new mxCell("1",new mxGeometry(0,0,0,0),"endArrow=open;html=1;endSize=12;startArrow=diamondThin;startSize=14;startFill=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=bottom;");return e.geometry.setTerminalPoint(new mxPoint(0,0),!0),e.geometry.setTerminalPoint(new mxPoint(160,0),!1),e.geometry.relative=!0,e.geometry.x=-1,e.geometry.y=3,e.edge=!0,t.createEdgeTemplateFromCells([e],160,0,"Composition")}),t.createEdgeTemplateEntry("endArrow=block;endSize=16;endFill=0;html=1;componentName=generalization;",160,0,"Extends","Generalization",null,"uml generalization extend")];t.addPaletteFunctions("classDiagram",mxResources.get("classDiagram"),e||!1,r)};t.exports=i},function(t,e,n){"use strict";function i(t){this.editorUi=t,this.actions=new Object,this.init()}function l(t,e,n,i,l){mxEventSource.call(this),this.label=t,this.funct=e,this.enabled=null==n||n,this.iconCls=i,this.shortcut=l,this.visible=!0}var o=n(7),s=n(8),r=n(9);i.prototype.init=function(){function t(t){i.escape();var e=i.getDeletableCells(i.getSelectionCells());if(null!=e&&e.length>0){var n=i.model.getParents(e);if(i.removeCells(e,t),null!=n){for(var l=[],o=0;o<n.length;o++)(i.model.isVertex(n[o])||i.model.isEdge(n[o]))&&l.push(n[o]);i.setSelectionCells(l)}}}var e=this.editorUi,n=e.editor,i=n.graph,a=function(){return l.prototype.isEnabled.apply(this,arguments)&&i.isEnabled()};this.addAction("new...",function(){window.open(e.getUrl())}),this.addAction("open...",function(){window.openNew=!0,window.openKey="open",window.editorUi=e,e.openFile()}),this.addAction("import...",function(){window.openNew=!1,window.openKey="import",window.openFile=new OpenFile(mxUtils.bind(this,function(){e.hideDialog()})),window.openFile.setConsumer(mxUtils.bind(this,function(t,e){try{var i=mxUtils.parseXml(t),l=new mxGraphModel;new mxCodec(i).decode(i.documentElement,l);var o=l.getChildren(l.getChildAt(l.getRoot(),0));n.graph.setSelectionCells(n.graph.importCells(o))}catch(t){mxUtils.alert(mxResources.get("invalidOrMissingFile")+": "+t.message)}})),e.showDialog(new OpenDialog(this).container,320,220,!0,!0,function(){window.openFile=null})}).isEnabled=a,this.addAction("save",function(){o(e,!1)},null,null,"Ctrl+S").isEnabled=a,this.addAction("saveAs...",function(){o(e,!0)},null,null,"Ctrl+Shift+S").isEnabled=a,this.addAction("export...",function(){e.showDialog(new s(e).container,300,230,!0,!0)}),this.addAction("editDiagram...",function(){var t=new EditDiagramDialog(e);e.showDialog(t.container,620,420,!0,!0),t.init()}),this.addAction("generateCode...",function(){e.showDialog(new r(e).container,300,230,!0,!0)}),this.addAction("pageSetup...",function(){e.showDialog(new PageSetupDialog(e).container,320,220,!0,!0)}).isEnabled=a,this.addAction("print...",function(){e.showDialog(new PrintDialog(e).container,300,180,!0,!0)},null,"sprite-print","Ctrl+P"),this.addAction("preview",function(){mxUtils.show(i,null,10,10)}),this.addAction("undo",function(){e.undo()},null,"sprite-undo","Ctrl+Z"),this.addAction("redo",function(){e.redo()},null,"sprite-redo",mxClient.IS_WIN?"Ctrl+Y":"Ctrl+Shift+Z"),this.addAction("cut",function(){mxClipboard.cut(i)},null,"sprite-cut","Ctrl+X"),this.addAction("copy",function(){mxClipboard.copy(i)},null,"sprite-copy","Ctrl+C"),this.addAction("paste",function(){i.isEnabled()&&!i.isCellLocked(i.getDefaultParent())&&mxClipboard.paste(i)},!1,"sprite-paste","Ctrl+V"),this.addAction("pasteHere",function(t){if(i.isEnabled()&&!i.isCellLocked(i.getDefaultParent())){i.getModel().beginUpdate();try{var e=mxClipboard.paste(i);if(null!=e){var n=i.getBoundingBoxFromGeometry(e);if(null!=n){var l=i.view.translate,o=i.view.scale,s=l.x,r=l.y,a=Math.round(i.snap(i.popupMenuHandler.triggerX/o-s)),d=Math.round(i.snap(i.popupMenuHandler.triggerY/o-r));i.cellsMoved(e,a-n.x,d-n.y)}}}finally{i.getModel().endUpdate()}}}),this.addAction("delete",function(e){t(null!=e&&mxEvent.isShiftDown(e))},null,null,"Delete"),this.addAction("deleteAll",function(){t(!0)},null,null,"Ctrl+Delete"),this.addAction("duplicate",function(){i.setSelectionCells(i.duplicateCells())},null,null,"Ctrl+D"),this.put("turn",new l(mxResources.get("turn")+" / "+mxResources.get("reverse"),function(){i.turnShapes(i.getSelectionCells())},null,null,"Ctrl+R")),this.addAction("selectVertices",function(){i.selectVertices()},null,null,"Ctrl+Shift+I"),this.addAction("selectEdges",function(){i.selectEdges()},null,null,"Ctrl+Shift+E"),this.addAction("selectAll",function(){i.selectAll(null,!0)},null,null,"Ctrl+A"),this.addAction("selectNone",function(){i.clearSelection()},null,null,"Ctrl+Shift+A"),this.addAction("lockUnlock",function(){if(!i.isSelectionEmpty()){i.getModel().beginUpdate();try{var t=i.isCellMovable(i.getSelectionCell())?1:0;i.toggleCellStyles(mxConstants.STYLE_MOVABLE,t),i.toggleCellStyles(mxConstants.STYLE_RESIZABLE,t),i.toggleCellStyles(mxConstants.STYLE_ROTATABLE,t),i.toggleCellStyles(mxConstants.STYLE_DELETABLE,t),i.toggleCellStyles(mxConstants.STYLE_EDITABLE,t),i.toggleCellStyles("connectable",t)}finally{i.getModel().endUpdate()}}},null,null,"Ctrl+L"),this.addAction("home",function(){i.home()},null,null,"Home"),this.addAction("exitGroup",function(){i.exitGroup()},null,null,"Ctrl+Shift+Page Up"),this.addAction("enterGroup",function(){i.enterGroup()},null,null,"Ctrl+Shift+Page Down"),this.addAction("expand",function(){i.foldCells(!1)},null,null,"Ctrl+Page Down"),this.addAction("collapse",function(){i.foldCells(!0)},null,null,"Ctrl+Page Up"),this.addAction("toFront",function(){i.orderCells(!1)},null,null,"Ctrl+Shift+F"),this.addAction("toBack",function(){i.orderCells(!0)},null,null,"Ctrl+Shift+B"),this.addAction("group",function(){1==i.getSelectionCount()?i.setCellStyles("container","1"):i.setSelectionCell(i.groupCells(null,0))},null,null,"Ctrl+G"),this.addAction("ungroup",function(){1==i.getSelectionCount()&&0==i.getModel().getChildCount(i.getSelectionCell())?i.setCellStyles("container","0"):i.setSelectionCells(i.ungroupCells())},null,null,"Ctrl+Shift+U"),this.addAction("removeFromGroup",function(){i.removeCellsFromParent()}),this.addAction("edit",function(){i.isEnabled()&&i.startEditingAtCell()},null,null,"F2/Enter"),this.addAction("editData...",function(){var t=i.getSelectionCell()||i.getModel().getRoot();if(null!=t){var n=new EditDataDialog(e,t);e.showDialog(n.container,320,320,!0,!1),n.init()}},null,null,"Ctrl+M"),this.addAction("editTooltip...",function(){var t=e.editor.graph;if(t.isEnabled()&&!t.isSelectionEmpty()){var n=t.getSelectionCell(),i="";if(mxUtils.isNode(n.value)){var l=n.value.getAttribute("tooltip");null!=l&&(i=l)}var o=new TextareaDialog(e,mxResources.get("editTooltip")+":",i,function(e){t.setTooltipForCell(n,e)});e.showDialog(o.container,320,200,!0,!0),o.init()}}),this.addAction("openLink",function(){var t=i.getLinkForCell(i.getSelectionCell());null!=t&&window.open(t)}),this.addAction("editLink...",function(){var t=e.editor.graph;if(t.isEnabled()&&!t.isSelectionEmpty()){var n=t.getSelectionCell(),i=t.getLinkForCell(n)||"";e.showLinkDialog(i,mxResources.get("apply"),function(e){e=mxUtils.trim(e),t.setLinkForCell(n,e.length>0?e:null)})}}),this.addAction("insertLink...",function(){if(i.isEnabled()&&!i.isCellLocked(i.getDefaultParent())){var t=new LinkDialog(e,"",mxResources.get("insert"),function(t,e){if(t=mxUtils.trim(t),t.length>0){var n=t.substring(t.lastIndexOf("/")+1),l=null;null!=e&&e.length>0&&(l=e[0].iconUrl,n=e[0].name||e[0].type,n=n.charAt(0).toUpperCase()+n.substring(1),n.length>30&&(n=n.substring(0,30)+"..."));var o=i.getFreeInsertPoint(),s=new mxCell(n,new mxGeometry(o.x,o.y,100,40),"fontColor=#0000EE;fontStyle=4;rounded=1;overflow=hidden;"+(null!=l?"shape=label;imageWidth=16;imageHeight=16;spacingLeft=26;align=left;image="+l:"spacing=10;"));s.vertex=!0,i.setLinkForCell(s,t),i.cellSizeUpdated(s,!0),i.setSelectionCell(i.addCell(s)),i.scrollCellToVisible(i.getSelectionCell())}});e.showDialog(t.container,420,90,!0,!0),t.init()}}).isEnabled=a,this.addAction("link...",mxUtils.bind(this,function(){var t=e.editor.graph;if(t.isEnabled())if(t.cellEditor.isContentEditing()){var n=t.getParentByName(t.getSelectedElement(),"A",t.cellEditor.textarea),i="";null!=n&&(i=n.getAttribute("href")||"");var l=t.cellEditor.saveSelection();e.showLinkDialog(i,mxResources.get("apply"),mxUtils.bind(this,function(e){t.cellEditor.restoreSelection(l),null!=e&&t.insertLink(e)}))}else t.isSelectionEmpty()?this.get("insertLink").funct():this.get("editLink").funct()})).isEnabled=a,this.addAction("autosize",function(){var t=i.getSelectionCells();if(null!=t){i.getModel().beginUpdate();try{for(var e=0;e<t.length;e++){var n=t[e];if(i.getModel().getChildCount(n))i.updateGroupBounds([n],20);else{var l=i.view.getState(n),o=i.getCellGeometry(n);i.getModel().isVertex(n)&&null!=l&&null!=l.text&&null!=o&&i.isWrapping(n)?(o=o.clone(),o.height=l.text.boundingBox.height/i.view.scale,i.getModel().setGeometry(n,o)):i.updateCellSize(n)}}}finally{i.getModel().endUpdate()}}},null,null,"Ctrl+Shift+Y"),this.addAction("formattedText",function(){var t=i.getView().getState(i.getSelectionCell());if(null!=t){var n="1";i.stopEditing(),i.getModel().beginUpdate();try{if("1"==t.style.html){n=null;var l=i.convertValueToString(t.cell);"0"!=mxUtils.getValue(t.style,"nl2Br","1")&&(l=l.replace(/\n/g,"").replace(/<br\s*.?>/g,"\n"));var o=document.createElement("div");o.innerHTML=l,l=mxUtils.extractTextWithWhitespace(o.childNodes),i.cellLabelChanged(t.cell,l)}else{var l=mxUtils.htmlEntities(i.convertValueToString(t.cell),!1);"0"!=mxUtils.getValue(t.style,"nl2Br","1")&&(l=l.replace(/\n/g,"<br/>")),i.cellLabelChanged(t.cell,i.sanitizeHtml(l))}i.setCellStyles("html",n),e.fireEvent(new mxEventObject("styleChanged","keys",["html"],"values",[null!=n?n:"0"],"cells",i.getSelectionCells()))}finally{i.getModel().endUpdate()}}}),this.addAction("wordWrap",function(){var t=i.getView().getState(i.getSelectionCell()),e="wrap";i.stopEditing(),null!=t&&"wrap"==t.style[mxConstants.STYLE_WHITE_SPACE]&&(e=null),i.setCellStyles(mxConstants.STYLE_WHITE_SPACE,e)}),this.addAction("rotation",function(){var t="0",n=i.getView().getState(i.getSelectionCell());null!=n&&(t=n.style[mxConstants.STYLE_ROTATION]||t);var l=new FilenameDialog(e,t,mxResources.get("apply"),function(t){null!=t&&t.length>0&&i.setCellStyles(mxConstants.STYLE_ROTATION,t)},mxResources.get("enterValue")+" ("+mxResources.get("rotation")+" 0-360)");e.showDialog(l.container,300,80,!0,!0),l.init()}),this.addAction("resetView",function(){i.zoomTo(1),e.resetScrollbars()},null,null,"Ctrl+H"),this.addAction("zoomIn",function(t){i.zoomIn()},null,null,"Ctrl + / Alt+Mousewheel"),this.addAction("zoomOut",function(t){i.zoomOut()},null,null,"Ctrl - / Alt+Mousewheel"),this.addAction("fitWindow",function(){i.fit()},null,null,"Ctrl+Shift+H"),this.addAction("fitPage",mxUtils.bind(this,function(){i.pageVisible||this.get("pageView").funct();var t=i.pageFormat,e=i.pageScale,n=i.container.clientWidth-10,l=i.container.clientHeight-10,o=Math.floor(20*Math.min(n/t.width/e,l/t.height/e))/20;if(i.zoomTo(o),mxUtils.hasScrollbars(i.container)){var s=i.getPagePadding();i.container.scrollTop=s.y*i.view.scale,i.container.scrollLeft=Math.min(s.x*i.view.scale,(i.container.scrollWidth-i.container.clientWidth)/2)}}),null,null,"Ctrl+J"),this.addAction("fitTwoPages",mxUtils.bind(this,function(){i.pageVisible||this.get("pageView").funct();var t=i.pageFormat,e=i.pageScale,n=i.container.clientWidth-10,l=i.container.clientHeight-10,o=Math.floor(20*Math.min(n/(2*t.width)/e,l/t.height/e))/20;if(i.zoomTo(o),mxUtils.hasScrollbars(i.container)){var s=i.getPagePadding();i.container.scrollTop=Math.min(s.y,(i.container.scrollHeight-i.container.clientHeight)/2),i.container.scrollLeft=Math.min(s.x,(i.container.scrollWidth-i.container.clientWidth)/2)}}),null,null,"Ctrl+Shift+J"),this.addAction("fitPageWidth",mxUtils.bind(this,function(){i.pageVisible||this.get("pageView").funct();var t=i.pageFormat,e=i.pageScale,n=i.container.clientWidth-10,l=Math.floor(20*n/t.width/e)/20;if(i.zoomTo(l),mxUtils.hasScrollbars(i.container)){var o=i.getPagePadding();i.container.scrollLeft=Math.min(o.x*i.view.scale,(i.container.scrollWidth-i.container.clientWidth)/2)}})),this.put("customZoom",new l(mxResources.get("custom")+"...",mxUtils.bind(this,function(){var t=new FilenameDialog(this.editorUi,parseInt(100*i.getView().getScale()),mxResources.get("apply"),mxUtils.bind(this,function(t){var e=parseInt(t);!isNaN(e)&&e>0&&i.zoomTo(e/100)}),mxResources.get("zoom")+" (%)");this.editorUi.showDialog(t.container,300,80,!0,!0),t.init()}),null,null,"Ctrl+0")),this.addAction("pageScale...",mxUtils.bind(this,function(){var t=new FilenameDialog(this.editorUi,parseInt(100*i.pageScale),mxResources.get("apply"),mxUtils.bind(this,function(t){var n=parseInt(t);!isNaN(n)&&n>0&&e.setPageScale(n/100)}),mxResources.get("pageScale")+" (%)");this.editorUi.showDialog(t.container,300,80,!0,!0),t.init()}));var d=null;d=this.addAction("grid",function(){i.setGridEnabled(!i.isGridEnabled()),e.fireEvent(new mxEventObject("gridEnabledChanged"))},null,null,"Ctrl+Shift+G"),d.setToggleAction(!0),d.setSelectedCallback(function(){return i.isGridEnabled()}),d.setEnabled(!1),d=this.addAction("guides",function(){i.graphHandler.guidesEnabled=!i.graphHandler.guidesEnabled,e.fireEvent(new mxEventObject("guidesEnabledChanged"))}),d.setToggleAction(!0),d.setSelectedCallback(function(){return i.graphHandler.guidesEnabled}),d.setEnabled(!1),d=this.addAction("tooltips",function(){i.tooltipHandler.setEnabled(!i.tooltipHandler.isEnabled())}),d.setToggleAction(!0),d.setSelectedCallback(function(){return i.tooltipHandler.isEnabled()}),d=this.addAction("collapseExpand",function(){e.setFoldingEnabled(!i.foldingEnabled)}),d.setToggleAction(!0),d.setSelectedCallback(function(){return i.foldingEnabled}),d.isEnabled=a,d=this.addAction("scrollbars",function(){e.setScrollbars(!e.hasScrollbars())}),d.setToggleAction(!0),d.setSelectedCallback(function(){return i.scrollbars}),d=this.addAction("pageView",mxUtils.bind(this,function(){e.setPageVisible(!i.pageVisible)})),d.setToggleAction(!0),d.setSelectedCallback(function(){return i.pageVisible}),this.put("pageBackgroundColor",new l(mxResources.get("backgroundColor")+"...",function(){e.pickColor(i.background||"none",function(t){e.setBackgroundColor(t)})})),d=this.addAction("connectionArrows",function(){i.connectionArrowsEnabled=!i.connectionArrowsEnabled,e.fireEvent(new mxEventObject("connectionArrowsChanged"))},null,null,"Ctrl+Q"),d.setToggleAction(!0),d.setSelectedCallback(function(){return i.connectionArrowsEnabled}),d=this.addAction("connectionPoints",function(){i.setConnectable(!i.connectionHandler.isEnabled()),e.fireEvent(new mxEventObject("connectionPointsChanged"))},null,null,"Ctrl+Shift+Q"),d.setToggleAction(!0),d.setSelectedCallback(function(){return i.connectionHandler.isEnabled()}),d=this.addAction("copyConnect",function(){i.connectionHandler.setCreateTarget(!i.connectionHandler.isCreateTarget()),e.fireEvent(new mxEventObject("copyConnectChanged"))}),d.setToggleAction(!0),d.setSelectedCallback(function(){return i.connectionHandler.isCreateTarget()}),d.isEnabled=a,d=this.addAction("autosave",function(){e.editor.setAutosave(!e.editor.autosave)}),d.setToggleAction(!0),d.setSelectedCallback(function(){return e.editor.autosave}),d.isEnabled=a,d.visible=!1,this.addAction("help",function(){var t="";mxResources.isLanguageSupported(mxClient.language)&&(t="_"+mxClient.language),window.open(RESOURCES_PATH+"/help"+t+".html")}),this.put("about",new l(mxResources.get("about")+" Graph Editor...",function(){e.showDialog(new AboutDialog(e).container,320,280,!0,!0)},null,null,"F1"));var u=mxUtils.bind(this,function(t,e,n,l){return this.addAction(t,function(){null!=n&&i.cellEditor.isContentEditing()?n():(i.stopEditing(!1),i.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,e))},null,null,l)});u("bold",mxConstants.FONT_BOLD,function(){document.execCommand("bold",!1,null)},"Ctrl+B"),u("italic",mxConstants.FONT_ITALIC,function(){document.execCommand("italic",!1,null)},"Ctrl+I"),u("underline",mxConstants.FONT_UNDERLINE,function(){document.execCommand("underline",!1,null)},"Ctrl+U"),this.addAction("fontColor...",function(){e.menus.pickColor(mxConstants.STYLE_FONTCOLOR,"forecolor","000000")}),this.addAction("strokeColor...",function(){e.menus.pickColor(mxConstants.STYLE_STROKECOLOR)}),this.addAction("fillColor...",function(){e.menus.pickColor(mxConstants.STYLE_FILLCOLOR)}),this.addAction("gradientColor...",function(){e.menus.pickColor(mxConstants.STYLE_GRADIENTCOLOR)}),this.addAction("backgroundColor...",function(){e.menus.pickColor(mxConstants.STYLE_LABEL_BACKGROUNDCOLOR,"backcolor")}),this.addAction("borderColor...",function(){e.menus.pickColor(mxConstants.STYLE_LABEL_BORDERCOLOR)}),this.addAction("vertical",function(){e.menus.toggleStyle(mxConstants.STYLE_HORIZONTAL,!0)}),this.addAction("shadow",function(){e.menus.toggleStyle(mxConstants.STYLE_SHADOW)}),this.addAction("solid",function(){i.getModel().beginUpdate();try{i.setCellStyles(mxConstants.STYLE_DASHED,null),i.setCellStyles(mxConstants.STYLE_DASH_PATTERN,null),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",[null,null],"cells",i.getSelectionCells()))}finally{i.getModel().endUpdate()}}),this.addAction("dashed",function(){i.getModel().beginUpdate();try{i.setCellStyles(mxConstants.STYLE_DASHED,"1"),i.setCellStyles(mxConstants.STYLE_DASH_PATTERN,null),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",["1",null],"cells",i.getSelectionCells()))}finally{i.getModel().endUpdate()}}),this.addAction("dotted",function(){i.getModel().beginUpdate();try{i.setCellStyles(mxConstants.STYLE_DASHED,"1"),i.setCellStyles(mxConstants.STYLE_DASH_PATTERN,"1 4"),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",["1","1 4"],"cells",i.getSelectionCells()))}finally{i.getModel().endUpdate()}}),this.addAction("sharp",function(){i.getModel().beginUpdate();try{i.setCellStyles(mxConstants.STYLE_ROUNDED,"0"),i.setCellStyles(mxConstants.STYLE_CURVED,"0"),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["0","0"],"cells",i.getSelectionCells()))}finally{i.getModel().endUpdate()}}),this.addAction("rounded",function(){i.getModel().beginUpdate();try{i.setCellStyles(mxConstants.STYLE_ROUNDED,"1"),i.setCellStyles(mxConstants.STYLE_CURVED,"0"),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["1","0"],"cells",i.getSelectionCells()))}finally{i.getModel().endUpdate()}}),this.addAction("toggleRounded",function(){if(!i.isSelectionEmpty()&&i.isEnabled()){i.getModel().beginUpdate();try{var t=i.getSelectionCells(),n=i.view.getState(t[0]),l=null!=n?n.style:i.getCellStyle(t[0]),o="1"==mxUtils.getValue(l,mxConstants.STYLE_ROUNDED,"0")?"0":"1";i.setCellStyles(mxConstants.STYLE_ROUNDED,o),i.setCellStyles(mxConstants.STYLE_CURVED,null),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",[o,"0"],"cells",i.getSelectionCells()))}finally{i.getModel().endUpdate()}}}),this.addAction("curved",function(){i.getModel().beginUpdate();try{i.setCellStyles(mxConstants.STYLE_ROUNDED,"0"),i.setCellStyles(mxConstants.STYLE_CURVED,"1"),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["0","1"],"cells",i.getSelectionCells()))}finally{i.getModel().endUpdate()}}),this.addAction("collapsible",function(){var t=i.view.getState(i.getSelectionCell()),n="1";null!=t&&null!=i.getFoldingImage(t)&&(n="0"),i.setCellStyles("collapsible",n),e.fireEvent(new mxEventObject("styleChanged","keys",["collapsible"],"values",[n],"cells",i.getSelectionCells()))}),this.addAction("editStyle...",mxUtils.bind(this,function(){var t=i.getSelectionCells();if(null!=t&&t.length>0){var e=i.getModel(),n=new TextareaDialog(this.editorUi,mxResources.get("editStyle")+":",e.getStyle(t[0])||"",function(e){null!=e&&i.setCellStyle(mxUtils.trim(e),t)},null,null,400,220);this.editorUi.showDialog(n.container,420,300,!0,!0),n.init()}}),null,null,"Ctrl+E"),this.addAction("setAsDefaultStyle",function(){i.isEnabled()&&!i.isSelectionEmpty()&&e.setDefaultStyle(i.getSelectionCell())},null,null,"Ctrl+Shift+D"),this.addAction("clearDefaultStyle",function(){i.isEnabled()&&e.clearDefaultStyle()},null,null,"Ctrl+Shift+R"),this.addAction("addWaypoint",function(){var t=i.getSelectionCell();if(null!=t&&i.getModel().isEdge(t)){var e=n.graph.selectionCellsHandler.getHandler(t);if(e instanceof mxEdgeHandler){for(var l=i.view.translate,o=i.view.scale,s=l.x,r=l.y,a=i.getModel().getParent(t),d=i.getCellGeometry(a);i.getModel().isVertex(a)&&null!=d;)s+=d.x,r+=d.y,a=i.getModel().getParent(a),d=i.getCellGeometry(a);var u=Math.round(i.snap(i.popupMenuHandler.triggerX/o-s)),c=Math.round(i.snap(i.popupMenuHandler.triggerY/o-r));e.addPointAt(e.state,u,c)}}}),this.addAction("removeWaypoint",function(){var t=e.actions.get("removeWaypoint");null!=t.handler&&t.handler.removePoint(t.handler.state,t.index)}),this.addAction("clearWaypoints",function(){var t=i.getSelectionCells();if(null!=t){i.getModel().beginUpdate();try{for(var e=0;e<t.length;e++){var n=t[e];if(i.getModel().isEdge(n)){var l=i.getCellGeometry(n);null!=l&&(l=l.clone(),l.points=null,i.getModel().setGeometry(n,l))}}}finally{i.getModel().endUpdate()}}}),d=this.addAction("subscript",mxUtils.bind(this,function(){i.cellEditor.isContentEditing()&&document.execCommand("subscript",!1,null)}),null,null,"Ctrl+,"),d=this.addAction("superscript",mxUtils.bind(this,function(){i.cellEditor.isContentEditing()&&document.execCommand("superscript",!1,null)}),null,null,"Ctrl+."),this.addAction("image...",function(){if(i.isEnabled()&&!i.isCellLocked(i.getDefaultParent())){var t=mxResources.get("image")+" ("+mxResources.get("url")+"):",n=i.getView().getState(i.getSelectionCell()),l="";null!=n&&(l=n.style[mxConstants.STYLE_IMAGE]||l);var o=i.cellEditor.saveSelection();e.showImageDialog(t,l,function(t,e,n){if(i.cellEditor.isContentEditing())i.cellEditor.restoreSelection(o),i.insertImage(t,e,n);else{var l=i.getSelectionCells();if(null!=t){var s=null;i.getModel().beginUpdate();try{if(0==l.length){var r=i.getFreeInsertPoint();l=[i.insertVertex(i.getDefaultParent(),null,"",r.x,r.y,e,n,"shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;")],s=l}i.setCellStyles(mxConstants.STYLE_IMAGE,t,l);var a=i.view.getState(l[0]),d=null!=a?a.style:i.getCellStyle(l[0]);if("image"!=d[mxConstants.STYLE_SHAPE]&&"label"!=d[mxConstants.STYLE_SHAPE]&&i.setCellStyles(mxConstants.STYLE_SHAPE,"image",l),1==i.getSelectionCount()&&null!=e&&null!=n){var u=l[0],c=i.getModel().getGeometry(u);null!=c&&(c=c.clone(),c.width=e,c.height=n,i.getModel().setGeometry(u,c))}}finally{i.getModel().endUpdate()}null!=s&&(i.setSelectionCells(s),i.scrollCellToVisible(s[0]))}}},i.cellEditor.isContentEditing(),!i.cellEditor.isContentEditing())}}).isEnabled=a,this.addAction("insertImage...",function(){i.isEnabled()&&!i.isCellLocked(i.getDefaultParent())&&(i.clearSelection(),e.actions.get("image").funct())}).isEnabled=a,d=this.addAction("layers",mxUtils.bind(this,function(){null==this.layersWindow?(this.layersWindow=new LayersWindow(e,document.body.offsetWidth-280,120,220,180),this.layersWindow.window.addListener("show",function(){e.fireEvent(new mxEventObject("layers"))}),this.layersWindow.window.addListener("hide",function(){e.fireEvent(new mxEventObject("layers"))}),this.layersWindow.window.setVisible(!0),e.fireEvent(new mxEventObject("layers"))):this.layersWindow.window.setVisible(!this.layersWindow.window.isVisible())}),null,null,"Ctrl+Shift+L"),d.setToggleAction(!0),d.setSelectedCallback(mxUtils.bind(this,function(){return null!=this.layersWindow&&this.layersWindow.window.isVisible()})),d=this.addAction("formatPanel",mxUtils.bind(this,function(){e.toggleFormatPanel()}),null,null,"Ctrl+Shift+P"),d.setToggleAction(!0),d.setSelectedCallback(mxUtils.bind(this,function(){return e.formatWidth>0})),d=this.addAction("outline",mxUtils.bind(this,function(){null==this.outlineWindow?(this.outlineWindow=new OutlineWindow(e,document.body.offsetWidth-260,100,180,180),this.outlineWindow.window.addListener("show",function(){e.fireEvent(new mxEventObject("outline"))}),this.outlineWindow.window.addListener("hide",function(){e.fireEvent(new mxEventObject("outline"))}),this.outlineWindow.window.setVisible(!0),e.fireEvent(new mxEventObject("outline"))):this.outlineWindow.window.setVisible(!this.outlineWindow.window.isVisible()),e.fireEvent(new mxEventObject("outline"))}),null,null,"Ctrl+Shift+O"),d.setToggleAction(!0),d.setSelectedCallback(mxUtils.bind(this,function(){return null!=this.outlineWindow&&this.outlineWindow.window.isVisible()}))},i.prototype.addAction=function(t,e,n,i,o){var s;return"..."==t.substring(t.length-3)?(t=t.substring(0,t.length-3),s=mxResources.get(t)+"..."):s=mxResources.get(t),this.put(t,new l(s,e,n,i,o))},i.prototype.put=function(t,e){return this.actions[t]=e,e},i.prototype.get=function(t){return this.actions[t]},mxUtils.extend(l,mxEventSource),l.prototype.setEnabled=function(t){this.enabled!=t&&(this.enabled=t,this.fireEvent(new mxEventObject("stateChanged")))},l.prototype.isEnabled=function(){return this.enabled},l.prototype.setToggleAction=function(t){this.toggleAction=t},l.prototype.setSelectedCallback=function(t){this.selectedCallback=t},l.prototype.isSelected=function(){return this.selectedCallback()},t.exports=i},function(t,e,n){"use strict";var i=function(t,e){if(e||null==t.editor.filename){var n=new FilenameDialog(t,t.editor.getOrCreateFilename(),mxResources.get("save"),mxUtils.bind(t,function(e){l(t,e)}),null,mxUtils.bind(t,function(t){return null!=t&&t.length>0||(mxUtils.confirm(mxResources.get("invalidName")),!1)}));t.showDialog(n.container,300,100,!0,!0),n.init()}else t.save(t.editor.getOrCreateFilename())},l=function(t,e){if(null!=e){t.editor.graph.isEditing()&&t.editor.graph.stopEditing();var n=mxUtils.getXml(t.editor.getGraphXml()),i=null;try{if(Editor.useFileSystemSave){var l=new Blob([n],{type:"text/plain"});null!==i&&window.URL.revokeObjectURL(i),i=window.URL.createObjectURL(l);var o=document.createElement("a");return void("string"==typeof o.download?(document.body.appendChild(o),o.download=e,o.href=i,o.click(),document.body.removeChild(o)):location.replace(uri))}if(Editor.useLocalStorage){if(null!=localStorage.getItem(e)&&!mxUtils.confirm(mxResources.get("replaceIt",[e])))return;localStorage.setItem(e,n),t.editor.setStatus(mxResources.get("saved")+" "+new Date)}else{if(!(n.length<MAX_REQUEST_SIZE))return mxUtils.alert(mxResources.get("drawingTooLarge")),void mxUtils.popup(n);new mxXmlRequest(SAVE_URL,"filename="+encodeURIComponent(e)+"&xml="+encodeURIComponent(n)).simulate(document,"_blank")}t.editor.setModified(!1),t.editor.setFilename(e),t.updateDocumentTitle()}catch(e){t.editor.setStatus("Error saving file")}}};t.exports=i},function(t,e,n){"use strict";var i=function t(e){function n(){var t=p.value,e=t.lastIndexOf(".");p.value=e>0?t.substring(0,e+1)+m.value:t+"."+m.value,"xml"===m.value?(E.setAttribute("disabled","true"),v.setAttribute("disabled","true"),b.setAttribute("disabled","true"),T.setAttribute("disabled","true")):(E.removeAttribute("disabled"),v.removeAttribute("disabled"),b.removeAttribute("disabled"),T.removeAttribute("disabled")),"png"===m.value||"svg"===m.value?w.removeAttribute("disabled"):w.setAttribute("disabled","disabled")}function i(){v.value*b.value>MAX_AREA||v.value<=0?v.style.backgroundColor="red":v.style.backgroundColor="",v.value*b.value>MAX_AREA||b.value<=0?b.style.backgroundColor="red":b.style.backgroundColor=""}var l,o,s=e.editor.graph,r=s.getGraphBounds(),a=s.view.scale,d=Math.ceil(r.width/a),u=Math.ceil(r.height/a),c=document.createElement("table"),h=document.createElement("tbody");c.setAttribute("cellpadding",mxClient.IS_SF?"0":"2"),l=document.createElement("tr"),o=document.createElement("td"),o.style.fontSize="10pt",o.style.width="100px",mxUtils.write(o,mxResources.get("filename")+":"),l.appendChild(o);var p=document.createElement("input");p.setAttribute("value",e.editor.getOrCreateFilename()),p.style.width="180px",o=document.createElement("td"),o.appendChild(p),l.appendChild(o),h.appendChild(l),l=document.createElement("tr"),o=document.createElement("td"),o.style.fontSize="10pt",mxUtils.write(o,mxResources.get("format")+":"),l.appendChild(o);var m=document.createElement("select");m.style.width="180px";var g=document.createElement("option");g.setAttribute("value","png"),mxUtils.write(g,mxResources.get("formatPng")),m.appendChild(g);var x=document.createElement("option");t.showGifOption&&(x.setAttribute("value","gif"),mxUtils.write(x,mxResources.get("formatGif")),m.appendChild(x));var y=document.createElement("option");y.setAttribute("value","jpg"),mxUtils.write(y,mxResources.get("formatJpg")),m.appendChild(y);var f=document.createElement("option");f.setAttribute("value","pdf"),mxUtils.write(f,mxResources.get("formatPdf")),m.appendChild(f);var C=document.createElement("option");if(C.setAttribute("value","svg"),mxUtils.write(C,mxResources.get("formatSvg")),m.appendChild(C),t.showXmlOption){var S=document.createElement("option");S.setAttribute("value","xml"),mxUtils.write(S,mxResources.get("formatXml")),m.appendChild(S)}o=document.createElement("td"),o.appendChild(m),l.appendChild(o),h.appendChild(l),l=document.createElement("tr"),o=document.createElement("td"),o.style.fontSize="10pt",mxUtils.write(o,mxResources.get("zoom")+" (%):"),l.appendChild(o);var E=document.createElement("input");E.setAttribute("type","number"),E.setAttribute("value","100"),E.style.width="180px",o=document.createElement("td"),o.appendChild(E),l.appendChild(o),h.appendChild(l),l=document.createElement("tr"),o=document.createElement("td"),o.style.fontSize="10pt",mxUtils.write(o,mxResources.get("width")+":"),l.appendChild(o);var v=document.createElement("input");v.setAttribute("value",d),v.style.width="180px",o=document.createElement("td"),o.appendChild(v),l.appendChild(o),h.appendChild(l),l=document.createElement("tr"),o=document.createElement("td"),o.style.fontSize="10pt",mxUtils.write(o,mxResources.get("height")+":"),l.appendChild(o);var b=document.createElement("input");b.setAttribute("value",u),b.style.width="180px",o=document.createElement("td"),o.appendChild(b),l.appendChild(o),h.appendChild(l),l=document.createElement("tr"),o=document.createElement("td"),o.style.fontSize="10pt",mxUtils.write(o,mxResources.get("background")+":"),l.appendChild(o);var w=document.createElement("input");w.setAttribute("type","checkbox"),w.checked=null==s.background||s.background==mxConstants.NONE,o=document.createElement("td"),o.appendChild(w),mxUtils.write(o,mxResources.get("transparent")),l.appendChild(o),h.appendChild(l),l=document.createElement("tr"),o=document.createElement("td"),o.style.fontSize="10pt",mxUtils.write(o,mxResources.get("borderWidth")+":"),l.appendChild(o);var T=document.createElement("input");T.setAttribute("type","number"),T.setAttribute("value",t.lastBorderValue),T.style.width="180px",o=document.createElement("td"),o.appendChild(T),l.appendChild(o),h.appendChild(l),c.appendChild(h),mxEvent.addListener(m,"change",n),n(),mxEvent.addListener(E,"change",function(){var t=Math.max(0,parseFloat(E.value)||100)/100;E.value=parseFloat((100*t).toFixed(2)),d>0?(v.value=Math.floor(d*t),b.value=Math.floor(u*t)):(E.value="100",v.value=d,b.value=u),i()}),mxEvent.addListener(v,"change",function(){var t=parseInt(v.value)/d;t>0?(E.value=parseFloat((100*t).toFixed(2)),b.value=Math.floor(u*t)):(E.value="100",v.value=d,b.value=u),i()}),mxEvent.addListener(b,"change",function(){var t=parseInt(b.value)/u;t>0?(E.value=parseFloat((100*t).toFixed(2)),v.value=Math.floor(d*t)):(E.value="100",v.value=d,b.value=u),i()}),l=document.createElement("tr"),o=document.createElement("td"),o.setAttribute("align","right"),o.style.paddingTop="22px",o.colSpan=2;var A=mxUtils.button(mxResources.get("export"),mxUtils.bind(this,function(){if(parseInt(E.value)<=0)mxUtils.alert(mxResources.get("drawingEmpty"));else{var n=p.value,i=m.value,l=Math.max(0,parseFloat(E.value)||100)/100,o=Math.max(0,parseInt(T.value)),r=s.background;"svg"!=i&&"png"!=i||!w.checked?null!=r&&r!=mxConstants.NONE||(r="#ffffff"):r=null,t.lastBorderValue=o,t.exportFile(e,n,i,r,l,o)}}));A.className="geBtn gePrimaryBtn";var R=mxUtils.button(mxResources.get("cancel"),function(){e.hideDialog()});R.className="geBtn",e.editor.cancelFirst?(o.appendChild(R),o.appendChild(A)):(o.appendChild(A),o.appendChild(R)),l.appendChild(o),h.appendChild(l),c.appendChild(h),this.container=c};i.lastBorderValue=0,i.showGifOption=!0,i.showXmlOption=!0,i.exportFile=function(t,e,n,l,o,s){var r=t.editor.graph;if("xml"==n)i.saveLocalFile(t,mxUtils.getXml(t.editor.getGraphXml()),e,n);else if("svg"==n)i.saveLocalFile(t,mxUtils.getXml(r.getSvg(l,o,s)),e,n);else if("png"==n){var a=function(t){var n=new MouseEvent("click",{view:window,bubbles:!1,cancelable:!0}),i=document.createElement("a");i.setAttribute("download",e),i.setAttribute("href",t),i.setAttribute("target","_blank"),i.dispatchEvent(n)},d=mxUtils.getXml(r.getSvg(l,o,s)),u=document.createElement("canvas"),c=u.getContext("2d"),h=window.URL||window.webkitURL||window,p=new Image,m="data:image/svg+xml;charset=utf-8,"+d;p.onload=function(){u.width=p.width,u.height=p.height,c.drawImage(p,0,0);var t=u.toDataURL("image/png");h.revokeObjectURL(t),a(t)},p.src=m}else{var g=r.getGraphBounds(),x=mxUtils.createXmlDocument(),y=x.createElement("output");x.appendChild(y);var f=new mxXmlCanvas2D(y);f.translate(Math.floor((s/o-g.x)/r.view.scale),Math.floor((s/o-g.y)/r.view.scale)),f.scale(o/r.view.scale);var C=new mxImageExport;C.drawState(r.getView().getState(r.model.root),f);encodeURIComponent(mxUtils.getXml(y)),Math.ceil(g.width*o/r.view.scale+2*s),Math.ceil(g.height*o/r.view.scale+2*s)}},t.exports=i},function(t,e,n){"use strict";var i=n(10),l=function(t){function e(){var t=u.value,e=t.lastIndexOf(".");u.value=e>0?t.substring(0,e+1)+c.value:t+"."+c.value}var n,l,o=t.editor.graph,s=o.getGraphBounds(),r=o.view.scale,a=(Math.ceil(s.width/r),Math.ceil(s.height/r),document.createElement("table")),d=document.createElement("tbody");a.setAttribute("cellpadding",mxClient.IS_SF?"0":"2"),n=document.createElement("tr"),l=document.createElement("td"),l.style.fontSize="10pt",l.style.width="100px",mxUtils.write(l,mxResources.get("filename")+":"),n.appendChild(l);var u=document.createElement("input");u.setAttribute("value",t.editor.getOrCreateFilename()),u.style.width="180px",l=document.createElement("td"),l.appendChild(u),n.appendChild(l),d.appendChild(n),n=document.createElement("tr"),l=document.createElement("td"),l.style.fontSize="10pt",mxUtils.write(l,mxResources.get("language")+":"),n.appendChild(l);var c=document.createElement("select");c.style.width="180px";var h=document.createElement("option");h.setAttribute("value","java"),mxUtils.write(h,mxResources.get("languageJava")),c.appendChild(h),l=document.createElement("td"),l.appendChild(c),n.appendChild(l),d.appendChild(n),a.appendChild(d),n=document.createElement("tr"),l=document.createElement("td"),l.setAttribute("align","right"),l.style.paddingTop="22px",l.colSpan=2;var p=mxUtils.button(mxResources.get("generate"),mxUtils.bind(this,function(){var e=u.value,n=c.value;new i(t,e,n).createGenerator().generateAndSave()}));p.className="geBtn gePrimaryBtn";var m=mxUtils.button(mxResources.get("cancel"),function(){t.hideDialog()});m.className="geBtn",t.editor.cancelFirst?(l.appendChild(m),l.appendChild(p)):(l.appendChild(p),l.appendChild(m)),n.appendChild(l),d.appendChild(n),a.appendChild(d),this.container=a,mxEvent.addListener(c,"change",e),e()};l.lastBorderValue=0,t.exports=l},function(t,e,n){"use strict";var i=n(11),l=function(t,e,n){this.editorUi=t,this.fileName=e,this.language=n};l.prototype.createGenerator=function(){if("java"===this.language)return new i(this.editorUi,this.fileName)},t.exports=l},function(t,e,n){"use strict";var i=n(12),l=function(t,e){i.call(this,t,e)};l.prototype=new i,l.prototype.generateCode=function(t){var e=t,n="";for(var i in e)e.hasOwnProperty(i)&&(n+=this.generateStringFromClassElement(e[i]));return n};var o=function(t,e,n,i,l){this.className=t,this.attributesStr=e,this.methodsStr=n,this.extendsStr=i,this.implementsStr=l,this.generate=function(){return"class "+this.className+this.extendsStr+this.implementsStr+" {\n"+this.attributesStr+"\n"+this.methodsStr+"\n}\n\n"}},s=function(t,e,n){this.interfaceName=t,this.attributesStr=e,this.methodsStr=n,this.generate=function(){return"interface "+this.interfaceName+" {\n"+this.attributesStr+"\n"+this.methodsStr+"\n}\n\n"}},r=function(t){var e=l.prototype.generateStringAttribute(t),n=l.prototype.generateStringMethod(t),i=l.prototype.generateStringExtends(t),r=l.prototype.generateStringImplements(t);if("class"===t.type){var a=t.className;return new o(a,e,n,i,r)}if("interface"===t.type){var d=t.interfaceName;return new s(d,e,n)}};l.prototype.generateStringFromClassElement=function(t){this.generateStringAttribute(t),this.generateStringMethod(t);return r(t).generate()},l.prototype.generateStringAttributeTemplate=function(t,e){return"    "+t+" "+e.type+" "+e.attributeName+";\n"},l.prototype.generateStringAttribute=function(t){for(var e="",n=0;n<t.privateAttributes.length;n++){var i=t.privateAttributes[n];e+=this.generateStringAttributeTemplate("private",i)}for(var n=0;n<t.publicAttributes.length;n++){var i=t.publicAttributes[n];e+=this.generateStringAttributeTemplate("public",i)}for(var n=0;n<t.protectedAttributes.length;n++){var i=t.protectedAttributes[n];e+=this.generateStringAttributeTemplate("protected",i)}return e},l.prototype.generateMethodTemplate=function(t,e){return"    "+t+" "+e.returnType+" "+e.methodName+" {\n      /* insert code here */\n    }\n\n"},l.prototype.generateStringMethod=function(t){for(var e="",n=0;n<t.privateMethods.length;n++){var i=t.privateMethods[n];e+=this.generateMethodTemplate("private",i)}for(var n=0;n<t.publicMethods.length;n++){var i=t.publicMethods[n];e+=this.generateMethodTemplate("public",i)}for(var n=0;n<t.protectedMethods.length;n++){var i=t.protectedMethods[n];e+=this.generateMethodTemplate("protected",i)}return e},l.prototype.generateStringImplements=function(t){var e=t.implements;if(e.length){return" implements "+e.join(", ").trim()}return""},l.prototype.generateStringExtends=function(t){var e=t.extends;if(e.length){return" extends "+e[0]}return""},t.exports=l},function(t,e,n){"use strict";var i=n(13),l=function(t,e){this.editorUi=t,this.fileName=e,this.classAndInterfaceLists={}};l.prototype.generateAndSave=function(){var t=this.editorUi,e=t.editor,n=this.fileName,l=mxUtils.getXml(e.getGraphXml()),o=this.xmlStringToXml(l),s=new i;this.classAndInterfaceLists=s.parseXmlToclassAndInterfaceList(o);var r=this.generateCode(this.classAndInterfaceLists);r&&(this.saveCode(n,r),t.hideDialog())},l.prototype.generateCode=function(){throw"Not implemented yet!"},l.prototype.saveCode=function(t,e){var n=new Blob([e],{type:"text/plain"});null!==e&&window.URL.revokeObjectURL(e),e=window.URL.createObjectURL(n);var i=document.createElement("a");"string"==typeof i.download?(document.body.appendChild(i),i.download=t,i.href=e,i.click(),document.body.removeChild(i)):location.replace(uri)},l.prototype.xmlStringToXml=function(t){return(window.DOMParser?function(t){return(new window.DOMParser).parseFromString(t,"text/xml")}:void 0!==window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM")?function(t){var e=new window.ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e}:function(){return null})(t)},t.exports=l},function(t,e,n){"use strict";var i=n(14),l=i.ClassOrInterfaceStrategy,o=i.AttributeStrategy,s=i.MethodStrategy,r=i.GeneralizationStrategy,a=function(){this.elements={},this.classAndInterfaceLists={},this.generalizationList=[]};a.prototype.parseXmlToclassAndInterfaceList=function(t){for(var e=this,n=t.getElementsByTagName("mxCell"),i=2;i<n.length;i++){var l=n[i],o=e.getComponentNameFromCell(l);o&&(this.doAction(l,o),this.elements[i]=l)}this.generalizationList=this.generalizationList.map(function(t){return{source:e.getAttributeOrMethodParent(t.source),target:e.getAttributeOrMethodParent(t.target)}});for(i in this.generalizationList){var s=this.generalizationList[i],r=this.elements[s.target],a=r.getAttribute("id"),d=this.getComponentNameFromCell(r);if("class"===d){var u=this.classAndInterfaceLists[a].className;this.classAndInterfaceLists[s.source].extends.push(u)}else if("interface"===d){var c=this.classAndInterfaceLists[a].interfaceName;this.classAndInterfaceLists[s.source].implements.push(c)}}return this.classAndInterfaceLists},a.prototype.doAction=function(t,e){var n=this;({handleRequest:function(t,e,n){var i=new l,a=new o,d=new s,u=new r;i.setNext(a).setNext(d).setNext(u),i.handleRequest(t,e,n)}}).handleRequest(n,t,e)},a.prototype.generateAndPushClassOrInterfaceElement=function(t,e){var n={privateAttributes:[],publicAttributes:[],protectedAttributes:[],privateMethods:[],publicMethods:[],protectedMethods:[],implements:[],extends:[]},i=t.getAttribute("id");this.classAndInterfaceLists[i]=function(t,e){return"class"===e?Object.assign({type:"class",className:t.getAttribute("value")},n):"interface"===e?Object.assign({type:"interface",interfaceName:t.getAttribute("value").split(" ")[1]},n):void 0}(t,e)},a.prototype.pushAttribute=function(t){var e=t.getAttribute("value"),n=t.getAttribute("parent"),i=e.split(" "),l=i[0],o={attributeName:i[1].slice(0,-1),type:i[2]};"+"===l?this.classAndInterfaceLists[n].publicAttributes.push(o):"-"===l?this.classAndInterfaceLists[n].privateAttributes.push(o):"#"===l&&this.classAndInterfaceLists[n].protectedAttributes.push(o)},a.prototype.pushMethod=function(t){var e=t.getAttribute("value"),n=t.getAttribute("parent"),i=e.split(" "),l=i[0],o={methodName:i[1].slice(0,-1),returnType:i[2]};"+"===l?this.classAndInterfaceLists[n].publicMethods.push(o):"-"===l?this.classAndInterfaceLists[n].privateMethods.push(o):"#"===l&&this.classAndInterfaceLists[n].protectedMethods.push(o)},a.prototype.pushGeneralization=function(t){var e=t.getAttribute("source"),n=t.getAttribute("target");this.generalizationList.push({source:e,target:n})},a.prototype.getAttributeOrMethodParent=function(t){var e=this.elements[t],n=e.getAttribute("parent");return"1"===n?t:n},a.prototype.getComponentNameFromStyle=function(t){for(var e=t.split(";"),n=-1,i=0;i<e.length&&-1===n;i++)e[i].indexOf("componentName")>=0&&(n=i);var l=null;return n>=0&&(l=e[n].split("=")[1]),l},a.prototype.getComponentNameFromCell=function(t){var e=t.getAttribute("style");return this.getComponentNameFromStyle(e)},t.exports=a},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.GeneralizationStrategy=e.MethodStrategy=e.AttributeStrategy=e.ClassOrInterfaceStrategy=void 0;var l=n(15),o=i(l),s=n(16),r=i(s),a=n(17),d=i(a),u=n(18),c=i(u);e.ClassOrInterfaceStrategy=o.default,e.AttributeStrategy=r.default,e.MethodStrategy=d.default,e.GeneralizationStrategy=c.default},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),d=function(t){function e(){return i(this,e),l(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),s(e,[{key:"handleRequest",value:function(t,e,n){return"class"===n||"interface"===n?t.generateAndPushClassOrInterfaceElement(e,n):this.next.handleRequest(t,e,n)}}]),e}(a.default);e.default=d},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),d=function(t){function e(){return i(this,e),l(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),s(e,[{key:"handleRequest",value:function(t,e,n){return"attribute"===n?t.pushAttribute(e):this.next.handleRequest(t,e,n)}}]),e}(a.default);e.default=d},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),d=function(t){function e(){return i(this,e),l(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),s(e,[{key:"handleRequest",value:function(t,e,n){return"method"===n?t.pushMethod(e):this.next.handleRequest(t,e,n)}}]),e}(a.default);e.default=d},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),d=function(t){function e(){return i(this,e),l(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),s(e,[{key:"handleRequest",value:function(t,e,n){return"generalization"===n?t.pushGeneralization(e):this.next.handleRequest(t,e,n)}}]),e}(a.default);e.default=d},function(t,e,n){"use strict";function i(t,e){this.editorUi=t,this.container=e,this.staticElements=[],this.init(),this.gestureHandler=mxUtils.bind(this,function(t){null!=this.editorUi.currentMenu&&mxEvent.getSource(t)!=this.editorUi.currentMenu.div&&this.hideMenu()}),mxEvent.addGestureListeners(document,this.gestureHandler)}var l=n(1);i.prototype.dropdownImage=mxClient.IS_SVG?"data:image/gif;base64,R0lGODlhDQANAIABAHt7e////yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCREM1NkJFMjE0NEMxMUU1ODk1Q0M5MjQ0MTA4QjNDMSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCREM1NkJFMzE0NEMxMUU1ODk1Q0M5MjQ0MTA4QjNDMSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkQzOUMzMjZCMTQ0QjExRTU4OTVDQzkyNDQxMDhCM0MxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkQzOUMzMjZDMTQ0QjExRTU4OTVDQzkyNDQxMDhCM0MxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAQAsAAAAAA0ADQAAAhGMj6nL3QAjVHIu6azbvPtWAAA7":IMAGE_PATH+"/dropdown.gif",i.prototype.dropdownImageHtml='<img border="0" style="position:absolute;right:4px;top:'+(l.compactUi?6:8)+'px;" src="'+i.prototype.dropdownImage+'" valign="middle"/>',i.prototype.selectedBackground="#d0d0d0",i.prototype.unselectedBackground="none",i.prototype.staticElements=null,i.prototype.init=function(){var t=screen.width;if((t-=screen.height>740?56:0)>=700){var e=this.addMenu("",mxResources.get("view")+" ("+mxResources.get("panTooltip")+")",!0,"viewPanels",null,!0);this.addDropDownArrow(e,"geSprite-formatpanel",38,50,-4,-3,36,-8),this.addSeparator()}var n=this.addMenu("",mxResources.get("zoom")+" (Alt+Mousewheel)",!0,"viewZoom",null,!0);if(n.showDisabled=!0,n.style.whiteSpace="nowrap",n.style.position="relative",n.style.overflow="hidden",l.compactUi?n.style.width=mxClient.IS_QUIRKS?"58px":"50px":n.style.width=mxClient.IS_QUIRKS?"62px":"36px",t>=420){this.addSeparator();var i=this.addItems(["zoomIn","zoomOut"]);i[0].setAttribute("title",mxResources.get("zoomIn")+" ("+this.editorUi.actions.get("zoomIn").shortcut+")"),i[1].setAttribute("title",mxResources.get("zoomOut")+" ("+this.editorUi.actions.get("zoomOut").shortcut+")")}this.updateZoom=mxUtils.bind(this,function(){n.innerHTML=Math.round(100*this.editorUi.editor.graph.view.scale)+"%"+this.dropdownImageHtml,l.compactUi&&(n.getElementsByTagName("img")[0].style.right="1px",n.getElementsByTagName("img")[0].style.top="5px")}),this.editorUi.editor.graph.view.addListener(mxEvent.EVENT_SCALE,this.updateZoom),this.editorUi.editor.addListener("resetGraphView",this.updateZoom);var i=this.addItems(["-","undo","redo"]);if(i[1].setAttribute("title",mxResources.get("undo")+" ("+this.editorUi.actions.get("undo").shortcut+")"),i[2].setAttribute("title",mxResources.get("redo")+" ("+this.editorUi.actions.get("redo").shortcut+")"),t>=470){var i=this.addItems(["-","delete"]);i[1].setAttribute("title",mxResources.get("delete")+" ("+this.editorUi.actions.get("delete").shortcut+")")}t>=550&&this.addItems(["-","toFront","toBack"]),t>=640&&this.addItems(["-","fillColor","strokeColor","shadow"]),t>=320&&(this.addSeparator(),this.edgeShapeMenu=this.addMenuFunction("",mxResources.get("connection"),!1,mxUtils.bind(this,function(t){this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_SHAPE,"width"],[null,null],"geIcon geSprite geSprite-connection",null,!0).setAttribute("title",mxResources.get("line")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_SHAPE,"width"],["link",null],"geIcon geSprite geSprite-linkedge",null,!0).setAttribute("title",mxResources.get("link")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_SHAPE,"width"],["flexArrow",null],"geIcon geSprite geSprite-arrow",null,!0).setAttribute("title",mxResources.get("arrow")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_SHAPE,"width"],["arrow",null],"geIcon geSprite geSprite-simplearrow",null,!0).setAttribute("title",mxResources.get("simpleArrow"))})),this.addDropDownArrow(this.edgeShapeMenu,"geSprite-connection",44,50,0,0,22,-4),this.edgeStyleMenu=this.addMenuFunction("geSprite-orthogonal",mxResources.get("waypoints"),!1,mxUtils.bind(this,function(t){this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],[null,null,null],"geIcon geSprite geSprite-straight",null,!0).setAttribute("title",mxResources.get("straight")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle",null,null],"geIcon geSprite geSprite-orthogonal",null,!0).setAttribute("title",mxResources.get("orthogonal")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalelbow",null,!0).setAttribute("title",mxResources.get("simple")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalelbow",null,!0).setAttribute("title",mxResources.get("simple")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalisometric",null,!0).setAttribute("title",mxResources.get("isometric")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalisometric",null,!0).setAttribute("title",mxResources.get("isometric")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle","1",null],"geIcon geSprite geSprite-curved",null,!0).setAttribute("title",mxResources.get("curved")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["entityRelationEdgeStyle",null,null],"geIcon geSprite geSprite-entity",null,!0).setAttribute("title",mxResources.get("entityRelation"))})),this.addDropDownArrow(this.edgeStyleMenu,"geSprite-orthogonal",44,50,0,0,22,-4)),this.addSeparator();var o=this.addMenu("",mxResources.get("insert")+" ("+mxResources.get("doubleClickTooltip")+")",!0,"insert",null,!0);this.addDropDownArrow(o,"geSprite-plus",38,48,-4,-3,36,-8)},i.prototype.addDropDownArrow=function(t,e,n,i,o,s,r,a){r=null!=r?r:32,o=l.compactUi?o:a,t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.style.position="relative",t.innerHTML='<div class="geSprite '+e+'" style="margin-left:'+o+"px;margin-top:"+s+'px;"></div>'+this.dropdownImageHtml,t.style.width=mxClient.IS_QUIRKS?i+"px":i-r+"px",mxClient.IS_QUIRKS&&(t.style.height=l.compactUi?"24px":"26px"),l.compactUi&&(t.getElementsByTagName("img")[0].style.left="24px",t.getElementsByTagName("img")[0].style.top="5px",t.style.width=mxClient.IS_QUIRKS?n+"px":n-10+"px")},i.prototype.setFontName=function(t){null!=this.fontMenu&&(this.fontMenu.innerHTML='<div style="width:60px;overflow:hidden;display:inline-block;">'+mxUtils.htmlEntities(t)+"</div>"+this.dropdownImageHtml)},i.prototype.setFontSize=function(t){null!=this.sizeMenu&&(this.sizeMenu.innerHTML='<div style="width:24px;overflow:hidden;display:inline-block;">'+t+"</div>"+this.dropdownImageHtml)},i.prototype.createTextToolbar=function(){var t=this.editorUi.editor.graph,e=this.addMenu("",mxResources.get("style"),!0,"formatBlock");e.style.position="relative",e.style.whiteSpace="nowrap",e.style.overflow="hidden",e.innerHTML=mxResources.get("style")+this.dropdownImageHtml,l.compactUi&&(e.style.paddingRight="18px",e.getElementsByTagName("img")[0].style.right="1px",e.getElementsByTagName("img")[0].style.top="5px"),this.addSeparator(),this.fontMenu=this.addMenu("",mxResources.get("fontFamily"),!0,"fontFamily"),this.fontMenu.style.position="relative",this.fontMenu.style.whiteSpace="nowrap",this.fontMenu.style.overflow="hidden",this.fontMenu.style.width=mxClient.IS_QUIRKS?"80px":"60px",this.setFontName(Menus.prototype.defaultFont),l.compactUi&&(this.fontMenu.style.paddingRight="18px",this.fontMenu.getElementsByTagName("img")[0].style.right="1px",this.fontMenu.getElementsByTagName("img")[0].style.top="5px"),this.addSeparator(),this.sizeMenu=this.addMenu(Menus.prototype.defaultFontSize,mxResources.get("fontSize"),!0,"fontSize"),this.sizeMenu.style.position="relative",this.sizeMenu.style.whiteSpace="nowrap",this.sizeMenu.style.overflow="hidden",this.sizeMenu.style.width=mxClient.IS_QUIRKS?"44px":"24px",this.setFontSize(Menus.prototype.defaultFontSize),l.compactUi&&(this.sizeMenu.style.paddingRight="18px",this.sizeMenu.getElementsByTagName("img")[0].style.right="1px",this.sizeMenu.getElementsByTagName("img")[0].style.top="5px");var n=this.addItems(["-","undo","redo","-","bold","italic","underline"]);n[1].setAttribute("title",mxResources.get("undo")+" ("+this.editorUi.actions.get("undo").shortcut+")"),n[2].setAttribute("title",mxResources.get("redo")+" ("+this.editorUi.actions.get("redo").shortcut+")"),n[4].setAttribute("title",mxResources.get("bold")+" ("+this.editorUi.actions.get("bold").shortcut+")"),n[5].setAttribute("title",mxResources.get("italic")+" ("+this.editorUi.actions.get("italic").shortcut+")"),n[6].setAttribute("title",mxResources.get("underline")+" ("+this.editorUi.actions.get("underline").shortcut+")");var i=this.addMenuFunction("",mxResources.get("align"),!1,mxUtils.bind(this,function(t){r=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("justifyleft",!1,null)}),null,"geIcon geSprite geSprite-left"),r.setAttribute("title",mxResources.get("left")),r=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("justifycenter",!1,null)}),null,"geIcon geSprite geSprite-center"),r.setAttribute("title",mxResources.get("center")),r=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("justifyright",!1,null)}),null,"geIcon geSprite geSprite-right"),r.setAttribute("title",mxResources.get("right")),r=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("justifyfull",!1,null)}),null,"geIcon geSprite geSprite-justifyfull"),r.setAttribute("title",mxResources.get("justifyfull")),r=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("insertorderedlist",!1,null)}),null,"geIcon geSprite geSprite-orderedlist"),r.setAttribute("title",mxResources.get("numberedList")),r=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("insertunorderedlist",!1,null)}),null,"geIcon geSprite geSprite-unorderedlist"),r.setAttribute("title",mxResources.get("bulletedList")),r=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("outdent",!1,null)}),null,"geIcon geSprite geSprite-outdent"),r.setAttribute("title",mxResources.get("decreaseIndent")),r=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("indent",!1,null)}),null,"geIcon geSprite geSprite-indent"),r.setAttribute("title",mxResources.get("increaseIndent"))}));i.style.position="relative",i.style.whiteSpace="nowrap",i.style.overflow="hidden",i.innerHTML='<div class="geSprite geSprite-left" style="margin-left:-2px;"></div>'+this.dropdownImageHtml,i.style.width=mxClient.IS_QUIRKS?"50px":"30px",l.compactUi&&(i.getElementsByTagName("img")[0].style.left="22px",i.getElementsByTagName("img")[0].style.top="5px");var o=this.addMenuFunction("",mxResources.get("format"),!1,mxUtils.bind(this,function(t){r=t.addItem("",null,this.editorUi.actions.get("subscript").funct,null,"geIcon geSprite geSprite-subscript"),r.setAttribute("title",mxResources.get("subscript")+" (Ctrl+,)"),r=t.addItem("",null,this.editorUi.actions.get("superscript").funct,null,"geIcon geSprite geSprite-superscript"),r.setAttribute("title",mxResources.get("superscript")+" (Ctrl+.)"),r=t.addItem("",null,this.editorUi.actions.get("fontColor").funct,null,"geIcon geSprite geSprite-fontcolor"),r.setAttribute("title",mxResources.get("fontColor")),r=t.addItem("",null,this.editorUi.actions.get("backgroundColor").funct,null,"geIcon geSprite geSprite-fontbackground"),r.setAttribute("title",mxResources.get("backgroundColor")),r=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("removeformat",!1,null)}),null,"geIcon geSprite geSprite-removeformat"),r.setAttribute("title",mxResources.get("removeFormat"))}));o.style.position="relative",o.style.whiteSpace="nowrap",o.style.overflow="hidden",o.innerHTML='<div class="geSprite geSprite-dots" style="margin-left:-2px;"></div>'+this.dropdownImageHtml,o.style.width=mxClient.IS_QUIRKS?"50px":"30px",l.compactUi&&(o.getElementsByTagName("img")[0].style.left="22px",o.getElementsByTagName("img")[0].style.top="5px"),this.addSeparator(),this.addButton("geIcon geSprite geSprite-code",mxResources.get("html"),function(){t.cellEditor.toggleViewMode(),t.cellEditor.textarea.innerHTML.length>0&&("&nbsp;"!=t.cellEditor.textarea.innerHTML||!t.cellEditor.clearOnChange)&&window.setTimeout(function(){document.execCommand("selectAll",!1,null)})}),this.addSeparator();var s=this.addMenuFunction("",mxResources.get("insert"),!0,mxUtils.bind(this,function(t){t.addItem(mxResources.get("insertLink"),null,mxUtils.bind(this,function(){this.editorUi.actions.get("link").funct()})),t.addItem(mxResources.get("insertImage"),null,mxUtils.bind(this,function(){this.editorUi.actions.get("image").funct()})),t.addItem(mxResources.get("insertHorizontalRule"),null,mxUtils.bind(this,function(){document.execCommand("inserthorizontalrule",!1,null)}))}));s.style.whiteSpace="nowrap",s.style.overflow="hidden",s.style.position="relative",s.innerHTML='<div class="geSprite geSprite-plus" style="margin-left:-4px;margin-top:-3px;"></div>'+this.dropdownImageHtml,s.style.width=mxClient.IS_QUIRKS?"36px":"16px",l.compactUi&&(s.getElementsByTagName("img")[0].style.left="24px",s.getElementsByTagName("img")[0].style.top="5px",s.style.width=mxClient.IS_QUIRKS?"50px":"30px"),this.addSeparator();var r=this.addMenuFunction("geIcon geSprite geSprite-table",mxResources.get("table"),!1,mxUtils.bind(this,function(e){var n=t.getSelectedElement(),i=t.getParentByName(n,"TD",t.cellEditor.text2),l=t.getParentByName(n,"TR",t.cellEditor.text2);if(null==l)this.editorUi.menus.addInsertTableItem(e);else{var o=t.getParentByName(l,"TABLE",t.cellEditor.text2);n=e.addItem("",null,mxUtils.bind(this,function(){try{t.selectNode(t.insertColumn(o,null!=i?i.cellIndex:0))}catch(t){mxUtils.alert(mxResources.get("error")+": "+t.message)}}),null,"geIcon geSprite geSprite-insertcolumnbefore"),n.setAttribute("title",mxResources.get("insertColumnBefore")),n=e.addItem("",null,mxUtils.bind(this,function(){try{t.selectNode(t.insertColumn(o,null!=i?i.cellIndex+1:-1))}catch(t){mxUtils.alert(mxResources.get("error")+": "+t.message)}}),null,"geIcon geSprite geSprite-insertcolumnafter"),n.setAttribute("title",mxResources.get("insertColumnAfter")),n=e.addItem("Delete column",null,mxUtils.bind(this,function(){if(null!=i)try{t.deleteColumn(o,i.cellIndex)}catch(t){mxUtils.alert(mxResources.get("error")+": "+t.message)}}),null,"geIcon geSprite geSprite-deletecolumn"),n.setAttribute("title",mxResources.get("deleteColumn")),n=e.addItem("",null,mxUtils.bind(this,function(){try{t.selectNode(t.insertRow(o,l.sectionRowIndex))}catch(t){mxUtils.alert(mxResources.get("error")+": "+t.message)}}),null,"geIcon geSprite geSprite-insertrowbefore"),n.setAttribute("title",mxResources.get("insertRowBefore")),n=e.addItem("",null,mxUtils.bind(this,function(){try{t.selectNode(t.insertRow(o,l.sectionRowIndex+1))}catch(t){mxUtils.alert(mxResources.get("error")+": "+t.message)}}),null,"geIcon geSprite geSprite-insertrowafter"),n.setAttribute("title",mxResources.get("insertRowAfter")),n=e.addItem("",null,mxUtils.bind(this,function(){try{t.deleteRow(o,l.sectionRowIndex)}catch(t){mxUtils.alert(mxResources.get("error")+": "+t.message)}}),null,"geIcon geSprite geSprite-deleterow"),n.setAttribute("title",mxResources.get("deleteRow")),n=e.addItem("",null,mxUtils.bind(this,function(){var t=o.style.borderColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(t,e,n,i){return"#"+("0"+Number(e).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)+("0"+Number(i).toString(16)).substr(-2)});this.editorUi.pickColor(t,function(t){null==t||t==mxConstants.NONE?(o.removeAttribute("border"),o.style.border="",o.style.borderCollapse=""):(o.setAttribute("border","1"),o.style.border="1px solid "+t,o.style.borderCollapse="collapse")})}),null,"geIcon geSprite geSprite-strokecolor"),n.setAttribute("title",mxResources.get("borderColor")),n=e.addItem("",null,mxUtils.bind(this,function(){var t=o.style.backgroundColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(t,e,n,i){return"#"+("0"+Number(e).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)+("0"+Number(i).toString(16)).substr(-2)});this.editorUi.pickColor(t,function(t){null==t||t==mxConstants.NONE?o.style.backgroundColor="":o.style.backgroundColor=t})}),null,"geIcon geSprite geSprite-fillcolor"),n.setAttribute("title",mxResources.get("backgroundColor")),n=e.addItem("",null,mxUtils.bind(this,function(){var t=o.getAttribute("cellPadding")||0,e=new FilenameDialog(this.editorUi,t,mxResources.get("apply"),mxUtils.bind(this,function(t){null!=t&&t.length>0?o.setAttribute("cellPadding",t):o.removeAttribute("cellPadding")}),mxResources.get("spacing"));this.editorUi.showDialog(e.container,300,80,!0,!0),e.init()}),null,"geIcon geSprite geSprite-fit"),n.setAttribute("title",mxResources.get("spacing")),n=e.addItem("",null,mxUtils.bind(this,function(){o.setAttribute("align","left")}),null,"geIcon geSprite geSprite-left"),n.setAttribute("title",mxResources.get("left")),n=e.addItem("",null,mxUtils.bind(this,function(){o.setAttribute("align","center")}),null,"geIcon geSprite geSprite-center"),n.setAttribute("title",mxResources.get("center")),n=e.addItem("",null,mxUtils.bind(this,function(){o.setAttribute("align","right")}),null,"geIcon geSprite geSprite-right"),n.setAttribute("title",mxResources.get("right"))}}));r.style.position="relative",r.style.whiteSpace="nowrap",r.style.overflow="hidden",r.innerHTML='<div class="geSprite geSprite-table" style="margin-left:-2px;"></div>'+this.dropdownImageHtml,r.style.width=mxClient.IS_QUIRKS?"50px":"30px",l.compactUi&&(r.getElementsByTagName("img")[0].style.left="22px",r.getElementsByTagName("img")[0].style.top="5px")},i.prototype.hideMenu=function(){this.editorUi.hideCurrentMenu()},i.prototype.addMenu=function(t,e,n,i,l,o){var s=this.editorUi.menus.get(i),r=this.addMenuFunction(t,e,n,function(){s.funct.apply(s,arguments)},l,o);return s.addListener("stateChanged",function(){r.setEnabled(s.enabled)}),r},i.prototype.addMenuFunction=function(t,e,n,i,l,o){return this.addMenuFunctionInContainer(null!=l?l:this.container,t,e,n,i,o)},i.prototype.addMenuFunctionInContainer=function(t,e,n,i,l,o){var s=i?this.createLabel(e):this.createButton(e);return this.initElement(s,n),this.addMenuHandler(s,i,l,o),t.appendChild(s),s},i.prototype.addSeparator=function(t){t=null!=t?t:this.container;var e=document.createElement("div");return e.className="geSeparator",t.appendChild(e),e},i.prototype.addItems=function(t,e,n){for(var i=[],l=0;l<t.length;l++){var o=t[l];"-"==o?i.push(this.addSeparator(e)):i.push(this.addItem("geSprite-"+o.toLowerCase(),o,e,n))}return i},i.prototype.addItem=function(t,e,n,i){var l=this.editorUi.actions.get(e),o=null;if(null!=l){var s=l.label;null!=l.shortcut&&(s+=" ("+l.shortcut+")"),o=this.addButton(t,s,l.funct,n),i||(o.setEnabled(l.enabled),l.addListener("stateChanged",function(){o.setEnabled(l.enabled)}))}return o},i.prototype.addButton=function(t,e,n,i){var l=this.createButton(t);return i=null!=i?i:this.container,this.initElement(l,e),this.addClickHandler(l,n),i.appendChild(l),l},i.prototype.initElement=function(t,e){null!=e&&t.setAttribute("title",e),this.addEnabledState(t)},i.prototype.addEnabledState=function(t){var e=t.className;t.setEnabled=function(n){t.enabled=n,t.className=n?e:e+" mxDisabled"},t.setEnabled(!0)},i.prototype.addClickHandler=function(t,e){null!=e&&(mxEvent.addListener(t,"click",function(n){t.enabled&&e(n),mxEvent.consume(n)}),null!=document.documentMode&&document.documentMode>=9&&mxEvent.addListener(t,"mousedown",function(t){t.preventDefault()}))},i.prototype.createButton=function(t){var e=document.createElement("a");e.setAttribute("href","javascript:void(0);"),e.className="geButton";var n=document.createElement("div");return null!=t&&(n.className="geSprite "+t),e.appendChild(n),e},i.prototype.createLabel=function(t,e){var n=document.createElement("a");return n.setAttribute("href","javascript:void(0);"),n.className="geLabel",mxUtils.write(n,t),n},i.prototype.addMenuHandler=function(t,e,n,i){if(null!=n){var l=this.editorUi.editor.graph,o=null,s=!0;mxEvent.addListener(t,"click",mxUtils.bind(this,function(r){if(s&&(null==t.enabled||t.enabled)){l.popupMenuHandler.hideMenu(),o=new mxPopupMenu(n),o.div.className+=" geToolbarMenu",o.showDisabled=i,o.labels=e,o.autoExpand=!0;var a=mxUtils.getOffset(t);o.popup(a.x,a.y+t.offsetHeight,null,r),this.editorUi.setCurrentMenu(o,t),!e&&o.div.scrollHeight>o.div.clientHeight&&(o.div.style.width="40px"),o.addListener(mxEvent.EVENT_HIDE,mxUtils.bind(this,function(){this.currentElt=null}))}s=!0,mxEvent.consume(r)})),mxEvent.addListener(t,"mousedown",mxUtils.bind(this,function(e){s=this.currentElt!=t,null!=document.documentMode&&document.documentMode>=9&&e.preventDefault()}))}},i.prototype.destroy=function(){null!=this.gestureHandler&&(mxEvent.removeGestureListeners(document,this.gestureHandler),this.gestureHandler=null)},t.exports=i},function(t,e,n){"use strict";var i=n(2),l=function(t,e){this.editorUi=t,this.container=e};l.prototype.labelIndex=0,l.prototype.currentIndex=0,l.prototype.init=function(){var t=this.editorUi,e=t.editor,n=e.graph;this.update=mxUtils.bind(this,function(t,e){this.clearSelectionState(),this.refresh()}),n.getSelectionModel().addListener(mxEvent.CHANGE,this.update),n.addListener(mxEvent.EDITING_STARTED,this.update),n.addListener(mxEvent.EDITING_STOPPED,this.update),n.getModel().addListener(mxEvent.CHANGE,this.update),n.addListener(mxEvent.ROOT,mxUtils.bind(this,function(){this.refresh()})),this.refresh()},l.prototype.clearSelectionState=function(){this.selectionState=null},l.prototype.getSelectionState=function(){return null==this.selectionState&&(this.selectionState=this.createSelectionState()),this.selectionState},l.prototype.createSelectionState=function(){for(var t=this.editorUi.editor.graph.getSelectionCells(),e=this.initSelectionState(),n=0;n<t.length;n++)this.updateSelectionStateForCell(e,t[n],t);return e},l.prototype.initSelectionState=function(){return{vertices:[],edges:[],x:null,y:null,width:null,height:null,style:{},containsImage:!1,containsLabel:!1,fill:!0,glass:!0,rounded:!0,comic:!0,autoSize:!1,image:!0,shadow:!0}},l.prototype.updateSelectionStateForCell=function(t,e,n){var i=this.editorUi.editor.graph;if(i.getModel().isVertex(e)){t.vertices.push(e);var l=i.getCellGeometry(e);if(null!=l&&(l.width>0?null==t.width?t.width=l.width:t.width!=l.width&&(t.width=""):t.containsLabel=!0,l.height>0?null==t.height?t.height=l.height:t.height!=l.height&&(t.height=""):t.containsLabel=!0,!l.relative||null!=l.offset)){var o=l.relative?l.offset.x:l.x,s=l.relative?l.offset.y:l.y;null==t.x?t.x=o:t.x!=o&&(t.x=""),null==t.y?t.y=s:t.y!=s&&(t.y="")}}else i.getModel().isEdge(e)&&t.edges.push(e);var r=i.view.getState(e);if(null!=r){t.autoSize=t.autoSize||this.isAutoSizeState(r),t.glass=t.glass&&this.isGlassState(r),t.rounded=t.rounded&&this.isRoundedState(r),t.comic=t.comic&&this.isComicState(r),t.image=t.image&&this.isImageState(r),t.shadow=t.shadow&&this.isShadowState(r),t.fill=t.fill&&this.isFillState(r);var a=mxUtils.getValue(r.style,mxConstants.STYLE_SHAPE,null);t.containsImage=t.containsImage||"image"==a;for(var d in r.style){var u=r.style[d];null!=u&&(null==t.style[d]?t.style[d]=u:t.style[d]!=u&&(t.style[d]=""))}}},l.prototype.isFillState=function(t){return t.view.graph.model.isVertex(t.cell)||"arrow"==mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null)||"flexArrow"==mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null)},l.prototype.isGlassState=function(t){var e=mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null);return"label"==e||"rectangle"==e||"internalStorage"==e||"ext"==e||"umlLifeline"==e||"swimlane"==e||"process"==e},l.prototype.isRoundedState=function(t){var e=mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null);return"label"==e||"rectangle"==e||"internalStorage"==e||"corner"==e||"parallelogram"==e||"swimlane"==e||"triangle"==e||"trapezoid"==e||"ext"==e||"step"==e||"tee"==e||"process"==e||"link"==e||"rhombus"==e||"offPageConnector"==e||"loopLimit"==e||"hexagon"==e||"manualInput"==e||"curlyBracket"==e||"singleArrow"==e||"doubleArrow"==e||"flexArrow"==e||"card"==e||"umlLifeline"==e},l.prototype.isComicState=function(t){var e=mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null);return mxUtils.indexOf(["label","rectangle","internalStorage","corner","parallelogram","note","collate","swimlane","triangle","trapezoid","ext","step","tee","process","link","rhombus","offPageConnector","loopLimit","hexagon","manualInput","singleArrow","doubleArrow","flexArrow","card","umlLifeline","connector","folder","component","sortShape","cross","umlFrame","cube","isoCube","isoRectangle"],e)>=0},l.prototype.isAutoSizeState=function(t){return"1"==mxUtils.getValue(t.style,mxConstants.STYLE_AUTOSIZE,null)},l.prototype.isImageState=function(t){var e=mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null);return"label"==e||"image"==e},l.prototype.isShadowState=function(t){return"image"!=mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null)},l.prototype.clear=function(){if(this.container.innerHTML="",null!=this.panels)for(var t=0;t<this.panels.length;t++)this.panels[t].destroy();this.panels=[]},l.prototype.refresh=function(){if("0px"!=this.container.style.width){this.clear();var t=this.editorUi,e=t.editor.graph,n=document.createElement("div");n.style.whiteSpace="nowrap",n.style.color="rgb(112, 112, 112)",n.style.textAlign="left",n.style.cursor="default";var i=document.createElement("div");if(i.style.border="1px solid #c0c0c0",i.style.borderWidth="0px 0px 1px 0px",i.style.textAlign="center",i.style.fontWeight="bold",i.style.overflow="hidden",i.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",i.style.paddingTop="8px",i.style.height=mxClient.IS_QUIRKS?"34px":"25px",i.style.width="100%",this.container.appendChild(n),e.isSelectionEmpty()){mxUtils.write(i,mxResources.get("diagram"));var l=document.createElement("img");l.setAttribute("border","0"),l.setAttribute("src",Dialog.prototype.closeImage),l.setAttribute("title",mxResources.get("hide")),l.style.position="absolute",l.style.display="block",l.style.right="0px",l.style.top="8px",l.style.cursor="pointer",l.style.marginTop="1px",l.style.marginRight="17px",l.style.border="1px solid transparent",l.style.padding="1px",l.style.opacity=.5,i.appendChild(l),mxEvent.addListener(l,"click",function(){t.actions.get("formatPanel").funct()}),n.appendChild(i),this.panels.push(new d(this,t,n))}else if(e.isEditing())mxUtils.write(i,mxResources.get("text")),n.appendChild(i),this.panels.push(new r(this,t,n));else{var o=this.getSelectionState().containsLabel,u=null,c=null,h=mxUtils.bind(this,function(t,e,n){var i=mxUtils.bind(this,function(i){u!=t&&(o?this.labelIndex=n:this.currentIndex=n,null!=u&&(u.style.backgroundColor="#d7d7d7",u.style.borderBottomWidth="1px"),u=t,u.style.backgroundColor="",u.style.borderBottomWidth="0px",c!=e&&(null!=c&&(c.style.display="none"),c=e,c.style.display=""))});mxEvent.addListener(t,"click",i),n==(o?this.labelIndex:this.currentIndex)&&i()}),p=0;i.style.backgroundColor="#d7d7d7",i.style.borderLeftWidth="1px",i.style.width=o?"50%":"33.3%",i.style.width=o?"50%":"33.3%";var m=i.cloneNode(!1),g=m.cloneNode(!1);if(m.style.backgroundColor="#d7d7d7",g.style.backgroundColor="#d7d7d7",o)m.style.borderLeftWidth="0px";else{i.style.borderLeftWidth="0px",mxUtils.write(i,mxResources.get("style")),n.appendChild(i);var x=n.cloneNode(!1);x.style.display="none",this.panels.push(new a(this,t,x)),this.container.appendChild(x),h(i,x,p++)}mxUtils.write(m,mxResources.get("text")),n.appendChild(m);var y=n.cloneNode(!1);y.style.display="none",this.panels.push(new r(this,t,y)),this.container.appendChild(y),mxUtils.write(g,mxResources.get("arrange")),n.appendChild(g);var f=n.cloneNode(!1);f.style.display="none",this.panels.push(new s(this,t,f)),this.container.appendChild(f),h(m,y,p++),h(g,f,p++)}}};var o=function(t,e,n){this.format=t,this.editorUi=e,this.container=n,this.listeners=[]};o.prototype.getSelectionState=function(){for(var t=this.editorUi.editor.graph,e=t.getSelectionCells(),n=null,i=0;i<e.length;i++){var l=t.view.getState(e[i]);if(null!=l){var o=mxUtils.getValue(l.style,mxConstants.STYLE_SHAPE,null);if(null!=o)if(null==n)n=o;else if(n!=o)return null}}return n},o.prototype.installInputHandler=function(t,e,n,i,l,o,s,r){o=null!=o?o:"",r=null!=r&&r;var a=this.editorUi,d=a.editor.graph;i=null!=i?i:1,l=null!=l?l:999;var u=null,c=!1,h=mxUtils.bind(this,function(h){var p=r?parseFloat(t.value):parseInt(t.value);if(isNaN(p)||e!=mxConstants.STYLE_ROTATION||(p=mxUtils.mod(Math.round(100*p),36e3)/100),p=Math.min(l,Math.max(i,isNaN(p)?n:p)),d.cellEditor.isContentEditing()&&s)c||(c=!0,null!=u&&(d.cellEditor.restoreSelection(u),u=null),s(p),t.value=p+o,c=!1);else if(p!=mxUtils.getValue(this.format.getSelectionState().style,e,n)){d.isEditing()&&d.stopEditing(!0),d.getModel().beginUpdate();try{if(d.setCellStyles(e,p,d.getSelectionCells()),e==mxConstants.STYLE_FONTSIZE)for(var m=d.getSelectionCells(),g=0;g<m.length;g++){var x=m[g];if(d.isHtmlLabel(x)){var y=document.createElement("div");y.innerHTML=d.convertValueToString(x);for(var f=y.getElementsByTagName("font"),C=0;C<f.length;C++)f[C].removeAttribute("size"),f[C].style.fontSize=p+"px";d.cellLabelChanged(x,y.innerHTML)}}}finally{d.getModel().endUpdate()}a.fireEvent(new mxEventObject("styleChanged","keys",[e],"values",[p],"cells",d.getSelectionCells()))}t.value=p+o,mxEvent.consume(h)});return s&&d.cellEditor.isContentEditing()&&(mxEvent.addListener(t,"mousedown",function(){u=d.cellEditor.saveSelection()}),mxEvent.addListener(t,"touchstart",function(){u=d.cellEditor.saveSelection()})),mxEvent.addListener(t,"change",h),mxEvent.addListener(t,"blur",h),h},o.prototype.createPanel=function(){var t=document.createElement("div");return t.style.padding="12px 0px 12px 18px",t.style.borderBottom="1px solid #c0c0c0",t},o.prototype.createTitle=function(t){var e=document.createElement("div");return e.style.padding="0px 0px 6px 0px",e.style.whiteSpace="nowrap",e.style.overflow="hidden",e.style.width="200px",e.style.fontWeight="bold",mxUtils.write(e,t),e},o.prototype.createStepper=function(t,e,n,i,l,o){n=null!=n?n:1,i=null!=i?i:8,mxClient.IS_QUIRKS?i-=2:(mxClient.IS_MT||document.documentMode>=8)&&(i+=1);var s=document.createElement("div");mxUtils.setPrefixedStyle(s.style,"borderRadius","3px"),s.style.border="1px solid rgb(192, 192, 192)",s.style.position="absolute";var r=document.createElement("div");r.style.borderBottom="1px solid rgb(192, 192, 192)",r.style.position="relative",r.style.height=i+"px",r.style.width="10px",r.className="geBtnUp",s.appendChild(r);var a=r.cloneNode(!1);if(a.style.border="none",a.style.height=i+"px",a.className="geBtnDown",s.appendChild(a),mxEvent.addListener(a,"click",function(i){""==t.value&&(t.value=o||"2");var l=parseInt(t.value);isNaN(l)||(t.value=l-n,null!=e&&e(i)),mxEvent.consume(i)}),mxEvent.addListener(r,"click",function(i){""==t.value&&(t.value=o||"0");var l=parseInt(t.value);isNaN(l)||(t.value=l+n,null!=e&&e(i)),mxEvent.consume(i)}),l){var d=null;mxEvent.addGestureListeners(s,function(t){(mxClient.IS_QUIRKS||8==document.documentMode)&&(d=document.selection.createRange()),mxEvent.consume(t)},null,function(t){if(null!=d){try{d.select()}catch(t){}d=null,mxEvent.consume(t)}})}return s},o.prototype.createOption=function(t,e,n,i){var l=document.createElement("div");l.style.padding="6px 0px 1px 0px",l.style.whiteSpace="nowrap",l.style.overflow="hidden",l.style.width="200px",l.style.height=mxClient.IS_QUIRKS?"27px":"18px";var o=document.createElement("input");o.setAttribute("type","checkbox"),o.style.margin="0px 6px 0px 0px",l.appendChild(o);var s=document.createElement("span");mxUtils.write(s,t),l.appendChild(s);var r=!1,a=e(),d=function(t){r||(r=!0,t?(o.setAttribute("checked","checked"),o.defaultChecked=!0,o.checked=!0):(o.removeAttribute("checked"),o.defaultChecked=!1,o.checked=!1),a!=t&&(a=t,e()!=a&&n(a)),r=!1)};return mxEvent.addListener(l,"click",function(t){var e=mxEvent.getSource(t);e!=l&&e!=s||(o.checked=!o.checked),d(o.checked)}),d(a),null!=i&&(i.install(d),this.listeners.push(i)),l},o.prototype.createCellOption=function(t,e,n,i,l,o,s,r){i=null!=i?"null"==i?null:i:"1",l=null!=l?"null"==l?null:l:"0";var a=this.editorUi,d=a.editor,u=d.graph;return this.createOption(t,function(){var t=u.view.getState(u.getSelectionCell());return null!=t?mxUtils.getValue(t.style,e,n)!=l:null},function(t){if(r&&u.stopEditing(),null!=s)s.funct();else{u.getModel().beginUpdate();try{var n=t?i:l;u.setCellStyles(e,n,u.getSelectionCells()),null!=o&&o(u.getSelectionCells(),n),a.fireEvent(new mxEventObject("styleChanged","keys",[e],"values",[n],"cells",u.getSelectionCells()))}finally{u.getModel().endUpdate()}}},{install:function(t){this.listener=function(){var i=u.view.getState(u.getSelectionCell());null!=i&&t(mxUtils.getValue(i.style,e,n)!=l)},u.getModel().addListener(mxEvent.CHANGE,this.listener)},destroy:function(){u.getModel().removeListener(this.listener)}})},o.prototype.createColorOption=function(t,e,n,i,l,o,s){var r=document.createElement("div");r.style.padding="6px 0px 1px 0px",r.style.whiteSpace="nowrap",r.style.overflow="hidden",r.style.width="200px",r.style.height=mxClient.IS_QUIRKS?"27px":"18px";var a=document.createElement("input");a.setAttribute("type","checkbox"),a.style.margin="0px 6px 0px 0px",s||r.appendChild(a);var d=document.createElement("span");mxUtils.write(d,t),r.appendChild(d);var u=!1,c=e(),h=null,p=function(t,l){u||(u=!0,h.innerHTML='<div style="width:'+(mxClient.IS_QUIRKS?"30":"36")+"px;height:12px;margin:3px;border:1px solid black;background-color:"+(null!=t&&t!=mxConstants.NONE?t:i)+';"></div>',(mxClient.IS_MT||mxClient.IS_QUIRKS||8==document.documentMode)&&(h.firstChild.style.margin="0px"),null!=t&&t!=mxConstants.NONE?(a.setAttribute("checked","checked"),a.defaultChecked=!0,a.checked=!0):(a.removeAttribute("checked"),a.defaultChecked=!1,a.checked=!1),h.style.display=a.checked||s?"":"none",null!=o&&o(t),l||!s&&c==t||(c=t,(s||e()!=c)&&n(c)),u=!1)};return h=mxUtils.button("",mxUtils.bind(this,function(t){this.editorUi.pickColor(c,p),mxEvent.consume(t)})),h.style.position="absolute",h.style.marginTop="-4px",h.style.right=mxClient.IS_QUIRKS?"0px":"20px",h.style.height="22px",h.className="geColorBtn",h.style.display=a.checked||s?"":"none",r.appendChild(h),mxEvent.addListener(r,"click",function(t){var e=mxEvent.getSource(t);e!=a&&"INPUT"==e.nodeName||(e!=a&&(a.checked=!a.checked),a.checked||null==c||c==mxConstants.NONE||i==mxConstants.NONE||(i=c),p(a.checked?i:mxConstants.NONE))}),p(c,!0),null!=l&&(l.install(p),this.listeners.push(l)),r},o.prototype.createCellColorOption=function(t,e,n,i,l){var o=this.editorUi,s=o.editor,r=s.graph;return this.createColorOption(t,function(){var t=r.view.getState(r.getSelectionCell());return null!=t?mxUtils.getValue(t.style,e,null):null},function(t){r.getModel().beginUpdate();try{null!=l&&l(t),r.setCellStyles(e,t,r.getSelectionCells()),o.fireEvent(new mxEventObject("styleChanged","keys",[e],"values",[t],"cells",r.getSelectionCells()))}finally{r.getModel().endUpdate()}},n||mxConstants.NONE,{install:function(t){this.listener=function(){var n=r.view.getState(r.getSelectionCell());null!=n&&t(mxUtils.getValue(n.style,e,null))},r.getModel().addListener(mxEvent.CHANGE,this.listener)},destroy:function(){r.getModel().removeListener(this.listener)}},i)},o.prototype.addArrow=function(t,e){e=null!=e?e:10;var n=document.createElement("div");n.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",n.style.padding="6px",n.style.paddingRight="4px";var i=10-e;2==i?n.style.paddingTop="6px":i>0?n.style.paddingTop=6-i+"px":n.style.marginTop="-2px",n.style.height=e+"px",n.style.borderLeft="1px solid #a0a0a0",n.innerHTML='<img border="0" src="'+(mxClient.IS_SVG?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHBJREFUeNpidHB2ZyAGsACxDRBPIKCuA6TwCBB/h2rABu4A8SYmKCcXiP/iUFgAxL9gCi8A8SwsirZCMQMTkmANEH9E4v+CmsaArvAdyNFI/FlQ92EoBIE+qCRIUz168DBgsU4OqhinQpgHMABAgAEALY4XLIsJ20oAAAAASUVORK5CYII=":IMAGE_PATH+"/dropdown.png")+'" style="margin-bottom:4px;">',mxUtils.setOpacity(n,70);var l=t.getElementsByTagName("div")[0];return null!=l&&(l.style.paddingRight="6px",l.style.marginLeft="4px",l.style.marginTop="-1px",l.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",mxUtils.setOpacity(l,60)),mxUtils.setOpacity(t,100),t.style.border="1px solid #a0a0a0",t.style.backgroundColor="white",t.style.backgroundImage="none",t.style.width="auto",t.className+=" geColorBtn",mxUtils.setPrefixedStyle(t.style,"borderRadius","3px"),t.appendChild(n),l},o.prototype.addUnitInput=function(t,e,n,i,l,o,s,r){s=null!=s?s:0;var a=document.createElement("input");a.style.position="absolute",a.style.textAlign="right",a.style.marginTop="-2px",a.style.right=n+12+"px",a.style.width=i+"px",t.appendChild(a);var d=this.createStepper(a,l,o,null,r);return d.style.marginTop=s-2+"px",d.style.right=n+"px",t.appendChild(d),a},o.prototype.createRelativeOption=function(t,e,n,i,l){function o(t){if(null!=i)i(a);else{var n=parseInt(a.value);n=Math.min(100,Math.max(0,isNaN(n)?100:n));var l=s.view.getState(s.getSelectionCell());null!=l&&n!=mxUtils.getValue(l.style,e,100)&&(100==n&&(n=null),s.setCellStyles(e,n,s.getSelectionCells())),a.value=(null!=n?n:"100")+" %"}mxEvent.consume(t)}n=null!=n?n:44;var s=this.editorUi.editor.graph,r=this.createPanel();r.style.paddingTop="10px",r.style.paddingBottom="10px",mxUtils.write(r,t),r.style.fontWeight="bold";var a=this.addUnitInput(r,"%",20,n,o,10,-15,null!=i);if(null!=e){var d=mxUtils.bind(this,function(t,n,i){if(i||a!=document.activeElement){var l=this.format.getSelectionState(),o=parseInt(mxUtils.getValue(l.style,e,100));a.value=isNaN(o)?"":o+" %"}});mxEvent.addListener(a,"keydown",function(t){13==t.keyCode?(s.container.focus(),mxEvent.consume(t)):27==t.keyCode&&(d(null,null,!0),s.container.focus(),mxEvent.consume(t))}),s.getModel().addListener(mxEvent.CHANGE,d),this.listeners.push({destroy:function(){s.getModel().removeListener(d)}}),d()}return mxEvent.addListener(a,"blur",o),mxEvent.addListener(a,"change",o),null!=l&&l(a),r},o.prototype.addLabel=function(t,e,n,i){i=null!=i?i:61;var l=document.createElement("div");mxUtils.write(l,e),l.style.position="absolute",l.style.right=n+"px",l.style.width=i+"px",l.style.marginTop="6px",l.style.textAlign="center",t.appendChild(l)},o.prototype.addKeyHandler=function(t,e){mxEvent.addListener(t,"keydown",mxUtils.bind(this,function(t){13==t.keyCode?(this.editorUi.editor.graph.container.focus(),mxEvent.consume(t)):27==t.keyCode&&(null!=e&&e(null,null,!0),this.editorUi.editor.graph.container.focus(),mxEvent.consume(t))}))},o.prototype.styleButtons=function(t){for(var e=0;e<t.length;e++)mxUtils.setPrefixedStyle(t[e].style,"borderRadius","3px"),mxUtils.setOpacity(t[e],100),t[e].style.border="1px solid #a0a0a0",t[e].style.padding="4px",t[e].style.paddingTop="3px",t[e].style.paddingRight="1px",t[e].style.margin="1px",t[e].style.width="24px",t[e].style.height="20px",t[e].className+=" geColorBtn"},o.prototype.destroy=function(){if(null!=this.listeners){for(var t=0;t<this.listeners.length;t++)this.listeners[t].destroy();this.listeners=null}};var s=function(t,e,n){o.call(this,t,e,n),this.init()};mxUtils.extend(s,o),s.prototype.init=function(){var t=(this.editorUi.editor.graph,this.format.getSelectionState());this.container.appendChild(this.addLayerOps(this.createPanel())),this.addGeometry(this.container),this.addEdgeGeometry(this.container),t.containsLabel&&0!=t.edges.length||this.container.appendChild(this.addAngle(this.createPanel())),t.containsLabel||0!=t.edges.length||this.container.appendChild(this.addFlip(this.createPanel())),t.vertices.length>1&&(this.container.appendChild(this.addAlign(this.createPanel())),this.container.appendChild(this.addDistribute(this.createPanel()))),this.container.appendChild(this.addGroupOps(this.createPanel()))},s.prototype.addLayerOps=function(t){var e=this.editorUi,n=mxUtils.button(mxResources.get("toFront"),function(t){e.actions.get("toFront").funct()});n.setAttribute("title",mxResources.get("toFront")+" ("+this.editorUi.actions.get("toFront").shortcut+")"),n.style.width="100px",n.style.marginRight="2px",t.appendChild(n);var n=mxUtils.button(mxResources.get("toBack"),function(t){e.actions.get("toBack").funct()});return n.setAttribute("title",mxResources.get("toBack")+" ("+this.editorUi.actions.get("toBack").shortcut+")"),n.style.width="100px",t.appendChild(n),t},s.prototype.addGroupOps=function(t){var e=this.editorUi,n=e.editor.graph,i=n.getSelectionCell(),l=this.format.getSelectionState(),o=0;if(t.style.paddingTop="8px",t.style.paddingBottom="6px",n.getSelectionCount()>1){var s=mxUtils.button(mxResources.get("group"),function(t){e.actions.get("group").funct()});s.setAttribute("title",mxResources.get("group")+" ("+this.editorUi.actions.get("group").shortcut+")"),s.style.width="202px",s.style.marginBottom="2px",t.appendChild(s),o++}else if(1==n.getSelectionCount()&&!n.getModel().isEdge(i)&&!n.isSwimlane(i)&&n.getModel().getChildCount(i)>0){var r=mxUtils.button(mxResources.get("ungroup"),function(t){e.actions.get("ungroup").funct()});r.setAttribute("title",mxResources.get("ungroup")+" ("+this.editorUi.actions.get("ungroup").shortcut+")"),r.style.width="202px",r.style.marginBottom="2px",t.appendChild(r),o++}if(1==n.getSelectionCount()&&n.getModel().isVertex(i)&&n.getModel().isVertex(n.getModel().getParent(i))){o>0&&mxUtils.br(t);var a=mxUtils.button(mxResources.get("removeFromGroup"),function(t){e.actions.get("removeFromGroup").funct()});a.setAttribute("title",mxResources.get("removeFromGroup")),a.style.width="202px",a.style.marginBottom="2px",t.appendChild(a),o++}else if(l.edges.length>0){o>0&&mxUtils.br(t);var d=mxUtils.button(mxResources.get("clearWaypoints"),mxUtils.bind(this,function(t){this.editorUi.actions.get("clearWaypoints").funct()}));d.setAttribute("title",mxResources.get("clearWaypoints")),d.style.width="202px",d.style.marginBottom="2px",t.appendChild(d),o++}if(1==n.getSelectionCount()){o>0&&mxUtils.br(t);var u=mxUtils.button(mxResources.get("editData"),mxUtils.bind(this,function(t){this.editorUi.actions.get("editData").funct()}));u.setAttribute("title",mxResources.get("editData")+" ("+this.editorUi.actions.get("editData").shortcut+")"),u.style.width="100px",u.style.marginBottom="2px",t.appendChild(u),o++,u=mxUtils.button(mxResources.get("editLink"),mxUtils.bind(this,function(t){this.editorUi.actions.get("editLink").funct()})),u.setAttribute("title",mxResources.get("editLink")),u.style.width="100px",u.style.marginLeft="2px",u.style.marginBottom="2px",t.appendChild(u),o++}return 0==o&&(t.style.display="none"),t},s.prototype.addAlign=function(t){var e=this.editorUi.editor.graph;t.style.paddingTop="6px",t.style.paddingBottom="12px",t.appendChild(this.createTitle(mxResources.get("align")));var n=document.createElement("div");n.style.position="relative",n.style.paddingLeft="0px",n.style.borderWidth="0px",n.className="geToolbarContainer",mxClient.IS_QUIRKS&&(t.style.height="60px");var i=this.editorUi.toolbar.addButton("geSprite-alignleft",mxResources.get("left"),function(){e.alignCells(mxConstants.ALIGN_LEFT)},n),l=this.editorUi.toolbar.addButton("geSprite-aligncenter",mxResources.get("center"),function(){e.alignCells(mxConstants.ALIGN_CENTER)},n),o=this.editorUi.toolbar.addButton("geSprite-alignright",mxResources.get("right"),function(){e.alignCells(mxConstants.ALIGN_RIGHT)},n),s=this.editorUi.toolbar.addButton("geSprite-aligntop",mxResources.get("top"),function(){e.alignCells(mxConstants.ALIGN_TOP)},n),r=this.editorUi.toolbar.addButton("geSprite-alignmiddle",mxResources.get("middle"),function(){e.alignCells(mxConstants.ALIGN_MIDDLE)},n),a=this.editorUi.toolbar.addButton("geSprite-alignbottom",mxResources.get("bottom"),function(){e.alignCells(mxConstants.ALIGN_BOTTOM)},n);return this.styleButtons([i,l,o,s,r,a]),o.style.marginRight="6px",t.appendChild(n),t},s.prototype.addFlip=function(t){var e=this.editorUi,n=e.editor,i=n.graph;t.style.paddingTop="6px",t.style.paddingBottom="10px";var l=document.createElement("div");l.style.marginTop="2px",l.style.marginBottom="8px",l.style.fontWeight="bold",mxUtils.write(l,mxResources.get("flip")),t.appendChild(l);var o=mxUtils.button(mxResources.get("horizontal"),function(t){i.toggleCellStyles(mxConstants.STYLE_FLIPH,!1)});o.setAttribute("title",mxResources.get("horizontal")),o.style.width="100px",o.style.marginRight="2px",t.appendChild(o);var o=mxUtils.button(mxResources.get("vertical"),function(t){i.toggleCellStyles(mxConstants.STYLE_FLIPV,!1)});return o.setAttribute("title",mxResources.get("vertical")),o.style.width="100px",t.appendChild(o),t},s.prototype.addDistribute=function(t){var e=this.editorUi,n=e.editor,i=n.graph;t.style.paddingTop="6px",t.style.paddingBottom="12px",t.appendChild(this.createTitle(mxResources.get("distribute")));var l=mxUtils.button(mxResources.get("horizontal"),function(t){i.distributeCells(!0)});l.setAttribute("title",mxResources.get("horizontal")),l.style.width="100px",l.style.marginRight="2px",t.appendChild(l);var l=mxUtils.button(mxResources.get("vertical"),function(t){i.distributeCells(!1)});return l.setAttribute("title",mxResources.get("vertical")),l.style.width="100px",t.appendChild(l),t},s.prototype.addAngle=function(t){var e=this.editorUi,n=e.editor,i=n.graph,l=this.format.getSelectionState();t.style.paddingBottom="8px";var o=document.createElement("div");o.style.position="absolute",o.style.width="70px",o.style.marginTop="0px",o.style.fontWeight="bold";var s=null,r=null,a=null;if(0==l.edges.length?(mxUtils.write(o,mxResources.get("angle")),t.appendChild(o),s=this.addUnitInput(t,"",20,44,function(){r.apply(this,arguments)}),mxUtils.br(t),t.style.paddingTop="10px"):t.style.paddingTop="8px",!l.containsLabel){var d=mxResources.get("reverse");l.vertices.length>0&&l.edges.length>0?d=mxResources.get("turn")+" / "+d:l.vertices.length>0&&(d=mxResources.get("turn")),a=mxUtils.button(d,function(t){e.actions.get("turn").funct()}),a.setAttribute("title",d+" ("+this.editorUi.actions.get("turn").shortcut+")"),a.style.width="202px",t.appendChild(a),null!=s&&(a.style.marginTop="8px")}if(null!=s){var u=mxUtils.bind(this,function(t,e,n){if(n||document.activeElement!=s){l=this.format.getSelectionState();var i=parseFloat(mxUtils.getValue(l.style,mxConstants.STYLE_ROTATION,0));s.value=isNaN(i)?"":i+""}});r=this.installInputHandler(s,mxConstants.STYLE_ROTATION,0,0,360,"",null,!0),this.addKeyHandler(s,u),i.getModel().addListener(mxEvent.CHANGE,u),this.listeners.push({destroy:function(){i.getModel().removeListener(u)}}),u()}return t},s.prototype.addGeometry=function(t){var e=this.editorUi,n=e.editor.graph,i=this.format.getSelectionState(),l=this.createPanel();l.style.paddingBottom="8px";var o=document.createElement("div");o.style.position="absolute",o.style.width="50px",o.style.marginTop="0px",o.style.fontWeight="bold",mxUtils.write(o,mxResources.get("size")),l.appendChild(o);var s,r,a,d,u=this.addUnitInput(l,"pt",84,44,function(){s.apply(this,arguments)}),c=this.addUnitInput(l,"pt",20,44,function(){r.apply(this,arguments)}),h=document.createElement("div");h.className="geSprite geSprite-fit",h.setAttribute("title",mxResources.get("autosize")+" ("+this.editorUi.actions.get("autosize").shortcut+")"),h.style.position="relative",h.style.cursor="pointer",h.style.marginTop="-3px",h.style.border="0px",h.style.left="52px",mxUtils.setOpacity(h,50),mxEvent.addListener(h,"mouseenter",function(){mxUtils.setOpacity(h,100)}),mxEvent.addListener(h,"mouseleave",function(){mxUtils.setOpacity(h,50)}),mxEvent.addListener(h,"click",function(){e.actions.get("autosize").funct()}),l.appendChild(h),this.addLabel(l,mxResources.get("width"),84),this.addLabel(l,mxResources.get("height"),20),mxUtils.br(l);var p=document.createElement("div");p.style.paddingTop="8px",p.style.paddingRight="20px",p.style.whiteSpace="nowrap",p.style.textAlign="right";var m=this.createCellOption(mxResources.get("constrainProportions"),mxConstants.STYLE_ASPECT,null,"fixed","null");m.style.width="100%",p.appendChild(m),l.appendChild(p),this.addKeyHandler(u,f),this.addKeyHandler(c,f),s=this.addGeometryHandler(u,function(t,e){t.width>0&&(t.width=Math.max(1,e))}),r=this.addGeometryHandler(c,function(t,e){t.height>0&&(t.height=Math.max(1,e))}),t.appendChild(l);var g=this.createPanel();g.style.paddingBottom="30px";var o=document.createElement("div");o.style.position="absolute",o.style.width="70px",o.style.marginTop="0px",o.style.fontWeight="bold",mxUtils.write(o,mxResources.get("position")),g.appendChild(o);var x=this.addUnitInput(g,"pt",84,44,function(){a.apply(this,arguments)}),y=this.addUnitInput(g,"pt",20,44,function(){d.apply(this,arguments)});mxUtils.br(g),this.addLabel(g,mxResources.get("left"),84),this.addLabel(g,mxResources.get("top"),20);var f=mxUtils.bind(this,function(t,e,o){i=this.format.getSelectionState(),i.containsLabel||i.vertices.length!=n.getSelectionCount()||null==i.width||null==i.height?l.style.display="none":(l.style.display="",(o||document.activeElement!=u)&&(u.value=i.width+(""==i.width?"":" pt")),(o||document.activeElement!=c)&&(c.value=i.height+(""==i.height?"":" pt"))),i.vertices.length==n.getSelectionCount()&&null!=i.x&&null!=i.y?(g.style.display="",(o||document.activeElement!=x)&&(x.value=i.x+(""==i.x?"":" pt")),(o||document.activeElement!=y)&&(y.value=i.y+(""==i.y?"":" pt"))):g.style.display="none"});this.addKeyHandler(x,f),this.addKeyHandler(y,f),n.getModel().addListener(mxEvent.CHANGE,f),this.listeners.push({destroy:function(){n.getModel().removeListener(f)}}),f(),a=this.addGeometryHandler(x,function(t,e){t.relative?t.offset.x=e:t.x=e}),d=this.addGeometryHandler(y,function(t,e){t.relative?t.offset.y=e:t.y=e}),t.appendChild(g)},s.prototype.addGeometryHandler=function(t,e){function n(n){if(""!=t.value){var i=parseFloat(t.value);if(i!=o){l.getModel().beginUpdate();try{for(var s=l.getSelectionCells(),r=0;r<s.length;r++)if(l.getModel().isVertex(s[r])){var a=l.getCellGeometry(s[r]);null!=a&&(a=a.clone(),e(a,i),l.getModel().setGeometry(s[r],a))}}finally{l.getModel().endUpdate()}o=i,t.value=i+" pt"}else isNaN(i)&&(t.value=o+" pt")}mxEvent.consume(n)}var i=this.editorUi,l=i.editor.graph,o=null;return mxEvent.addListener(t,"blur",n),mxEvent.addListener(t,"change",n),mxEvent.addListener(t,"focus",function(){o=t.value}),n},s.prototype.addEdgeGeometry=function(t){function e(t){var e=parseInt(r.value);e=Math.min(999,Math.max(1,isNaN(e)?1:e)),e!=mxUtils.getValue(l.style,"width",mxCellRenderer.prototype.defaultShapes.flexArrow.prototype.defaultWidth)&&(i.setCellStyles("width",e,i.getSelectionCells()),n.fireEvent(new mxEventObject("styleChanged","keys",["width"],"values",[e],"cells",i.getSelectionCells()))),r.value=e+" pt",mxEvent.consume(t)}var n=this.editorUi,i=n.editor.graph,l=this.format.getSelectionState(),o=this.createPanel(),s=document.createElement("div");s.style.position="absolute",s.style.width="70px",s.style.marginTop="0px",s.style.fontWeight="bold",mxUtils.write(s,mxResources.get("width")),o.appendChild(s);var e,r=this.addUnitInput(o,"pt",20,44,function(){e.apply(this,arguments)});mxUtils.br(o),this.addKeyHandler(r,a),mxEvent.addListener(r,"blur",e),mxEvent.addListener(r,"change",e),t.appendChild(o);var a=mxUtils.bind(this,function(t,e,n){if(l=this.format.getSelectionState(),"link"==l.style.shape||"flexArrow"==l.style.shape){if(o.style.display="",n||document.activeElement!=r){var i=mxUtils.getValue(l.style,"width",mxCellRenderer.prototype.defaultShapes.flexArrow.prototype.defaultWidth);r.value=i+" pt"}}else o.style.display="none"});i.getModel().addListener(mxEvent.CHANGE,a),this.listeners.push({destroy:function(){i.getModel().removeListener(a)}}),a()};var r=function(t,e,n){o.call(this,t,e,n),this.init()};mxUtils.extend(r,o),r.prototype.init=function(){this.container.style.borderBottom="none",this.addFont(this.container)},r.prototype.addFont=function(t){function e(t,e){mxClient.IS_IE&&(mxClient.IS_QUIRKS||document.documentMode<10)?t.style.filter=e?"progid:DXImageTransform.Microsoft.Gradient(StartColorStr='#c5ecff', EndColorStr='#87d4fb', GradientType=0)":"":t.style.backgroundImage=e?"linear-gradient(#c5ecff 0px,#87d4fb 100%)":""}var n=this.editorUi,l=n.editor,o=l.graph,s=this.format.getSelectionState(),r=this.createTitle(mxResources.get("font"));r.style.paddingLeft="18px",r.style.paddingTop="10px",r.style.paddingBottom="6px",t.appendChild(r);var a=this.createPanel();if(a.style.paddingTop="2px",a.style.paddingBottom="2px",a.style.position="relative",a.style.marginLeft="-2px",a.style.borderWidth="0px",a.className="geToolbarContainer",mxClient.IS_QUIRKS&&(a.style.display="block"),o.cellEditor.isContentEditing()){var d=a.cloneNode(),u=this.editorUi.toolbar.addMenu(mxResources.get("style"),mxResources.get("style"),!0,"formatBlock",d);u.style.color="rgb(112, 112, 112)",u.style.whiteSpace="nowrap",u.style.overflow="hidden",u.style.margin="0px",this.addArrow(u),u.style.width="192px",u.style.height="15px";var c=u.getElementsByTagName("div")[0];c.style.cssFloat="right",t.appendChild(d)}t.appendChild(a);var h=this.createPanel();h.style.marginTop="8px",h.style.borderTop="1px solid #c0c0c0",h.style.paddingTop="6px",h.style.paddingBottom="6px";var p=this.editorUi.toolbar.addMenu("Helvetica",mxResources.get("fontFamily"),!0,"fontFamily",a);p.style.color="rgb(112, 112, 112)",p.style.whiteSpace="nowrap",p.style.overflow="hidden",p.style.margin="0px",this.addArrow(p),p.style.width="192px",p.style.height="15px",mxClient.IS_FF&&(p.getElementsByTagName("div")[0].style.marginTop="-18px");var m=a.cloneNode(!1);m.style.marginLeft="-3px";var g=this.editorUi.toolbar.addItems(["bold","italic","underline"],m,!0);g[0].setAttribute("title",mxResources.get("bold")+" ("+this.editorUi.actions.get("bold").shortcut+")"),g[1].setAttribute("title",mxResources.get("italic")+" ("+this.editorUi.actions.get("italic").shortcut+")"),g[2].setAttribute("title",mxResources.get("underline")+" ("+this.editorUi.actions.get("underline").shortcut+")");var x=this.editorUi.toolbar.addItems(["vertical"],m,!0)[0];mxClient.IS_QUIRKS&&mxUtils.br(t),t.appendChild(m),this.styleButtons(g),this.styleButtons([x]);var y=a.cloneNode(!1);y.style.marginLeft="-3px",y.style.paddingBottom="0px";var f=this.editorUi.toolbar.addButton("geSprite-left",mxResources.get("left"),o.cellEditor.isContentEditing()?function(){document.execCommand("justifyleft",!1,null)}:this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_LEFT]),y),C=this.editorUi.toolbar.addButton("geSprite-center",mxResources.get("center"),o.cellEditor.isContentEditing()?function(){document.execCommand("justifycenter",!1,null)}:this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_CENTER]),y),S=this.editorUi.toolbar.addButton("geSprite-right",mxResources.get("right"),o.cellEditor.isContentEditing()?function(){document.execCommand("justifyright",!1,null)}:this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_RIGHT]),y);if(this.styleButtons([f,C,S]),o.cellEditor.isContentEditing()){var E=this.editorUi.toolbar.addButton("geSprite-removeformat",mxResources.get("removeFormat"),function(){document.execCommand("removeformat",!1,null)},m);this.styleButtons([E])}var v=this.editorUi.toolbar.addButton("geSprite-top",mxResources.get("top"),this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_TOP]),y),b=this.editorUi.toolbar.addButton("geSprite-middle",mxResources.get("middle"),this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_MIDDLE]),y),w=this.editorUi.toolbar.addButton("geSprite-bottom",mxResources.get("bottom"),this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_BOTTOM]),y);this.styleButtons([v,b,w]),mxClient.IS_QUIRKS&&mxUtils.br(t),t.appendChild(y);var T,A,R,I,L,U,N;if(o.cellEditor.isContentEditing()){v.style.display="none",b.style.display="none",w.style.display="none",x.style.display="none",R=this.editorUi.toolbar.addButton("geSprite-justifyfull",null,function(){document.execCommand("justifyfull",!1,null)},y),this.styleButtons([R,T=this.editorUi.toolbar.addButton("geSprite-subscript",mxResources.get("subscript")+" (Ctrl+,)",function(){document.execCommand("subscript",!1,null)},y),A=this.editorUi.toolbar.addButton("geSprite-superscript",mxResources.get("superscript")+" (Ctrl+.)",function(){document.execCommand("superscript",!1,null)},y)]),R.style.marginRight="9px";var M=y.cloneNode(!1);M.style.paddingTop="4px";var O=[this.editorUi.toolbar.addButton("geSprite-orderedlist",mxResources.get("numberedList"),function(){document.execCommand("insertorderedlist",!1,null)},M),this.editorUi.toolbar.addButton("geSprite-unorderedlist",mxResources.get("bulletedList"),function(){document.execCommand("insertunorderedlist",!1,null)},M),this.editorUi.toolbar.addButton("geSprite-outdent",mxResources.get("decreaseIndent"),function(){document.execCommand("outdent",!1,null)},M),this.editorUi.toolbar.addButton("geSprite-indent",mxResources.get("increaseIndent"),function(){document.execCommand("indent",!1,null)},M),this.editorUi.toolbar.addButton("geSprite-code",mxResources.get("html"),function(){o.cellEditor.toggleViewMode()},M)];this.styleButtons(O),O[O.length-1].style.marginLeft="9px",mxClient.IS_QUIRKS&&(mxUtils.br(t),M.style.height="40"),t.appendChild(M)}else g[2].style.marginRight="9px",S.style.marginRight="9px";var _=a.cloneNode(!1);_.style.marginLeft="0px",_.style.paddingTop="8px",_.style.paddingBottom="4px",_.style.fontWeight="normal",mxUtils.write(_,mxResources.get("position"));var D=document.createElement("select");D.style.position="absolute",D.style.right="20px",D.style.width="97px",D.style.marginTop="-2px";for(var H=["topLeft","top","topRight","left","center","right","bottomLeft","bottom","bottomRight"],P={topLeft:[mxConstants.ALIGN_LEFT,mxConstants.ALIGN_TOP,mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_BOTTOM],top:[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_TOP,mxConstants.ALIGN_CENTER,mxConstants.ALIGN_BOTTOM],topRight:[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_TOP,mxConstants.ALIGN_LEFT,mxConstants.ALIGN_BOTTOM],left:[mxConstants.ALIGN_LEFT,mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_MIDDLE],center:[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_CENTER,mxConstants.ALIGN_MIDDLE],right:[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_LEFT,mxConstants.ALIGN_MIDDLE],bottomLeft:[mxConstants.ALIGN_LEFT,mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_TOP],bottom:[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_CENTER,mxConstants.ALIGN_TOP],bottomRight:[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_LEFT,mxConstants.ALIGN_TOP]},k=0;k<H.length;k++){var F=document.createElement("option");F.setAttribute("value",H[k]),mxUtils.write(F,mxResources.get(H[k])),D.appendChild(F)}_.appendChild(D);var G=a.cloneNode(!1);G.style.marginLeft="0px",G.style.paddingTop="4px",G.style.paddingBottom="4px",G.style.fontWeight="normal",mxUtils.write(G,mxResources.get("writingDirection"));var Y=document.createElement("select");Y.style.position="absolute",Y.style.right="20px",Y.style.width="97px",Y.style.marginTop="-2px";for(var B=["automatic","leftToRight","rightToLeft"],W={automatic:null,leftToRight:mxConstants.TEXT_DIRECTION_LTR,rightToLeft:mxConstants.TEXT_DIRECTION_RTL},k=0;k<B.length;k++){var z=document.createElement("option");z.setAttribute("value",B[k]),mxUtils.write(z,mxResources.get(B[k])),Y.appendChild(z)}G.appendChild(Y),o.isEditing()||(t.appendChild(_),mxEvent.addListener(D,"change",function(t){o.getModel().beginUpdate();try{var e=P[D.value];null!=e&&(o.setCellStyles(mxConstants.STYLE_LABEL_POSITION,e[0],o.getSelectionCells()),o.setCellStyles(mxConstants.STYLE_VERTICAL_LABEL_POSITION,e[1],o.getSelectionCells()),o.setCellStyles(mxConstants.STYLE_ALIGN,e[2],o.getSelectionCells()),o.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,e[3],o.getSelectionCells()))}finally{o.getModel().endUpdate()}mxEvent.consume(t)}),t.appendChild(G),mxEvent.addListener(Y,"change",function(t){o.setCellStyles(mxConstants.STYLE_TEXT_DIRECTION,W[Y.value],o.getSelectionCells()),mxEvent.consume(t)}));var V=document.createElement("input");V.style.textAlign="right",V.style.marginTop="4px",mxClient.IS_QUIRKS||(V.style.position="absolute",V.style.right="32px"),V.style.width="46px",V.style.height=mxClient.IS_QUIRKS?"21px":"17px",m.appendChild(V);var j=null,Z=this.installInputHandler(V,mxConstants.STYLE_FONTSIZE,i.prototype.defaultFontSize,1,999," pt",function(t){j=t,document.execCommand("fontSize",!1,"4");for(var e=o.cellEditor.textarea.getElementsByTagName("font"),n=0;n<e.length;n++)if("4"==e[n].getAttribute("size")){e[n].removeAttribute("size"),e[n].style.fontSize=j+"px",window.setTimeout(function(){V.value=j+" pt",j=null},0);break}},!0),Q=this.createStepper(V,Z,1,10,!0,i.prototype.defaultFontSize);Q.style.display=V.style.display,Q.style.marginTop="4px",mxClient.IS_QUIRKS||(Q.style.right="20px"),m.appendChild(Q);var c=p.getElementsByTagName("div")[0];c.style.cssFloat="right";var K=null,X="#ffffff",J=null,q="#000000",$=o.cellEditor.isContentEditing()?this.createColorOption(mxResources.get("backgroundColor"),function(){return X},function(t){document.execCommand("backcolor",!1,t!=mxConstants.NONE?t:"transparent")},"#ffffff",{install:function(t){K=t},destroy:function(){K=null}},null,!0):this.createCellColorOption(mxResources.get("backgroundColor"),mxConstants.STYLE_LABEL_BACKGROUNDCOLOR,"#ffffff");$.style.fontWeight="bold";var tt=this.createCellColorOption(mxResources.get("borderColor"),mxConstants.STYLE_LABEL_BORDERCOLOR,"#000000");tt.style.fontWeight="bold";var et=o.cellEditor.isContentEditing()?this.createColorOption(mxResources.get("fontColor"),function(){return q},function(t){document.execCommand("forecolor",!1,t!=mxConstants.NONE?t:"transparent")},"#000000",{install:function(t){J=t},destroy:function(){J=null}},null,!0):this.createCellColorOption(mxResources.get("fontColor"),mxConstants.STYLE_FONTCOLOR,"#000000",function(t){null==t||t==mxConstants.NONE?$.style.display="none":$.style.display="",tt.style.display=$.style.display},function(t){null==t||t==mxConstants.NONE?o.setCellStyles(mxConstants.STYLE_NOLABEL,"1",o.getSelectionCells()):o.setCellStyles(mxConstants.STYLE_NOLABEL,null,o.getSelectionCells())});et.style.fontWeight="bold",h.appendChild(et),h.appendChild($),o.cellEditor.isContentEditing()||h.appendChild(tt),t.appendChild(h);var nt=this.createPanel();nt.style.paddingTop="2px",nt.style.paddingBottom="4px";var it=this.createCellOption(mxResources.get("wordWrap"),mxConstants.STYLE_WHITE_SPACE,null,"wrap","null",null,null,!0);it.style.fontWeight="bold",s.containsLabel||s.autoSize||0!=s.edges.length||nt.appendChild(it);var lt=this.createCellOption(mxResources.get("formattedText"),"html","0",null,null,null,n.actions.get("formattedText"));lt.style.fontWeight="bold",nt.appendChild(lt);var ot=this.createPanel();ot.style.paddingTop="10px",ot.style.paddingBottom="28px",ot.style.fontWeight="normal";var st=document.createElement("div");st.style.position="absolute",st.style.width="70px",st.style.marginTop="0px",st.style.fontWeight="bold",mxUtils.write(st,mxResources.get("spacing")),ot.appendChild(st);var rt,at,dt,ut,ct,ht=this.addUnitInput(ot,"pt",91,44,function(){rt.apply(this,arguments)}),pt=this.addUnitInput(ot,"pt",20,44,function(){at.apply(this,arguments)});mxUtils.br(ot),this.addLabel(ot,mxResources.get("top"),91),this.addLabel(ot,mxResources.get("global"),20),mxUtils.br(ot),mxUtils.br(ot);var mt=this.addUnitInput(ot,"pt",162,44,function(){dt.apply(this,arguments)}),gt=this.addUnitInput(ot,"pt",91,44,function(){ut.apply(this,arguments)}),xt=this.addUnitInput(ot,"pt",20,44,function(){ct.apply(this,arguments)});if(mxUtils.br(ot),this.addLabel(ot,mxResources.get("left"),162),this.addLabel(ot,mxResources.get("bottom"),91),this.addLabel(ot,mxResources.get("right"),20),o.cellEditor.isContentEditing()){var yt=null,ft=null;t.appendChild(this.createRelativeOption(mxResources.get("lineheight"),null,null,function(t){var e=""==t.value?120:parseInt(t.value);e=Math.max(120,isNaN(e)?120:e),null!=yt&&(o.cellEditor.restoreSelection(yt),yt=null);for(var n=o.getSelectedElement(),i=n;null!=i&&i.nodeType!=mxConstants.NODETYPE_ELEMENT;)i=i.parentNode;null!=i&&i==o.cellEditor.textarea&&null!=o.cellEditor.textarea.firstChild&&("FONT"!=o.cellEditor.textarea.firstChild.nodeName&&(o.cellEditor.textarea.innerHTML="<font>"+o.cellEditor.textarea.innerHTML+"</font>"),i=o.cellEditor.textarea.firstChild),null!=i&&i!=o.cellEditor.textarea&&(i.style.lineHeight=e+"%"),t.value=e+" %"},function(t){ft=t,mxEvent.addListener(t,"mousedown",function(){yt=o.cellEditor.saveSelection()}),mxEvent.addListener(t,"touchstart",function(){yt=o.cellEditor.saveSelection()}),t.value="120 %"}));var Ct=a.cloneNode(!1);Ct.style.paddingLeft="0px";var St=this.editorUi.toolbar.addItems(["link","image"],Ct,!0),O=[this.editorUi.toolbar.addButton("geSprite-horizontalrule",mxResources.get("insertHorizontalRule"),function(){document.execCommand("inserthorizontalrule",!1,null)},Ct),this.editorUi.toolbar.addMenuFunctionInContainer(Ct,"geSprite-table",mxResources.get("table"),!1,mxUtils.bind(this,function(t){this.editorUi.menus.addInsertTableItem(t)}))];this.styleButtons(St),this.styleButtons(O);var Et=this.createPanel();Et.style.paddingTop="10px",Et.style.paddingBottom="10px",Et.appendChild(this.createTitle(mxResources.get("insert"))),Et.appendChild(Ct),t.appendChild(Et),mxClient.IS_QUIRKS&&(Et.style.height="70");var vt=a.cloneNode(!1);vt.style.paddingLeft="0px";var O=[this.editorUi.toolbar.addButton("geSprite-insertcolumnbefore",mxResources.get("insertColumnBefore"),function(){try{null!=L&&o.selectNode(o.insertColumn(L,null!=U?U.cellIndex:0))}catch(t){alert(t)}},vt),this.editorUi.toolbar.addButton("geSprite-insertcolumnafter",mxResources.get("insertColumnAfter"),function(){try{null!=L&&o.selectNode(o.insertColumn(L,null!=U?U.cellIndex+1:-1))}catch(t){alert(t)}},vt),this.editorUi.toolbar.addButton("geSprite-deletecolumn",mxResources.get("deleteColumn"),function(){try{null!=L&&null!=U&&o.deleteColumn(L,U.cellIndex)}catch(t){alert(t)}},vt),this.editorUi.toolbar.addButton("geSprite-insertrowbefore",mxResources.get("insertRowBefore"),function(){try{null!=L&&null!=N&&o.selectNode(o.insertRow(L,N.sectionRowIndex))}catch(t){alert(t)}},vt),this.editorUi.toolbar.addButton("geSprite-insertrowafter",mxResources.get("insertRowAfter"),function(){try{null!=L&&null!=N&&o.selectNode(o.insertRow(L,N.sectionRowIndex+1))}catch(t){alert(t)}},vt),this.editorUi.toolbar.addButton("geSprite-deleterow",mxResources.get("deleteRow"),function(){try{null!=L&&null!=N&&o.deleteRow(L,N.sectionRowIndex)}catch(t){alert(t)}},vt)];this.styleButtons(O),O[2].style.marginRight="9px";var bt=this.createPanel();bt.style.paddingTop="10px",bt.style.paddingBottom="10px",bt.appendChild(this.createTitle(mxResources.get("table"))),bt.appendChild(vt),mxClient.IS_QUIRKS&&(mxUtils.br(t),bt.style.height="70");var wt=a.cloneNode(!1);wt.style.paddingLeft="0px";var O=[this.editorUi.toolbar.addButton("geSprite-strokecolor",mxResources.get("borderColor"),mxUtils.bind(this,function(){if(null!=L){var t=L.style.borderColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(t,e,n,i){return"#"+("0"+Number(e).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)+("0"+Number(i).toString(16)).substr(-2)});this.editorUi.pickColor(t,function(t){null==t||t==mxConstants.NONE?(L.removeAttribute("border"),L.style.border="",L.style.borderCollapse=""):(L.setAttribute("border","1"),L.style.border="1px solid "+t,L.style.borderCollapse="collapse")})}}),wt),this.editorUi.toolbar.addButton("geSprite-fillcolor",mxResources.get("backgroundColor"),mxUtils.bind(this,function(){if(null!=L){var t=L.style.backgroundColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(t,e,n,i){return"#"+("0"+Number(e).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)+("0"+Number(i).toString(16)).substr(-2)});this.editorUi.pickColor(t,function(t){null==t||t==mxConstants.NONE?L.style.backgroundColor="":L.style.backgroundColor=t})}}),wt),this.editorUi.toolbar.addButton("geSprite-fit",mxResources.get("spacing"),function(){if(null!=L){var t=L.getAttribute("cellPadding")||0,e=new FilenameDialog(n,t,mxResources.get("apply"),mxUtils.bind(this,function(t){null!=t&&t.length>0?L.setAttribute("cellPadding",t):L.removeAttribute("cellPadding")}),mxResources.get("spacing"));n.showDialog(e.container,300,80,!0,!0),e.init()}},wt),this.editorUi.toolbar.addButton("geSprite-left",mxResources.get("left"),function(){null!=L&&L.setAttribute("align","left")},wt),this.editorUi.toolbar.addButton("geSprite-center",mxResources.get("center"),function(){null!=L&&L.setAttribute("align","center")},wt),this.editorUi.toolbar.addButton("geSprite-right",mxResources.get("right"),function(){null!=L&&L.setAttribute("align","right")},wt)];this.styleButtons(O),O[2].style.marginRight="9px",mxClient.IS_QUIRKS&&(mxUtils.br(bt),mxUtils.br(bt)),bt.appendChild(wt),t.appendChild(bt),I=bt}else t.appendChild(nt),t.appendChild(this.createRelativeOption(mxResources.get("opacity"),mxConstants.STYLE_TEXT_OPACITY)),t.appendChild(ot);var Tt=mxUtils.bind(this,function(t,n,l){s=this.format.getSelectionState();var o=mxUtils.getValue(s.style,mxConstants.STYLE_FONTSTYLE,0);if(e(g[0],(o&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD),e(g[1],(o&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC),e(g[2],(o&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE),p.firstChild.nodeValue=mxUtils.htmlEntities(mxUtils.getValue(s.style,mxConstants.STYLE_FONTFAMILY,i.prototype.defaultFont)),e(x,"0"==mxUtils.getValue(s.style,mxConstants.STYLE_HORIZONTAL,"1")),l||document.activeElement!=V){var r=parseFloat(mxUtils.getValue(s.style,mxConstants.STYLE_FONTSIZE,i.prototype.defaultFontSize));V.value=isNaN(r)?"":r+" pt"}var a=mxUtils.getValue(s.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER);e(f,a==mxConstants.ALIGN_LEFT),e(C,a==mxConstants.ALIGN_CENTER),e(S,a==mxConstants.ALIGN_RIGHT);var d=mxUtils.getValue(s.style,mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE);e(v,d==mxConstants.ALIGN_TOP),e(b,d==mxConstants.ALIGN_MIDDLE),e(w,d==mxConstants.ALIGN_BOTTOM);var u=mxUtils.getValue(s.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER),c=mxUtils.getValue(s.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);u==mxConstants.ALIGN_LEFT&&c==mxConstants.ALIGN_TOP?D.value="topLeft":u==mxConstants.ALIGN_CENTER&&c==mxConstants.ALIGN_TOP?D.value="top":u==mxConstants.ALIGN_RIGHT&&c==mxConstants.ALIGN_TOP?D.value="topRight":u==mxConstants.ALIGN_LEFT&&c==mxConstants.ALIGN_BOTTOM?D.value="bottomLeft":u==mxConstants.ALIGN_CENTER&&c==mxConstants.ALIGN_BOTTOM?D.value="bottom":u==mxConstants.ALIGN_RIGHT&&c==mxConstants.ALIGN_BOTTOM?D.value="bottomRight":u==mxConstants.ALIGN_LEFT?D.value="left":u==mxConstants.ALIGN_RIGHT?D.value="right":D.value="center";var h=mxUtils.getValue(s.style,mxConstants.STYLE_TEXT_DIRECTION,mxConstants.DEFAULT_TEXT_DIRECTION);if(h==mxConstants.TEXT_DIRECTION_RTL?Y.value="rightToLeft":h==mxConstants.TEXT_DIRECTION_LTR?Y.value="leftToRight":h==mxConstants.TEXT_DIRECTION_AUTO&&(Y.value="automatic"),l||document.activeElement!=pt){var r=parseFloat(mxUtils.getValue(s.style,mxConstants.STYLE_SPACING,2));pt.value=isNaN(r)?"":r+" pt"}if(l||document.activeElement!=ht){var r=parseFloat(mxUtils.getValue(s.style,mxConstants.STYLE_SPACING_TOP,0));ht.value=isNaN(r)?"":r+" pt"}if(l||document.activeElement!=xt){var r=parseFloat(mxUtils.getValue(s.style,mxConstants.STYLE_SPACING_RIGHT,0));xt.value=isNaN(r)?"":r+" pt"}if(l||document.activeElement!=gt){var r=parseFloat(mxUtils.getValue(s.style,mxConstants.STYLE_SPACING_BOTTOM,0));gt.value=isNaN(r)?"":r+" pt"}if(l||document.activeElement!=mt){var r=parseFloat(mxUtils.getValue(s.style,mxConstants.STYLE_SPACING_LEFT,0));mt.value=isNaN(r)?"":r+" pt"}});if(at=this.installInputHandler(pt,mxConstants.STYLE_SPACING,2,-999,999," pt"),rt=this.installInputHandler(ht,mxConstants.STYLE_SPACING_TOP,0,-999,999," pt"),ct=this.installInputHandler(xt,mxConstants.STYLE_SPACING_RIGHT,0,-999,999," pt"),ut=this.installInputHandler(gt,mxConstants.STYLE_SPACING_BOTTOM,0,-999,999," pt"),dt=this.installInputHandler(mt,mxConstants.STYLE_SPACING_LEFT,0,-999,999," pt"),this.addKeyHandler(V,Tt),this.addKeyHandler(pt,Tt),this.addKeyHandler(ht,Tt),this.addKeyHandler(xt,Tt),this.addKeyHandler(gt,Tt),this.addKeyHandler(mt,Tt),o.getModel().addListener(mxEvent.CHANGE,Tt),this.listeners.push({destroy:function(){o.getModel().removeListener(Tt)}}),Tt(),o.cellEditor.isContentEditing()){var At=!1,Rt=function(){At||(At=!0,window.setTimeout(function(){for(var t=o.getSelectedElement(),n=t;null!=n&&n.nodeType!=mxConstants.NODETYPE_ELEMENT;)n=n.parentNode;if(null!=n){var i=mxUtils.getCurrentStyle(n);if(null!=i){if(e(g[0],"bold"==i.fontWeight||null!=o.getParentByName(n,"B",o.cellEditor.textarea)),e(g[1],"italic"==i.fontStyle||null!=o.getParentByName(n,"I",o.cellEditor.textarea)),e(g[2],null!=o.getParentByName(n,"U",o.cellEditor.textarea)),e(f,"left"==i.textAlign),e(C,"center"==i.textAlign),e(S,"right"==i.textAlign),e(R,"justify"==i.textAlign),e(A,null!=o.getParentByName(n,"SUP",o.cellEditor.textarea)),e(T,null!=o.getParentByName(n,"SUB",o.cellEditor.textarea)),L=o.getParentByName(n,"TABLE",o.cellEditor.textarea),N=null==L?null:o.getParentByName(n,"TR",L),U=null==L?null:o.getParentByName(n,"TD",L),I.style.display=null!=L?"":"none",document.activeElement!=V){"FONT"==n.nodeName&&"4"==n.getAttribute("size")&&null!=j?(n.removeAttribute("size"),n.style.fontSize=j+"px",j=null):V.value=parseFloat(i.fontSize)+" pt";var l=n.style.lineHeight||i.lineHeight,s=parseFloat(l);"px"==l.substring(l.length-2)&&(s/=parseFloat(i.fontSize)),"%"!=l.substring(l.length-1)&&(s*=100),ft.value=s+" %"}var r=i.color.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(t,e,n,i){return"#"+("0"+Number(e).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)+("0"+Number(i).toString(16)).substr(-2)}),a=i.backgroundColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(t,e,n,i){return"#"+("0"+Number(e).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)+("0"+Number(i).toString(16)).substr(-2)});if(null!=J&&(q="#"==r.charAt(0)?r:"#000000",J(q,!0)),null!=K&&(X="#"==a.charAt(0)?a:null,K(X,!0)),null!=p.firstChild){var d=i.fontFamily;"'"==d.charAt(0)&&(d=d.substring(1)),"'"==d.charAt(d.length-1)&&(d=d.substring(0,d.length-1)),p.firstChild.nodeValue=d}}}At=!1},0))};mxEvent.addListener(o.cellEditor.textarea,"input",Rt),mxEvent.addListener(o.cellEditor.textarea,"touchend",Rt),mxEvent.addListener(o.cellEditor.textarea,"mouseup",Rt),mxEvent.addListener(o.cellEditor.textarea,"keyup",Rt),this.listeners.push({destroy:function(){}}),Rt()}return t};var a=function(t,e,n){o.call(this,t,e,n),this.init()};mxUtils.extend(a,o),a.prototype.init=function(){var t=this.editorUi,e=t.editor,n=(e.graph,this.format.getSelectionState());n.containsImage&&"image"!=n.style.shape||this.container.appendChild(this.addFill(this.createPanel())),this.container.appendChild(this.addStroke(this.createPanel()));var i=this.createRelativeOption(mxResources.get("opacity"),mxConstants.STYLE_OPACITY,41);i.style.paddingTop="8px",i.style.paddingBottom="8px",this.container.appendChild(i),this.container.appendChild(this.addEffects(this.createPanel()));var l=this.addEditOps(this.createPanel());null!=l.firstChild&&mxUtils.br(l),this.container.appendChild(this.addStyleOps(l))},a.prototype.addEditOps=function(t){var e=this.format.getSelectionState(),n=null;if(1==this.editorUi.editor.graph.getSelectionCount()&&(n=mxUtils.button(mxResources.get("editStyle"),mxUtils.bind(this,function(t){this.editorUi.actions.get("editStyle").funct()})),n.setAttribute("title",mxResources.get("editStyle")+" ("+this.editorUi.actions.get("editStyle").shortcut+")"),n.style.width="202px",n.style.marginBottom="2px",t.appendChild(n)),e.image){var i=mxUtils.button(mxResources.get("editImage"),mxUtils.bind(this,function(t){this.editorUi.actions.get("image").funct()}));i.setAttribute("title",mxResources.get("editImage")),i.style.marginBottom="2px",null==n?i.style.width="202px":(n.style.width="100px",i.style.width="100px",i.style.marginLeft="2px"),t.appendChild(i)}return t},a.prototype.addFill=function(t){var e=this.editorUi,n=e.editor.graph,i=this.format.getSelectionState();t.style.paddingTop="6px",t.style.paddingBottom="6px";var l=document.createElement("select");l.style.position="absolute",l.style.marginTop="-2px",l.style.right=mxClient.IS_QUIRKS?"52px":"72px",l.style.width="70px",mxEvent.addListener(l,"click",function(t){mxEvent.consume(t)});var o=this.createCellColorOption(mxResources.get("gradient"),mxConstants.STYLE_GRADIENTCOLOR,"#ffffff",function(t){null==t||t==mxConstants.NONE?l.style.display="none":l.style.display=""}),s="image"==i.style.shape?mxConstants.STYLE_IMAGE_BACKGROUND:mxConstants.STYLE_FILLCOLOR,r=this.createCellColorOption(mxResources.get("fill"),s,"#ffffff");r.style.fontWeight="bold";var a=mxUtils.getValue(i.style,s,null);o.style.display=null!=a&&a!=mxConstants.NONE&&i.fill&&"image"!=i.style.shape?"":"none";for(var d=[mxConstants.DIRECTION_NORTH,mxConstants.DIRECTION_EAST,mxConstants.DIRECTION_SOUTH,mxConstants.DIRECTION_WEST],u=0;u<d.length;u++){var c=document.createElement("option");c.setAttribute("value",d[u]),mxUtils.write(c,mxResources.get(d[u])),l.appendChild(c)}o.appendChild(l);var h=mxUtils.bind(this,function(){i=this.format.getSelectionState();var e=mxUtils.getValue(i.style,mxConstants.STYLE_GRADIENT_DIRECTION,mxConstants.DIRECTION_SOUTH);""==e&&(e=mxConstants.DIRECTION_SOUTH),l.value=e,t.style.display=i.fill?"":"none";var n=mxUtils.getValue(i.style,mxConstants.STYLE_FILLCOLOR,null);!i.fill||i.containsImage||null==n||n==mxConstants.NONE?o.style.display="none":o.style.display=""});return n.getModel().addListener(mxEvent.CHANGE,h),this.listeners.push({destroy:function(){n.getModel().removeListener(h)}}),h(),mxEvent.addListener(l,"change",function(t){n.setCellStyles(mxConstants.STYLE_GRADIENT_DIRECTION,l.value,n.getSelectionCells()),mxEvent.consume(t)}),t.appendChild(r),t.appendChild(o),"swimlane"==i.style.shape&&t.appendChild(this.createCellColorOption(mxResources.get("laneColor"),"swimlaneFillColor","#ffffff")),t},a.prototype.addStroke=function(t){function e(t){var e=parseInt(S.value);e=Math.min(999,Math.max(1,isNaN(e)?1:e)),e!=mxUtils.getValue(o.style,mxConstants.STYLE_STROKEWIDTH,1)&&(l.setCellStyles(mxConstants.STYLE_STROKEWIDTH,e,l.getSelectionCells()),i.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_STROKEWIDTH],"values",[e],"cells",l.getSelectionCells()))),S.value=e+" pt",mxEvent.consume(t)}function n(t){var e=parseInt(E.value);e=Math.min(999,Math.max(1,isNaN(e)?1:e)),e!=mxUtils.getValue(o.style,mxConstants.STYLE_STROKEWIDTH,1)&&(l.setCellStyles(mxConstants.STYLE_STROKEWIDTH,e,l.getSelectionCells()),i.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_STROKEWIDTH],"values",[e],"cells",l.getSelectionCells()))),E.value=e+" pt",mxEvent.consume(t)}var i=this.editorUi,l=i.editor.graph,o=this.format.getSelectionState();t.style.paddingTop="4px",t.style.paddingBottom="4px",t.style.whiteSpace="normal";var s=document.createElement("div");s.style.fontWeight="bold";var r=document.createElement("select");r.style.position="absolute",r.style.marginTop="-2px",r.style.right="72px",r.style.width="80px";for(var a=["sharp","rounded","curved"],d=0;d<a.length;d++){var u=document.createElement("option");u.setAttribute("value",a[d]),mxUtils.write(u,mxResources.get(a[d])),r.appendChild(u)}mxEvent.addListener(r,"change",function(t){l.getModel().beginUpdate();try{var e=[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],n=["0",null];"rounded"==r.value?n=["1",null]:"curved"==r.value&&(n=[null,"1"]);for(var o=0;o<e.length;o++)l.setCellStyles(e[o],n[o],l.getSelectionCells());i.fireEvent(new mxEventObject("styleChanged","keys",e,"values",n,"cells",l.getSelectionCells()))}finally{l.getModel().endUpdate()}mxEvent.consume(t)}),mxEvent.addListener(r,"click",function(t){mxEvent.consume(t)});var c="image"==o.style.shape?mxConstants.STYLE_IMAGE_BORDER:mxConstants.STYLE_STROKECOLOR,h=this.createCellColorOption(mxResources.get("line"),c,"#000000");h.appendChild(r),s.appendChild(h);var p=s.cloneNode(!1);p.style.fontWeight="normal",p.style.whiteSpace="nowrap",p.style.position="relative",p.style.paddingLeft="16px",p.style.marginBottom="2px",p.style.marginTop="2px",p.className="geToolbarContainer";var m=mxUtils.bind(this,function(t,e,n,i,l){var o=this.editorUi.menus.styleChange(t,"",i,l,"geIcon",null),s=document.createElement("div");return s.style.width=e+"px",s.style.height="1px",s.style.borderBottom="1px "+n+" black",s.style.paddingTop="6px",o.firstChild.firstChild.style.padding="0px 4px 0px 4px",o.firstChild.firstChild.style.width=e+"px",o.firstChild.firstChild.appendChild(s),o}),g=this.editorUi.toolbar.addMenuFunctionInContainer(p,"geSprite-orthogonal",mxResources.get("pattern"),!1,mxUtils.bind(this,function(t){m(t,75,"solid",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],[null,null]).setAttribute("title",mxResources.get("solid")),m(t,75,"dashed",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1",null]).setAttribute("title",mxResources.get("dashed")),m(t,75,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 1"]).setAttribute("title",mxResources.get("dotted")+" (1)"),m(t,75,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 2"]).setAttribute("title",mxResources.get("dotted")+" (2)"),m(t,75,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 4"]).setAttribute("title",mxResources.get("dotted")+" (3)")})),x=p.cloneNode(!1),y=this.editorUi.toolbar.addMenuFunctionInContainer(x,"geSprite-connection",mxResources.get("connection"),!1,mxUtils.bind(this,function(t){this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],[null,null,null,null],"geIcon geSprite geSprite-connection",null,!0).setAttribute("title",mxResources.get("line")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["link",null,null,null],"geIcon geSprite geSprite-linkedge",null,!0).setAttribute("title",mxResources.get("link")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["flexArrow",null,null,null],"geIcon geSprite geSprite-arrow",null,!0).setAttribute("title",mxResources.get("arrow")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["arrow",null,null,null],"geIcon geSprite geSprite-simplearrow",null,!0).setAttribute("title",mxResources.get("simpleArrow"))})),f=this.editorUi.toolbar.addMenuFunctionInContainer(x,"geSprite-orthogonal",mxResources.get("pattern"),!1,mxUtils.bind(this,function(t){m(t,33,"solid",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],[null,null]).setAttribute("title",mxResources.get("solid")),m(t,33,"dashed",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1",null]).setAttribute("title",mxResources.get("dashed")),m(t,33,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 1"]).setAttribute("title",mxResources.get("dotted")+" (1)"),m(t,33,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 2"]).setAttribute("title",mxResources.get("dotted")+" (2)"),m(t,33,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 4"]).setAttribute("title",mxResources.get("dotted")+" (3)")})),C=p.cloneNode(!1),S=document.createElement("input");S.style.textAlign="right",S.style.marginTop="2px",S.style.width="41px",S.setAttribute("title",mxResources.get("linewidth")),p.appendChild(S);var E=S.cloneNode(!0);x.appendChild(E);var v=this.createStepper(S,e,1,9);v.style.display=S.style.display,v.style.marginTop="2px",p.appendChild(v);var b=this.createStepper(E,n,1,9);b.style.display=E.style.display,b.style.marginTop="2px",x.appendChild(b),mxClient.IS_QUIRKS?(S.style.height="17px",E.style.height="17px"):(S.style.position="absolute",S.style.right="32px",S.style.height="15px",v.style.right="20px",E.style.position="absolute",E.style.right="32px",E.style.height="15px",b.style.right="20px"),mxEvent.addListener(S,"blur",e),mxEvent.addListener(S,"change",e),mxEvent.addListener(E,"blur",n),mxEvent.addListener(E,"change",n),mxClient.IS_QUIRKS&&(mxUtils.br(C),mxUtils.br(C));var w=this.editorUi.toolbar.addMenuFunctionInContainer(C,"geSprite-orthogonal",mxResources.get("waypoints"),!1,mxUtils.bind(this,function(t){"arrow"!=o.style.shape&&(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],[null,null,null],"geIcon geSprite geSprite-straight",null,!0).setAttribute("title",mxResources.get("straight")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle",null,null],"geIcon geSprite geSprite-orthogonal",null,!0).setAttribute("title",mxResources.get("orthogonal")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalelbow",null,!0).setAttribute("title",mxResources.get("simple")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalelbow",null,!0).setAttribute("title",mxResources.get("simple")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalisometric",null,!0).setAttribute("title",mxResources.get("isometric")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalisometric",null,!0).setAttribute("title",mxResources.get("isometric")),"connector"==o.style.shape&&this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle","1",null],"geIcon geSprite geSprite-curved",null,!0).setAttribute("title",mxResources.get("curved")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["entityRelationEdgeStyle",null,null],"geIcon geSprite geSprite-entity",null,!0).setAttribute("title",mxResources.get("entityRelation")))})),T=this.editorUi.toolbar.addMenuFunctionInContainer(C,"geSprite-startclassic",mxResources.get("linestart"),!1,mxUtils.bind(this,function(t){"connector"!=o.style.shape&&"flexArrow"!=o.style.shape||(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.NONE,0],"geIcon geSprite geSprite-noarrow",null,!1).setAttribute("title",mxResources.get("none")),"connector"==o.style.shape?(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC,1],"geIcon geSprite geSprite-startclassic",null,!1).setAttribute("title",mxResources.get("classic")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC_THIN,1],"geIcon geSprite geSprite-startclassicthin",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OPEN,0],"geIcon geSprite geSprite-startopen",null,!1).setAttribute("title",mxResources.get("openArrow")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OPEN_THIN,0],"geIcon geSprite geSprite-startopenthin",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["openAsync",0],"geIcon geSprite geSprite-startopenasync",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK,1],"geIcon geSprite geSprite-startblock",null,!1).setAttribute("title",mxResources.get("block")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK_THIN,1],"geIcon geSprite geSprite-startblockthin",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["async",1],"geIcon geSprite geSprite-startasync",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OVAL,1],"geIcon geSprite geSprite-startoval",null,!1).setAttribute("title",mxResources.get("oval")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND,1],"geIcon geSprite geSprite-startdiamond",null,!1).setAttribute("title",mxResources.get("diamond")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND_THIN,1],"geIcon geSprite geSprite-startthindiamond",null,!1).setAttribute("title",mxResources.get("diamondThin")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC,0],"geIcon geSprite geSprite-startclassictrans",null,!1).setAttribute("title",mxResources.get("classic")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC_THIN,0],"geIcon geSprite geSprite-startclassicthintrans",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK,0],"geIcon geSprite geSprite-startblocktrans",null,!1).setAttribute("title",mxResources.get("block")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK_THIN,0],"geIcon geSprite geSprite-startblockthintrans",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["async",0],"geIcon geSprite geSprite-startasynctrans",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OVAL,0],"geIcon geSprite geSprite-startovaltrans",null,!1).setAttribute("title",mxResources.get("oval")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND,0],"geIcon geSprite geSprite-startdiamondtrans",null,!1).setAttribute("title",mxResources.get("diamond")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND_THIN,0],"geIcon geSprite geSprite-startthindiamondtrans",null,!1).setAttribute("title",mxResources.get("diamondThin")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["dash",0],"geIcon geSprite geSprite-startdash",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["cross",0],"geIcon geSprite geSprite-startcross",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["circlePlus",0],"geIcon geSprite geSprite-startcircleplus",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["circle",1],"geIcon geSprite geSprite-startcircle",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERone",0],"geIcon geSprite geSprite-starterone",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERmandOne",0],"geIcon geSprite geSprite-starteronetoone",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERmany",0],"geIcon geSprite geSprite-startermany",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERoneToMany",0],"geIcon geSprite geSprite-starteronetomany",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERzeroToOne",1],"geIcon geSprite geSprite-starteroneopt",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERzeroToMany",1],"geIcon geSprite geSprite-startermanyopt",null,!1)):this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_BLOCK],"geIcon geSprite geSprite-startblocktrans",null,!1).setAttribute("title",mxResources.get("block")))})),A=this.editorUi.toolbar.addMenuFunctionInContainer(C,"geSprite-endclassic",mxResources.get("lineend"),!1,mxUtils.bind(this,function(t){"connector"!=o.style.shape&&"flexArrow"!=o.style.shape||(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.NONE,0],"geIcon geSprite geSprite-noarrow",null,!1).setAttribute("title",mxResources.get("none")),"connector"==o.style.shape?(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC,1],"geIcon geSprite geSprite-endclassic",null,!1).setAttribute("title",mxResources.get("classic")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC_THIN,1],"geIcon geSprite geSprite-endclassicthin",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OPEN,0],"geIcon geSprite geSprite-endopen",null,!1).setAttribute("title",mxResources.get("openArrow")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OPEN_THIN,0],"geIcon geSprite geSprite-endopenthin",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["openAsync",0],"geIcon geSprite geSprite-endopenasync",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK,1],"geIcon geSprite geSprite-endblock",null,!1).setAttribute("title",mxResources.get("block")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK_THIN,1],"geIcon geSprite geSprite-endblockthin",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["async",1],"geIcon geSprite geSprite-endasync",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OVAL,1],"geIcon geSprite geSprite-endoval",null,!1).setAttribute("title",mxResources.get("oval")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND,1],"geIcon geSprite geSprite-enddiamond",null,!1).setAttribute("title",mxResources.get("diamond")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND_THIN,1],"geIcon geSprite geSprite-endthindiamond",null,!1).setAttribute("title",mxResources.get("diamondThin")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC,0],"geIcon geSprite geSprite-endclassictrans",null,!1).setAttribute("title",mxResources.get("classic")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC_THIN,0],"geIcon geSprite geSprite-endclassicthintrans",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK,0],"geIcon geSprite geSprite-endblocktrans",null,!1).setAttribute("title",mxResources.get("block")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK_THIN,0],"geIcon geSprite geSprite-endblockthintrans",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["async",0],"geIcon geSprite geSprite-endasynctrans",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OVAL,0],"geIcon geSprite geSprite-endovaltrans",null,!1).setAttribute("title",mxResources.get("oval")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND,0],"geIcon geSprite geSprite-enddiamondtrans",null,!1).setAttribute("title",mxResources.get("diamond")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND_THIN,0],"geIcon geSprite geSprite-endthindiamondtrans",null,!1).setAttribute("title",mxResources.get("diamondThin")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["dash",0],"geIcon geSprite geSprite-enddash",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["cross",0],"geIcon geSprite geSprite-endcross",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["circlePlus",0],"geIcon geSprite geSprite-endcircleplus",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["circle",1],"geIcon geSprite geSprite-endcircle",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERone",0],"geIcon geSprite geSprite-enderone",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERmandOne",0],"geIcon geSprite geSprite-enderonetoone",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERmany",0],"geIcon geSprite geSprite-endermany",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERoneToMany",0],"geIcon geSprite geSprite-enderonetomany",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERzeroToOne",1],"geIcon geSprite geSprite-enderoneopt",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERzeroToMany",1],"geIcon geSprite geSprite-endermanyopt",null,!1)):this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_BLOCK],"geIcon geSprite geSprite-endblocktrans",null,!1).setAttribute("title",mxResources.get("block")))}));this.addArrow(y,8),this.addArrow(w),this.addArrow(T),this.addArrow(A);var R=this.addArrow(g,9);R.className="geIcon",R.style.width="84px";var I=this.addArrow(f,9);I.className="geIcon",I.style.width="22px";var L=document.createElement("div");L.style.width="85px",L.style.height="1px",L.style.borderBottom="1px solid black",L.style.marginBottom="9px",R.appendChild(L);var U=document.createElement("div");U.style.width="23px",U.style.height="1px",U.style.borderBottom="1px solid black",U.style.marginBottom="9px",I.appendChild(U),g.style.height="15px",f.style.height="15px",y.style.height="15px",w.style.height="17px",T.style.marginLeft="3px",T.style.height="17px",A.style.marginLeft="3px",A.style.height="17px",t.appendChild(s),t.appendChild(x),t.appendChild(p);var N=p.cloneNode(!1);N.style.paddingBottom="6px",N.style.paddingTop="4px",N.style.fontWeight="normal";var M=document.createElement("div");M.style.position="absolute",M.style.marginLeft="3px",M.style.marginBottom="12px",M.style.marginTop="2px",M.style.fontWeight="normal",M.style.width="76px",mxUtils.write(M,mxResources.get("lineend")),N.appendChild(M);var O,_,D=this.addUnitInput(N,"pt",74,33,function(){O.apply(this,arguments)}),H=this.addUnitInput(N,"pt",20,33,function(){_.apply(this,arguments)});mxUtils.br(N);var P=document.createElement("div");P.style.height="8px",N.appendChild(P),M=M.cloneNode(!1),mxUtils.write(M,mxResources.get("linestart")),N.appendChild(M);var k,F,G=this.addUnitInput(N,"pt",74,33,function(){k.apply(this,arguments)}),Y=this.addUnitInput(N,"pt",20,33,function(){F.apply(this,arguments)});mxUtils.br(N),this.addLabel(N,mxResources.get("spacing"),74,50),this.addLabel(N,mxResources.get("size"),20,50),mxUtils.br(N);var B=s.cloneNode(!1);B.style.fontWeight="normal",B.style.position="relative",B.style.paddingLeft="16px",B.style.marginBottom="2px",B.style.marginTop="6px",B.style.borderWidth="0px",B.style.paddingBottom="18px";var M=document.createElement("div");M.style.position="absolute",M.style.marginLeft="3px",M.style.marginBottom="12px",M.style.marginTop="1px",M.style.fontWeight="normal",M.style.width="120px",mxUtils.write(M,mxResources.get("perimeter")),B.appendChild(M);var W,z=this.addUnitInput(B,"pt",20,41,function(){W.apply(this,arguments)});o.edges.length==l.getSelectionCount()?(t.appendChild(C),mxClient.IS_QUIRKS&&(mxUtils.br(t),mxUtils.br(t)),t.appendChild(N)):o.vertices.length==l.getSelectionCount()&&(mxClient.IS_QUIRKS&&mxUtils.br(t),t.appendChild(B));var V=mxUtils.bind(this,function(t,e,n){function s(t,e,n,l){var s=n.getElementsByTagName("div")[0];return s.className=i.getCssClassForMarker(l,o.style.shape,t,e),s}o=this.format.getSelectionState();mxUtils.getValue(o.style,c,null);if(n||document.activeElement!=S){var a=parseInt(mxUtils.getValue(o.style,mxConstants.STYLE_STROKEWIDTH,1));S.value=isNaN(a)?"":a+" pt"}if(n||document.activeElement!=E){var a=parseInt(mxUtils.getValue(o.style,mxConstants.STYLE_STROKEWIDTH,1));E.value=isNaN(a)?"":a+" pt"}r.style.visibility="connector"==o.style.shape?"":"hidden","1"==mxUtils.getValue(o.style,mxConstants.STYLE_CURVED,null)?r.value="curved":"1"==mxUtils.getValue(o.style,mxConstants.STYLE_ROUNDED,null)&&(r.value="rounded"),"1"==mxUtils.getValue(o.style,mxConstants.STYLE_DASHED,null)?null==mxUtils.getValue(o.style,mxConstants.STYLE_DASH_PATTERN,null)?L.style.borderBottom="1px dashed black":L.style.borderBottom="1px dotted black":L.style.borderBottom="1px solid black",U.style.borderBottom=L.style.borderBottom;var d=w.getElementsByTagName("div")[0],u=mxUtils.getValue(o.style,mxConstants.STYLE_EDGE,null);"1"==mxUtils.getValue(o.style,mxConstants.STYLE_NOEDGESTYLE,null)&&(u=null),"orthogonalEdgeStyle"==u&&"1"==mxUtils.getValue(o.style,mxConstants.STYLE_CURVED,null)?d.className="geSprite geSprite-curved":d.className="straight"==u||"none"==u||null==u?"geSprite geSprite-straight":"entityRelationEdgeStyle"==u?"geSprite geSprite-entity":"elbowEdgeStyle"==u?"geSprite "+("vertical"==mxUtils.getValue(o.style,mxConstants.STYLE_ELBOW,null)?"geSprite-verticalelbow":"geSprite-horizontalelbow"):"isometricEdgeStyle"==u?"geSprite "+("vertical"==mxUtils.getValue(o.style,mxConstants.STYLE_ELBOW,null)?"geSprite-verticalisometric":"geSprite-horizontalisometric"):"geSprite geSprite-orthogonal";var h=y.getElementsByTagName("div")[0];"link"==o.style.shape?h.className="geSprite geSprite-linkedge":"flexArrow"==o.style.shape?h.className="geSprite geSprite-arrow":"arrow"==o.style.shape?h.className="geSprite geSprite-simplearrow":h.className="geSprite geSprite-connection",o.edges.length==l.getSelectionCount()?(x.style.display="",p.style.display="none"):(x.style.display="none",p.style.display="");var m=s(mxUtils.getValue(o.style,mxConstants.STYLE_STARTARROW,null),mxUtils.getValue(o.style,"startFill","1"),T,"start"),g=s(mxUtils.getValue(o.style,mxConstants.STYLE_ENDARROW,null),mxUtils.getValue(o.style,"endFill","1"),A,"end");if("arrow"==o.style.shape?(m.className="geSprite geSprite-noarrow",g.className="geSprite geSprite-endblocktrans"):"link"==o.style.shape&&(m.className="geSprite geSprite-noarrow",g.className="geSprite geSprite-noarrow"),mxUtils.setOpacity(w,"arrow"==o.style.shape?30:100),"connector"!=o.style.shape&&"flexArrow"!=o.style.shape?(mxUtils.setOpacity(T,30),mxUtils.setOpacity(A,30)):(mxUtils.setOpacity(T,100),mxUtils.setOpacity(A,100)),n||document.activeElement!=Y){var a=parseInt(mxUtils.getValue(o.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE));Y.value=isNaN(a)?"":a+" pt"}if(n||document.activeElement!=G){var a=parseInt(mxUtils.getValue(o.style,mxConstants.STYLE_SOURCE_PERIMETER_SPACING,0));G.value=isNaN(a)?"":a+" pt"}if(n||document.activeElement!=H){var a=parseInt(mxUtils.getValue(o.style,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE));H.value=isNaN(a)?"":a+" pt"}if(n||document.activeElement!=G){var a=parseInt(mxUtils.getValue(o.style,mxConstants.STYLE_TARGET_PERIMETER_SPACING,0));D.value=isNaN(a)?"":a+" pt"}if(n||document.activeElement!=z){var a=parseInt(mxUtils.getValue(o.style,mxConstants.STYLE_PERIMETER_SPACING,0));z.value=isNaN(a)?"":a+" pt"}});return F=this.installInputHandler(Y,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE,0,999," pt"),k=this.installInputHandler(G,mxConstants.STYLE_SOURCE_PERIMETER_SPACING,0,-999,999," pt"),_=this.installInputHandler(H,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE,0,999," pt"),O=this.installInputHandler(D,mxConstants.STYLE_TARGET_PERIMETER_SPACING,0,-999,999," pt"),W=this.installInputHandler(z,mxConstants.STYLE_PERIMETER_SPACING,0,0,999," pt"),this.addKeyHandler(S,V),this.addKeyHandler(Y,V),this.addKeyHandler(G,V),this.addKeyHandler(H,V),this.addKeyHandler(D,V),this.addKeyHandler(z,V),l.getModel().addListener(mxEvent.CHANGE,V),this.listeners.push({destroy:function(){l.getModel().removeListener(V)}}),V(),t},a.prototype.addEffects=function(t){var e=this.editorUi,n=e.editor,i=n.graph,l=this.format.getSelectionState();t.style.paddingTop="0px",t.style.paddingBottom="2px";var o=document.createElement("table");mxClient.IS_QUIRKS&&(o.style.fontSize="1em"),o.style.width="100%",o.style.fontWeight="bold",o.style.paddingRight="20px";var s=document.createElement("tbody"),r=document.createElement("tr");r.style.padding="0px";var a=document.createElement("td");a.style.padding="0px",a.style.width="50%",a.setAttribute("valign","top");var d=a.cloneNode(!0);d.style.paddingLeft="8px",r.appendChild(a),r.appendChild(d),s.appendChild(r),o.appendChild(s),t.appendChild(o);var u=a,c=0,h=mxUtils.bind(this,function(t,e,n){var i=this.createCellOption(t,e,n);i.style.width="100%",u.appendChild(i),u=u==a?d:a,c++}),p=mxUtils.bind(this,function(e,n,i){l=this.format.getSelectionState(),a.innerHTML="",d.innerHTML="",u=a,l.rounded&&h(mxResources.get("rounded"),mxConstants.STYLE_ROUNDED,0),"swimlane"==l.style.shape&&h(mxResources.get("divider"),"swimlaneLine",1),l.containsImage||h(mxResources.get("shadow"),mxConstants.STYLE_SHADOW,0),l.glass&&h(mxResources.get("glass"),mxConstants.STYLE_GLASS,0),l.comic&&h(mxResources.get("comic"),"comic",0),0==c&&(t.style.display="none")});return i.getModel().addListener(mxEvent.CHANGE,p),this.listeners.push({destroy:function(){i.getModel().removeListener(p)}}),p(),t},a.prototype.addStyleOps=function(t){t.style.paddingTop="10px",t.style.paddingBottom="10px";var e=mxUtils.button(mxResources.get("setAsDefaultStyle"),mxUtils.bind(this,function(t){this.editorUi.actions.get("setAsDefaultStyle").funct()}));return e.setAttribute("title",mxResources.get("setAsDefaultStyle")+" ("+this.editorUi.actions.get("setAsDefaultStyle").shortcut+")"),e.style.width="202px",t.appendChild(e),t};var d=function(t,e,n){o.call(this,t,e,n),this.init()};mxUtils.extend(d,o),d.prototype.showBackgroundImageOption=!0,d.prototype.init=function(){var t=this.editorUi,e=t.editor,n=e.graph;this.container.appendChild(this.addView(this.createPanel())),n.isEnabled()&&(this.container.appendChild(this.addOptions(this.createPanel())),this.container.appendChild(this.addPaperSize(this.createPanel())),this.container.appendChild(this.addStyleOps(this.createPanel())))},d.prototype.addView=function(t){var e=this.editorUi,n=e.editor,i=n.graph;if(t.appendChild(this.createTitle(mxResources.get("view"))),this.addGridOption(t),i.isEnabled()){t.appendChild(this.createOption(mxResources.get("guides"),function(){return i.graphHandler.guidesEnabled},function(t){e.actions.get("guides").funct()},{install:function(t){this.listener=function(){t(i.graphHandler.guidesEnabled)},e.addListener("guidesEnabledChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}})),t.appendChild(this.createOption(mxResources.get("pageView"),function(){return i.pageVisible},function(t){e.actions.get("pageView").funct()},{install:function(t){this.listener=function(){t(i.pageVisible)},e.addListener("pageViewChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}}));var l=this.createColorOption(mxResources.get("background"),function(){return i.background},function(t){e.setBackgroundColor(t)},"#ffffff",{install:function(t){this.listener=function(){t(i.background)},e.addListener("backgroundColorChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}});if(this.showBackgroundImageOption){var o=mxUtils.button(mxResources.get("image"),function(t){e.showBackgroundImageDialog(),mxEvent.consume(t)});o.style.position="absolute",o.className="geColorBtn",o.style.marginTop="-4px",o.style.paddingBottom=11==document.documentMode||mxClient.IS_MT?"0px":"2px",o.style.height="22px",o.style.right=mxClient.IS_QUIRKS?"52px":"72px",o.style.width="56px",l.appendChild(o)}t.appendChild(l)}return t},d.prototype.addOptions=function(t){var e=this.editorUi,n=e.editor,i=n.graph;return t.appendChild(this.createTitle(mxResources.get("options"))),i.isEnabled()&&(t.appendChild(this.createOption(mxResources.get("connectionArrows"),function(){return i.connectionArrowsEnabled},function(t){e.actions.get("connectionArrows").funct()},{install:function(t){this.listener=function(){t(i.connectionArrowsEnabled)},e.addListener("connectionArrowsChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}})),t.appendChild(this.createOption(mxResources.get("connectionPoints"),function(){return i.connectionHandler.isEnabled()},function(t){e.actions.get("connectionPoints").funct()},{install:function(t){this.listener=function(){t(i.connectionHandler.isEnabled())},e.addListener("connectionPointsChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}}))),t},d.prototype.addGridOption=function(t){function e(t){var e=parseInt(l.value);e=Math.max(1,isNaN(e)?10:e),e!=i.getGridSize()&&i.setGridSize(e),l.value=e+" pt",mxEvent.consume(t)}var n=this.editorUi,i=n.editor.graph,l=document.createElement("input");l.style.position="absolute",l.style.textAlign="right",l.style.width="38px",l.value=i.getGridSize()+" pt";var o=this.createStepper(l,e);if(l.style.display=i.isGridEnabled()?"":"none",o.style.display=l.style.display,mxEvent.addListener(l,"keydown",function(t){13==t.keyCode?(i.container.focus(),mxEvent.consume(t)):27==t.keyCode&&(l.value=i.getGridSize(),i.container.focus(),mxEvent.consume(t))}),mxEvent.addListener(l,"blur",e),mxEvent.addListener(l,"change",e),mxClient.IS_SVG){l.style.marginTop="-2px",l.style.right="84px",o.style.marginTop="-16px",o.style.right="72px";var s=this.createColorOption(mxResources.get("grid"),function(){var t=i.view.gridColor;return i.isGridEnabled()?t:null},function(t){t==mxConstants.NONE?(i.setGridEnabled(!1),n.fireEvent(new mxEventObject("gridEnabledChanged"))):(i.setGridEnabled(!0),n.setGridColor(t)),l.style.display=i.isGridEnabled()?"":"none",o.style.display=l.style.display},"#e0e0e0",{install:function(t){this.listener=function(){t(i.isGridEnabled()?i.view.gridColor:null)},n.addListener("gridColorChanged",this.listener),n.addListener("gridEnabledChanged",this.listener)},destroy:function(){n.removeListener(this.listener)}});s.appendChild(l),s.appendChild(o),t.appendChild(s)}else l.style.marginTop="2px",l.style.right="32px",o.style.marginTop="2px",o.style.right="20px",t.appendChild(l),t.appendChild(o),t.appendChild(this.createOption(mxResources.get("grid"),function(){return i.isGridEnabled()},function(t){i.setGridEnabled(t),i.isGridEnabled()&&(i.view.gridColor="#e0e0e0"),n.fireEvent(new mxEventObject("gridEnabledChanged"))},{install:function(t){this.listener=function(){l.style.display=i.isGridEnabled()?"":"none",o.style.display=l.style.display,t(i.isGridEnabled())},n.addListener("gridEnabledChanged",this.listener)},destroy:function(){n.removeListener(this.listener)}}))},d.prototype.addDocumentProperties=function(t){var e=this.editorUi,n=e.editor;n.graph;return t.appendChild(this.createTitle(mxResources.get("options"))),t},d.prototype.addPaperSize=function(t){var e=this.editorUi,n=e.editor,i=n.graph;t.appendChild(this.createTitle(mxResources.get("paperSize")));var l=PageSetupDialog.addPageFormatPanel(t,"formatpanel",i.pageFormat,function(t){null!=i.pageFormat&&i.pageFormat.width==t.width&&i.pageFormat.height==t.height||e.setPageFormat(t)});this.addKeyHandler(l.widthInput,function(){console.log("here",i.pageFormat),l.set(i.pageFormat)}),this.addKeyHandler(l.heightInput,function(){l.set(i.pageFormat)});var o=function(){l.set(i.pageFormat)};return e.addListener("pageFormatChanged",o),this.listeners.push({destroy:function(){e.removeListener(o)}}),i.getModel().addListener(mxEvent.CHANGE,o),this.listeners.push({destroy:function(){i.getModel().removeListener(o)}}),t},d.prototype.addStyleOps=function(t){var e=mxUtils.button(mxResources.get("editData"),mxUtils.bind(this,function(t){this.editorUi.actions.get("editData").funct()}));return e.setAttribute("title",mxResources.get("editData")+" ("+this.editorUi.actions.get("editData").shortcut+")"),e.style.width="202px",e.style.marginBottom="2px",t.appendChild(e),mxUtils.br(t),e=mxUtils.button(mxResources.get("clearDefaultStyle"),mxUtils.bind(this,function(t){this.editorUi.actions.get("clearDefaultStyle").funct()})),e.setAttribute("title",mxResources.get("clearDefaultStyle")+" ("+this.editorUi.actions.get("clearDefaultStyle").shortcut+")"),e.style.width="202px",t.appendChild(e),t},d.prototype.destroy=function(){o.prototype.destroy.apply(this,arguments),this.gridEnabledListener&&(this.editorUi.removeListener(this.gridEnabledListener),this.gridEnabledListener=null)},t.exports=l}]);